<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
      <!--
		
		Generated at 2007-02-12T11:38:49.726Z-->
      <title>Saxonica: XSLT and XQuery Processing: JAXP and other Java API changes</title>
      <meta name="coverage" content="Worldwide">
      <meta name="copyright" content="Copyright Saxonica Ltd">
      <meta name="title" content="Saxonica: XSLT and XQuery Processing: JAXP and other Java API changes">
      <meta name="robots" content="noindex,nofollow">
      <link rel="stylesheet" href="../../saxondocs.css" type="text/css">
   </head>
   <body class="main">
      <div id="rhDkBlueArea" style="position:absolute; width:123px; height:1705px; z-index:2; right: 0px; top: 0px; border: 1px none #000000; background-color: #C1CEDE; layer-background-color: #C1CEDE; visibility: visible;"></div>
      <div id="rhMdBlueArea" style="position:absolute; width:217px; height:1705px; z-index:2; right: 340px; top: 0px; border: 1px none #000000; background-color: #E4EEF0; layer-background-color: #E4EEF0; visibility: visible;"></div>
      <div id="lhLightArea" style="position:absolute; width:34px; height:1705px; z-index:2; left: 66px; top: 0px; border: 1px none #000000; background-color: #f6fffb; layer-background-color: #E4EEF0; visibility: visible;"></div>
      <div id="lhDkBlueArea" style="position:absolute; width:66px; height:1705px; z-index:2; left: 0px; top: 0px; border: 1px none #000000; background-color: #C1CEDE; layer-background-color: #C1CEDE; visibility: visible;"></div>
      <div id="LogoArea" style="position:absolute; width:340px; height:72px; z-index:3; right: 0px; top: 0px; border: 1px none #000000; visibility: visible;"><a href="../../index/intro.html"><img src="../../img/saxonica_logo.gif" width="340" height="72" border="0" alt="Saxonica.com"></a></div>
      <div id="MenuArea" style="position:absolute; width:157px; z-index:4; right: 33px; top: 114px; visibility: visible; background-color: #f6fffb; layer-background-color: #f6fffb; border: 1px solid #3D5B96; padding-top:9px; padding-left:15px;padding-right:11px; padding-bottom:9px;">
         <table width="164" border="0" bgcolor="#3D5B96" cellspacing="1" cellpadding="1">
            <tr bgcolor="#f6fffb">
               <td style="padding-left:5px"><a href="http://www.saxonica.com/">SAXONICA</a></td>
            </tr>
         </table><br><table border="0" cellspacing="0" cellpadding="1">
            <tr>
               <td class="title" colspan="2">Saxon Documentation</td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/spacer.gif" width="120" height="10" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../contents.html">Full Contents</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../index/intro.html">About Saxon</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../changes/intro.html">Changes in this Release</a></td>
            </tr>
            <tr>
               <td>»&nbsp;</td>
               <td><a href="../intro.html">Version 8.9 (2007-02-12)</a></td>
            </tr>
            <tr>
               <td><img src="../../img/spacer.gif" width="10" height="5" border="0" alt="blank space"></td>
               <td><a href="../intro88.html">Version 8.8 (2006-09-05)</a></td>
            </tr>
            <tr>
               <td><img src="../../img/spacer.gif" width="10" height="5" border="0" alt="blank space"></td>
               <td><a href="../intro873.html">Version 8.7.3 (2006-06-13)</a></td>
            </tr>
            <tr>
               <td><img src="../../img/spacer.gif" width="10" height="5" border="0" alt="blank space"></td>
               <td><a href="../v872.html">Version 8.7.2 (2006-04-19)</a></td>
            </tr>
            <tr>
               <td><img src="../../img/spacer.gif" width="10" height="5" border="0" alt="blank space"></td>
               <td><a href="../v871.html">Version 8.7.1 (2006-04-13)</a></td>
            </tr>
            <tr>
               <td><img src="../../img/spacer.gif" width="10" height="5" border="0" alt="blank space"></td>
               <td><a href="../intro87.html">Version 8.7 (2006-02-24)</a></td>
            </tr>
            <tr>
               <td><img src="../../img/spacer.gif" width="10" height="5" border="0" alt="blank space"></td>
               <td><a href="../intro861.html">Version 8.6.1 (24 November 2005)</a></td>
            </tr>
            <tr>
               <td><img src="../../img/spacer.gif" width="10" height="5" border="0" alt="blank space"></td>
               <td><a href="../intro86.html">Version 8.6 (3 November 2005)</a></td>
            </tr>
            <tr>
               <td><img src="../../img/spacer.gif" width="10" height="5" border="0" alt="blank space"></td>
               <td><a href="../intro851.html">Version 8.5.1 (26 August 2005)</a></td>
            </tr>
            <tr>
               <td><img src="../../img/spacer.gif" width="10" height="5" border="0" alt="blank space"></td>
               <td><a href="../intro85.html">Version 8.5 (2 August 2005)</a></td>
            </tr>
            <tr>
               <td><img src="../../img/spacer.gif" width="10" height="5" border="0" alt="blank space"></td>
               <td><a href="../v84.html">Version 8.4 (4 April 2005)</a></td>
            </tr>
            <tr>
               <td><img src="../../img/spacer.gif" width="10" height="5" border="0" alt="blank space"></td>
               <td><a href="../v83.html">Version 8.3 (11 February 2005)</a></td>
            </tr>
            <tr>
               <td><img src="../../img/spacer.gif" width="10" height="5" border="0" alt="blank space"></td>
               <td><a href="../v8.2.html">Version 8.2 (21 December 2004)</a></td>
            </tr>
            <tr>
               <td><img src="../../img/spacer.gif" width="10" height="5" border="0" alt="blank space"></td>
               <td><a href="../v811.html">Version 8.1.1 (8 October 2004)</a></td>
            </tr>
            <tr>
               <td><img src="../../img/spacer.gif" width="10" height="5" border="0" alt="blank space"></td>
               <td><a href="../intro81.html">Version 8.1 (24 September 2004)</a></td>
            </tr>
            <tr>
               <td><img src="../../img/spacer.gif" width="10" height="5" border="0" alt="blank space"></td>
               <td><a href="../v8.0.html">Version 8.0 (1 June 2004)</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../conditions/intro.html">Conditions of Use</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../using-xsl/intro.html">Using XSLT 2.0</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../using-xquery/intro.html">Using XQuery</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../sourcedocs/intro.html">Handling Source Documents</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../schema-processing/intro.html">XML Schema Processing</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../xpath-api/intro.html">XPath API for Java</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../dotnet/intro.html">Saxon on .NET</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../extensibility/intro.html">Extensibility</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../extensions/intro.html">Saxon Extensions</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../samples/intro.html">Sample Saxon Applications</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../sql-extension/intro.html">The Saxon SQL Extension</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../xsl-elements/intro.html">XSLT Elements</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../expressions/intro.html">XPath 2.0 Expression Syntax</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../functions/intro.html">Function Library</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
            <tr>
               <td colspan="2"><a href="../../conformance/intro.html">Standards Conformance</a></td>
            </tr>
            <tr>
               <td colspan="2"><img src="../../img/text_blue_dot.gif" width="164" height="1" border="0" alt=""></td>
            </tr>
         </table>
      </div>
      <div id="MainTextArea" style="position:absolute; height:100%; z-index:5; left: 130px; right: 260px; top: 110px; border: 1px none #000000; visibility: visible;">
         <h1>JAXP and other Java API changes</h1>
         <p class="subhead">JAXP</p>
         <p>It is now possible to set the <code>Configuration</code> used by a <code>TransformerFactory</code>
            or <code>DocumentBuilderFactory</code> using the <code>setAttribute()</code> method with the attribute
            name <code>FeatureKeys.CONFIGURATION</code>. By reading this attribute on a <code>TransformerFactory</code>,
            and setting it on a <code>DocumentBuilderFactory</code>, it is possible to ensure that all documents
            use the same Configuration without introducing any compile-time dependencies on Saxon.
         </p>
         <p>A wider range of JAXP-defined options is now supported on the <code>DocumentBuilderFactory</code> interface.
            For example, a request to perform XInclude processing is now accepted (though it will only work if the underlying
            XML parser is Xerces).
         </p>
         <p>It is now possible to provide a user-written URI resolver for use by the XSLT unparsed-text() function. This
            must be an instance of <code>net.sf.saxon.trans.UnparsedTextURIResolver</code>, and it is set as a property of
            the <code>Controller</code> object (Saxon's implementation of the JAXP <code>Transformer</code>). One use case for
            this feature is to allow access to unparsed text files to be disabled when an untrusted stylesheet is run.
         </p>
         <p class="subhead">xsl:message</p>
         <p>There have been some changes to the handling of <code>xsl:message</code> output in XSLT:
         </p>
         <ul>
            <li>
               <p>The class nominated to
                  receive <code>xsl:message</code> output is no longer required to be an instance of <code>Emitter</code>, it can now
                  be any instance of <code>net.sf.saxon.event.Receiver</code> (of which <code>Emitter</code> is a subclass, so existing
                  code should still work). The sequence of calls to this Receiver has been clarified: there is a single <code>open()</code> call at
                  the start of the transformation, and a single <code>close()</code> call at the end; and each evaluation of an <code>xsl:message</code>
                  instruction starts with a <code>startDocument()</code> call and ends with <code>endDocument()</code>. The <code>startDocument()</code>
                  event has a <code>properties</code> argument indicating whether <code>terminate="yes"</code> was specified, and the
                  <code>locationId</code> on calls such as <code>startElement()</code> and <code>characters()</code> can be used to identify
                  the location in the stylesheet where the message data originated (this is achieved by passing the supplied <code>locationId</code>
                  in a call to <code>getPipelineConfiguration().getLocator().getSystemId(locationId)</code>, or to <code>getLineNumber()</code>
                  on the same object).
               </p>
            </li>
            <li>
               <p>A new class <code>net.sf.saxon.event.MessageWarner</code> can be selected for receiving message output; this class
                  follows the JAXP specification by passing the message output to the <code>warning()</code> method of the current
                  <code>ErrorListener</code>, or to the <code>error()</code> method if <code>terminate="yes"</code> is specified. For
                  backwards compatibility reasons this has not been made the default behavior.
               </p>
            </li>
         </ul>
         <p class="subhead">XPath APIs</p>
         <p>There have been some changes to the various XPath APIs, in an attempt to make them more usable, less error-prone,
            and more clearly differentiated, while also improving the implementation structure. The API in package 
            <code>net.sf.saxon.sxpath</code>, which was originally introduced as a stop-gap to avoid problems for users
            having difficulty with JAXP 1.3 configuration, is evolving as the main supported "native" API for people who
            want to make the most of Saxon functionality without diving into internals. The <code>net.sf.saxon.xpath</code> API
            is concentrating more on JAXP conformance and use by applications that don't want to know anything about Saxon-specific
            classes.
         </p>
         <ul>
            <li>
               <p>In the <code>sxpath</code> API, there were previously conflicting statements in the documentation about whether
                  or not it was possible to bind external variables. In fact there was a mechanism, but it was error-prone and not
                  well documented. It is now supported and hopefully clear how it is intended to work. User-defined functions are
                  currently not supported in this interface, unless you provide your own implementation of the new interface 
                  <code>XPathStaticContext</code>. There is now an explicit <code>XPathDynamicContext</code> object for binding
                  the context item and variables, which makes the <code>XPathExpression</code> and <code>XPathEvaluator</code>
                  objects thread-safe. Some fo the classes comprising this interface have been moved into the sxpath package to
                  allow methods that are intended for interal use to be protected, thus simplifying the interface and reducing
                  the scope for error. Generally, the API now exposes implementation details rather less than it did.
               </p>
            </li>
         </ul>
         <p class="subhead">Constructing source documents</p>
         <p>A new method for constructing source documents is now available: the <code>buildDocument()</code> method
            on the <code>Configuration</code> object. This supersedes other methods for building documents, such as the
            <code>buildDocument()</code> method on <code>StaticQueryContext</code>, and the <code>Builder.build()</code> method.
            However, the existing methods are retained for backwards compatibility. The new method accepts as argument any
            <code>Source</code> object, including an <code>AugmentedSource</code> which allows a wide range of options to be
            specified determining how the document is parsed and built. The general principle is that the option is taken from
            the <code>AugmentedSource</code> object if available, otherwise it defaults to the value set in the
            <code>Configuration</code>.
         </p>
         <p class="subhead">jar: URI scheme</p>
         <p>On the Java platform, the <code>jar:</code> URI scheme is now supported. Previously URIs using this scheme
            could be dereferenced, but relative URIs could not be resolved against a base URI using this scheme. This is because
            the <code>java.net.URI</code> class doesn't handle such resolution, which in turn is because the syntax of URIs in this
            scheme does not actually follow the RFC specifications for hierarchic URIs. However, they are supported by the
            <code>java.net.URL</code> class, which Saxon now uses to perform resolution of these relative URIs. This means, for example,
            that it is possible to hold stylesheet modules in a JAR file and resolve <code>xs:include</code> and <code>xs:import</code>
            references between files within the same JAR archive. For details of the <code>jar:</code> scheme see the javadoc for
            class <code>java.net.JARURLConnection</code>.
         </p>
         <p class="subhead">Miscellaneous</p>
         <p>The <code>StaticContext</code> interface has changed so that <code>getDefaultElementNamespace()</code> now returns
            the default namespace for elements and types as a string, no longer as an internal namespace code.
         </p>
         <p>By default Saxon now allocates a new <code>NamePool</code> to each <code>Configuration</code>.
            Previously the default was that all <code>Configuration</code>s shared the same <code>NamePool</code>.
            It is still possible to share a <code>NamePool</code>, but I'm not aware of any good reasons for doing so.
         </p>
         <table width="100%">
            <tr>
               <td>
                  <p align="right"><a class="nav" href="dotnet89.html">Next</a></p>
               </td>
            </tr>
         </table>
      </div>
   </body>
</html>