/**
 * This file was generated by the Objective Systems ASN1C Compiler
 * (http://www.obj-sys.com).  Version: 6.0B, Date: 18-Oct-2006.
 */
#include "Ns15.h"
#include "Ns3.h"
#include "Ns7.h"
#include "Odf.h"
#include "Ns13.h"
#include "rtxsrc/rtxCommon.h"

/**************************************************************/
/*                                                            */
/*  End_cell_address                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_End_cell_address (OSCTXT* pctxt,
   End_cell_address pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_End_cell_address (OSCTXT* pctxt, End_cell_address value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  End_x                                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_End_x (OSCTXT* pctxt,
   End_x pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_End_x (OSCTXT* pctxt, End_x value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  End_y                                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_End_y (OSCTXT* pctxt,
   End_y pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_End_y (OSCTXT* pctxt, End_y value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_background                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_background (OSCTXT* pctxt,
   Table_background *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Table_background (OSCTXT* pctxt, Table_background value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Table_background_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_is_sub_table                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_is_sub_table (OSCTXT* pctxt,
   Table_is_sub_table *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Table_is_sub_table (OSCTXT* pctxt, Table_is_sub_table value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Table_is_sub_table_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_print                                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_print (OSCTXT* pctxt,
   Table_print *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Table_print (OSCTXT* pctxt, Table_print value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Table_print_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_protected_                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_protected_ (OSCTXT* pctxt,
   Table_protected_ *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Table_protected_ (OSCTXT* pctxt, Table_protected_ value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Table_protected__ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_style_name                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_style_name (OSCTXT* pctxt,
   Table_style_name *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_utf8str (pctxt, pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Table_style_name (OSCTXT* pctxt, Table_style_name* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt_1, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_source_actuate                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_source_actuate (OSCTXT* pctxt,
   Table_source_actuate *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Table_source_actuate (OSCTXT* pctxt, Table_source_actuate value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Table_source_actuate_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_source_mode                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_source_mode (OSCTXT* pctxt,
   Table_source_mode *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Table_source_mode (OSCTXT* pctxt, Table_source_mode value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Table_source_mode_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_source                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_source (OSCTXT* pctxt,
   Table_source *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode table_name */

   if (pvalue->m.table_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         xe_utf8str (pctxt, pvalue->table_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode refresh_delay */

   if (pvalue->m.refresh_delayPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         xe_utf8str (pctxt, pvalue->refresh_delay, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode mode */

   if (pvalue->m.modePresent) {
      if(pvalue->mode < 0 || pvalue->mode > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Table_source_mode (pctxt, &pvalue->mode, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode filter_options */

   if (pvalue->m.filter_optionsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->filter_options, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode filter_name */

   if (pvalue->m.filter_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_utf8str (pctxt, pvalue->filter_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode type */

   if (pvalue->m.typePresent) {
      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Xlink_Type (pctxt, &pvalue->type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode href */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      asn1E_Xlink_Href (pctxt, pvalue->href, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode actuate */

   if (pvalue->m.actuatePresent) {
      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Table_source_actuate (pctxt, &pvalue->actuate, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Table_source (OSCTXT* pctxt, Table_source* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.actuatePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:actuate=\""), 16);

      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_source_actuate (pctxt, pvalue->actuate, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:href=\""), 13);

   stat = XmlEnc_Xlink_Href (pctxt, pvalue->href, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:type=\""), 13);

      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Xlink_Type (pctxt, pvalue->type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.filter_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:filter-name=\""), 19);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->filter_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.filter_optionsPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:filter-options=\""), 22);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->filter_options, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.modePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:mode=\""), 12);

      if(pvalue->mode < 0 || pvalue->mode > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_source_mode (pctxt, pvalue->mode, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.refresh_delayPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:refresh-delay=\""), 21);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->refresh_delay, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.table_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-name=\""), 18);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->table_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Scenario_copy_back                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Scenario_copy_back (OSCTXT* pctxt,
   Scenario_copy_back *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Scenario_copy_back (OSCTXT* pctxt, Scenario_copy_back value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Scenario_copy_back_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Scenario_copy_formulas                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Scenario_copy_formulas (OSCTXT* pctxt,
   Scenario_copy_formulas *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Scenario_copy_formulas (OSCTXT* pctxt, 
   Scenario_copy_formulas value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Scenario_copy_formulas_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Scenario_copy_styles                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Scenario_copy_styles (OSCTXT* pctxt,
   Scenario_copy_styles *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Scenario_copy_styles (OSCTXT* pctxt, Scenario_copy_styles value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Scenario_copy_styles_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Scenario_display_border                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Scenario_display_border (OSCTXT* pctxt,
   Scenario_display_border *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Scenario_display_border (OSCTXT* pctxt, 
   Scenario_display_border value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Scenario_display_border_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Scenario_is_active                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Scenario_is_active (OSCTXT* pctxt,
   Scenario_is_active *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Scenario_is_active (OSCTXT* pctxt, Scenario_is_active value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Scenario_is_active_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Scenario_protected_                                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Scenario_protected_ (OSCTXT* pctxt,
   Scenario_protected_ *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Scenario_protected_ (OSCTXT* pctxt, Scenario_protected_ value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Scenario_protected__ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Scenario                                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Scenario (OSCTXT* pctxt,
   Scenario *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode scenario_ranges */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
      xe_utf8str (pctxt, pvalue->scenario_ranges, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode protected_ */

   if (pvalue->m.protected_Present) {
      if(pvalue->protected_ < 0 || pvalue->protected_ > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Scenario_protected_ (pctxt, &pvalue->protected_, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode is_active */

   if(pvalue->is_active < 0 || pvalue->is_active > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
      asn1E_Scenario_is_active (pctxt, &pvalue->is_active, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode display_border */

   if (pvalue->m.display_borderPresent) {
      if(pvalue->display_border < 0 || pvalue->display_border > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Scenario_display_border (pctxt, &pvalue->display_border, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode copy_styles */

   if (pvalue->m.copy_stylesPresent) {
      if(pvalue->copy_styles < 0 || pvalue->copy_styles > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Scenario_copy_styles (pctxt, &pvalue->copy_styles, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode copy_formulas */

   if (pvalue->m.copy_formulasPresent) {
      if(pvalue->copy_formulas < 0 || pvalue->copy_formulas > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Scenario_copy_formulas (pctxt, &pvalue->copy_formulas, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode copy_back */

   if (pvalue->m.copy_backPresent) {
      if(pvalue->copy_back < 0 || pvalue->copy_back > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Scenario_copy_back (pctxt, &pvalue->copy_back, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode comment */

   if (pvalue->m.commentPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->comment, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode border_color */

   if (pvalue->m.border_colorPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->border_color, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Scenario (OSCTXT* pctxt, Scenario* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.border_colorPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:border-color=\""), 20);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->border_color, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.commentPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:comment=\""), 15);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->comment, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.copy_backPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:copy-back=\""), 17);

      if(pvalue->copy_back < 0 || pvalue->copy_back > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Scenario_copy_back (pctxt, pvalue->copy_back, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.copy_formulasPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:copy-formulas=\""), 21);

      if(pvalue->copy_formulas < 0 || pvalue->copy_formulas > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Scenario_copy_formulas (pctxt, pvalue->copy_formulas
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.copy_stylesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:copy-styles=\""), 19);

      if(pvalue->copy_styles < 0 || pvalue->copy_styles > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Scenario_copy_styles (pctxt, pvalue->copy_styles, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.display_borderPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:display-border=\""), 22);

      if(pvalue->display_border < 0 || pvalue->display_border > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Scenario_display_border (pctxt, pvalue->display_border
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:is-active=\""), 17);

   if(pvalue->is_active < 0 || pvalue->is_active > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Scenario_is_active (pctxt, pvalue->is_active, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.protected_Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:protected=\""), 17);

      if(pvalue->protected_ < 0 || pvalue->protected_ > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Scenario_protected_ (pctxt, pvalue->protected_, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:scenario-ranges=\""), 23);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->scenario_ranges, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Shapes_element                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Shapes_element (OSCTXT* pctxt,
   Shapes_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Ns3_Rect (pctxt, (Ns3_Rect*)pvalue->u.rect, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Ns3_Line (pctxt, (Ns3_Line*)pvalue->u.line, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Ns3_Polyline (pctxt, (Ns3_Polyline*)pvalue->u.polyline, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Ns3_Polygon (pctxt, (Ns3_Polygon*)pvalue->u.polygon, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
            asn1E_Ns3_Regular_polygon (pctxt, (Ns3_Regular_polygon*)pvalue->u.regular_polygon, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 6:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
            asn1E_Ns3_Path (pctxt, (Ns3_Path*)pvalue->u.path, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 7:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
            asn1E_Ns3_Circle (pctxt, (Ns3_Circle*)pvalue->u.circle, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 8:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
            asn1E_Ns3_Ellipse (pctxt, (Ns3_Ellipse*)pvalue->u.ellipse, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 9:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
            asn1E_Ns3_G (pctxt, (Ns3_G*)pvalue->u.g, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 10:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
            asn1E_Ns3_Page_thumbnail (pctxt, (Ns3_Page_thumbnail*)pvalue->u.page_thumbnail, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 11:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
            asn1E_Ns3_Frame (pctxt, (Ns3_Frame*)pvalue->u.frame, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 12:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
            asn1E_Ns3_Measure (pctxt, (Ns3_Measure*)pvalue->u.measure, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 13:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
            asn1E_Ns3_Caption (pctxt, (Ns3_Caption*)pvalue->u.caption, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 14:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
            asn1E_Ns3_Connector (pctxt, (Ns3_Connector*)pvalue->u.connector, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 15:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|14,
            asn1E_Ns3_Control (pctxt, (Ns3_Control*)pvalue->u.control, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 16:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|15,
            asn1E_Ns7_Scene (pctxt, (Ns7_Scene*)pvalue->u.scene, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 17:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|16,
            asn1E_Ns3_Custom_shape (pctxt, (Ns3_Custom_shape*)pvalue->u.custom_shape, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Shapes_element (OSCTXT* pctxt, Shapes_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode rect */

         stat = XmlEnc_Ns3_Rect (pctxt, pvalue->u.rect
            , OSUTF8("rect"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode line */

         stat = XmlEnc_Ns3_Line (pctxt, pvalue->u.line
            , OSUTF8("line"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode polyline */

         stat = XmlEnc_Ns3_Polyline (pctxt, pvalue->u.polyline
            , OSUTF8("polyline"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode polygon */

         stat = XmlEnc_Ns3_Polygon (pctxt, pvalue->u.polygon
            , OSUTF8("polygon"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode regular_polygon */

         stat = XmlEnc_Ns3_Regular_polygon (pctxt, pvalue->u.regular_polygon
            , OSUTF8("regular-polygon"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 6:
         /* encode path */

         stat = XmlEnc_Ns3_Path (pctxt, pvalue->u.path
            , OSUTF8("path"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 7:
         /* encode circle */

         stat = XmlEnc_Ns3_Circle (pctxt, pvalue->u.circle
            , OSUTF8("circle"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 8:
         /* encode ellipse */

         stat = XmlEnc_Ns3_Ellipse (pctxt, pvalue->u.ellipse
            , OSUTF8("ellipse"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 9:
         /* encode g */

         stat = XmlEnc_Ns3_G (pctxt, pvalue->u.g, OSUTF8("g"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 10:
         /* encode page_thumbnail */

         stat = XmlEnc_Ns3_Page_thumbnail (pctxt, pvalue->u.page_thumbnail
            , OSUTF8("page-thumbnail"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 11:
         /* encode frame */

         stat = XmlEnc_Ns3_Frame (pctxt, pvalue->u.frame
            , OSUTF8("frame"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 12:
         /* encode measure */

         stat = XmlEnc_Ns3_Measure (pctxt, pvalue->u.measure
            , OSUTF8("measure"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 13:
         /* encode caption */

         stat = XmlEnc_Ns3_Caption (pctxt, pvalue->u.caption
            , OSUTF8("caption"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 14:
         /* encode connector */

         stat = XmlEnc_Ns3_Connector (pctxt, pvalue->u.connector
            , OSUTF8("connector"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 15:
         /* encode control */

         stat = XmlEnc_Ns3_Control (pctxt, pvalue->u.control
            , OSUTF8("control"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 16:
         /* encode scene */

         stat = XmlEnc_Ns7_Scene (pctxt, pvalue->u.scene
            , OSUTF8("scene"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 17:
         /* encode custom_shape */

         stat = XmlEnc_Ns3_Custom_shape (pctxt, pvalue->u.custom_shape
            , OSUTF8("custom-shape"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Shapes                                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Shapes (OSCTXT* pctxt,
   Shapes *pvalue, ASN1TagType tagging)
{
   OSRTDListNode* pnode1;
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   pnode1 = pvalue->tail;
   while (0 != pnode1) {
      ll = asn1E_Shapes_element (pctxt, ((Shapes_element*)pnode1->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;

      pnode1 = pnode1->prev;
   }
   ll1 = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll1);
   if (ll1 < 0) return LOG_RTERR (pctxt, ll1);

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Shapes (OSCTXT* pctxt, Shapes* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (elemName != 0) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->head;
   while (0 != pnode) {
      stat = XmlEnc_Shapes_element (pctxt, ((Shapes_element*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_column_group_display                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_column_group_display (OSCTXT* pctxt,
   Table_column_group_display *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Table_column_group_display (OSCTXT* pctxt, 
   Table_column_group_display value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Table_column_group_display_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_column_default_cell_style_name                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_column_default_cell_style_name (OSCTXT* pctxt,
   Table_column_default_cell_style_name *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_utf8str (pctxt, pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Table_column_default_cell_style_name (OSCTXT* pctxt, 
   Table_column_default_cell_style_name* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt_1, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_column_style_name                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_column_style_name (OSCTXT* pctxt,
   Table_column_style_name *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_utf8str (pctxt, pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Table_column_style_name (OSCTXT* pctxt, 
   Table_column_style_name* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt_1, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_column_visibility                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_column_visibility (OSCTXT* pctxt,
   Table_column_visibility *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Table_column_visibility (OSCTXT* pctxt, 
   Table_column_visibility value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Table_column_visibility_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_column                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_column (OSCTXT* pctxt,
   Table_column *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode visibility */

   if (pvalue->m.visibilityPresent) {
      if(pvalue->visibility < 0 || pvalue->visibility > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Table_column_visibility (pctxt, &pvalue->visibility, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Table_column_style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode number_columns_repeated */

   if (pvalue->m.number_columns_repeatedPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_unsigned (pctxt, &pvalue->number_columns_repeated, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode default_cell_style_name */

   if (pvalue->m.default_cell_style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Table_column_default_cell_style_name (pctxt, &pvalue->default_cell_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Table_column (OSCTXT* pctxt, Table_column* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.default_cell_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:default-cell-style-name=\""), 31);

      stat = XmlEnc_Table_column_default_cell_style_name (pctxt, &pvalue->
         default_cell_style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.number_columns_repeatedPresent) {
      stat = rtXmlEncUIntAttr
         (pctxt, pvalue->number_columns_repeated
            , OSUTF8("ns15:number-columns-repeated"), 28);
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:style-name=\""), 18);

      stat = XmlEnc_Table_column_style_name (pctxt, &pvalue->style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.visibilityPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:visibility=\""), 18);

      if(pvalue->visibility < 0 || pvalue->visibility > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_column_visibility (pctxt, pvalue->visibility, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_columns                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_columns (OSCTXT* pctxt,
   Table_columns *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode table_column_list */

   pnode2 = pvalue->table_column_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Table_column (pctxt, ((Table_column*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Table_columns (OSCTXT* pctxt, Table_columns* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode table_column_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->table_column_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Table_column (pctxt, ((Table_column*)pnode->data)
         , OSUTF8("table-column"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_header_columns                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_header_columns (OSCTXT* pctxt,
   Table_header_columns *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode table_column_list */

   pnode2 = pvalue->table_column_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Table_column (pctxt, ((Table_column*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Table_header_columns (OSCTXT* pctxt, Table_header_columns* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode table_column_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->table_column_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Table_column (pctxt, ((Table_column*)pnode->data)
         , OSUTF8("table-column"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_column_group_element                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_column_group_element (OSCTXT* pctxt,
   Table_column_group_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Table_column_group (pctxt, (Table_column_group*)pvalue->u.table_column_group, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Table_columns (pctxt, pvalue->u.table_columns, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Table_column (pctxt, pvalue->u.table_column, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Table_header_columns (pctxt, pvalue->u.table_header_columns, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Table_column_group_element (OSCTXT* pctxt, 
   Table_column_group_element* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode table_column_group */

         stat = XmlEnc_Table_column_group (pctxt, pvalue->u.table_column_group
            , OSUTF8("table-column-group"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode table_columns */

         stat = XmlEnc_Table_columns (pctxt, pvalue->u.table_columns
            , OSUTF8("table-columns"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode table_column */

         stat = XmlEnc_Table_column (pctxt, pvalue->u.table_column
            , OSUTF8("table-column"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode table_header_columns */

         stat = XmlEnc_Table_header_columns (pctxt, pvalue->
            u.table_header_columns, OSUTF8("table-header-columns"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_column_group                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_column_group (OSCTXT* pctxt,
   Table_column_group *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Table_column_group_element (pctxt, ((Table_column_group_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode display */

   if (pvalue->m.displayPresent) {
      if(pvalue->display < 0 || pvalue->display > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Table_column_group_display (pctxt, &pvalue->display, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Table_column_group (OSCTXT* pctxt, Table_column_group* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.displayPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:display=\""), 15);

      if(pvalue->display < 0 || pvalue->display > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_column_group_display (pctxt, pvalue->display, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Table_column_group_element (pctxt, 
         ((Table_column_group_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_element                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_element (OSCTXT* pctxt,
   Table_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Table_column_group (pctxt, pvalue->u.table_column_group, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Table_columns (pctxt, pvalue->u.table_columns, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Table_column (pctxt, pvalue->u.table_column, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Table_header_columns (pctxt, pvalue->u.table_header_columns, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Table_element (OSCTXT* pctxt, Table_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode table_column_group */

         stat = XmlEnc_Table_column_group (pctxt, pvalue->u.table_column_group
            , OSUTF8("table-column-group"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode table_columns */

         stat = XmlEnc_Table_columns (pctxt, pvalue->u.table_columns
            , OSUTF8("table-columns"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode table_column */

         stat = XmlEnc_Table_column (pctxt, pvalue->u.table_column
            , OSUTF8("table-column"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode table_header_columns */

         stat = XmlEnc_Table_header_columns (pctxt, pvalue->
            u.table_header_columns, OSUTF8("table-header-columns"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_row_group_display                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_row_group_display (OSCTXT* pctxt,
   Table_row_group_display *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Table_row_group_display (OSCTXT* pctxt, 
   Table_row_group_display value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Table_row_group_display_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_row_default_cell_style_name                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_row_default_cell_style_name (OSCTXT* pctxt,
   Table_row_default_cell_style_name *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_utf8str (pctxt, pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Table_row_default_cell_style_name (OSCTXT* pctxt, 
   Table_row_default_cell_style_name* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt_1, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_row_style_name                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_row_style_name (OSCTXT* pctxt,
   Table_row_style_name *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_utf8str (pctxt, pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Table_row_style_name (OSCTXT* pctxt, Table_row_style_name* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt_1, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_row_visibility                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_row_visibility (OSCTXT* pctxt,
   Table_row_visibility *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Table_row_visibility (OSCTXT* pctxt, Table_row_visibility value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Table_row_visibility_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_cell_value_type                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_cell_value_type (OSCTXT* pctxt,
   Table_cell_value_type *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 6)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Table_cell_value_type (OSCTXT* pctxt, Table_cell_value_type value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Table_cell_value_type_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_cell_protect                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_cell_protect (OSCTXT* pctxt,
   Table_cell_protect *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Table_cell_protect (OSCTXT* pctxt, Table_cell_protect value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Table_cell_protect_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_cell_style_name                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_cell_style_name (OSCTXT* pctxt,
   Table_cell_style_name *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_utf8str (pctxt, pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Table_cell_style_name (OSCTXT* pctxt, 
   Table_cell_style_name* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt_1, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Cell_range_source_actuate                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Cell_range_source_actuate (OSCTXT* pctxt,
   Cell_range_source_actuate *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Cell_range_source_actuate (OSCTXT* pctxt, 
   Cell_range_source_actuate value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Cell_range_source_actuate_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Cell_range_source                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Cell_range_source (OSCTXT* pctxt,
   Cell_range_source *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode refresh_delay */

   if (pvalue->m.refresh_delayPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         xe_utf8str (pctxt, pvalue->refresh_delay, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
      xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode last_row_spanned */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
      xe_unsigned (pctxt, &pvalue->last_row_spanned, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode last_column_spanned */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
      xe_unsigned (pctxt, &pvalue->last_column_spanned, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode filter_options */

   if (pvalue->m.filter_optionsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->filter_options, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode filter_name */

   if (pvalue->m.filter_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_utf8str (pctxt, pvalue->filter_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode type */

   if (pvalue->m.typePresent) {
      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Xlink_Type (pctxt, &pvalue->type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode href */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      asn1E_Xlink_Href (pctxt, pvalue->href, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode actuate */

   if (pvalue->m.actuatePresent) {
      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Cell_range_source_actuate (pctxt, &pvalue->actuate, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Cell_range_source (OSCTXT* pctxt, Cell_range_source* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.actuatePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:actuate=\""), 16);

      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Cell_range_source_actuate (pctxt, pvalue->actuate, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:href=\""), 13);

   stat = XmlEnc_Xlink_Href (pctxt, pvalue->href, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:type=\""), 13);

      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Xlink_Type (pctxt, pvalue->type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.filter_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:filter-name=\""), 19);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->filter_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.filter_optionsPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:filter-options=\""), 22);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->filter_options, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   stat = rtXmlEncUIntAttr
      (pctxt, pvalue->last_column_spanned
         , OSUTF8("ns15:last-column-spanned"), 24);

   stat = rtXmlEncUIntAttr
      (pctxt, pvalue->last_row_spanned, OSUTF8("ns15:last-row-spanned"), 21);

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:name=\""), 12);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.refresh_delayPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:refresh-delay=\""), 21);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->refresh_delay, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Cell_range_address                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Cell_range_address (OSCTXT* pctxt,
   Cell_range_address pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Cell_range_address (OSCTXT* pctxt, Cell_range_address value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Highlighted_range_contains_error                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Highlighted_range_contains_error (OSCTXT* pctxt,
   Highlighted_range_contains_error *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Highlighted_range_contains_error (OSCTXT* pctxt, 
   Highlighted_range_contains_error value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Highlighted_range_contains_error_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Highlighted_range_direction                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Highlighted_range_direction (OSCTXT* pctxt,
   Highlighted_range_direction *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Highlighted_range_direction (OSCTXT* pctxt, 
   Highlighted_range_direction value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Highlighted_range_direction_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Highlighted_range_marked_invalid                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Highlighted_range_marked_invalid (OSCTXT* pctxt,
   Highlighted_range_marked_invalid *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Highlighted_range_marked_invalid (OSCTXT* pctxt, 
   Highlighted_range_marked_invalid value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Highlighted_range_marked_invalid_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Highlighted_range                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Highlighted_range (OSCTXT* pctxt,
   Highlighted_range *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode marked_invalid */

   if (pvalue->m.marked_invalidPresent) {
      if(pvalue->marked_invalid < 0 || pvalue->marked_invalid > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Highlighted_range_marked_invalid (pctxt, &pvalue->marked_invalid, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode direction */

   if (pvalue->m.directionPresent) {
      if(pvalue->direction < 0 || pvalue->direction > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Highlighted_range_direction (pctxt, &pvalue->direction, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode contains_error */

   if (pvalue->m.contains_errorPresent) {
      if(pvalue->contains_error < 0 || pvalue->contains_error > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Highlighted_range_contains_error (pctxt, &pvalue->contains_error, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode cell_range_address */

   if (pvalue->m.cell_range_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Cell_range_address (pctxt, pvalue->cell_range_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Highlighted_range (OSCTXT* pctxt, Highlighted_range* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.cell_range_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:cell-range-address=\""), 26);

      stat = XmlEnc_Cell_range_address (pctxt, pvalue->cell_range_address
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.contains_errorPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:contains-error=\""), 22);

      if(pvalue->contains_error < 0 || pvalue->contains_error > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Highlighted_range_contains_error (pctxt, pvalue->
         contains_error, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.directionPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:direction=\""), 17);

      if(pvalue->direction < 0 || pvalue->direction > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Highlighted_range_direction (pctxt, pvalue->direction
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.marked_invalidPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:marked-invalid=\""), 22);

      if(pvalue->marked_invalid < 0 || pvalue->marked_invalid > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Highlighted_range_marked_invalid (pctxt, pvalue->
         marked_invalid, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Operation_name                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Operation_name (OSCTXT* pctxt,
   Operation_name *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 4)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Operation_name (OSCTXT* pctxt, Operation_name value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Operation_name_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Operation                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Operation (OSCTXT* pctxt,
   Operation *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode name */

   if(pvalue->name < 0 || pvalue->name > 4)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      asn1E_Operation_name (pctxt, &pvalue->name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode index */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_unsigned (pctxt, &pvalue->index, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Operation (OSCTXT* pctxt, Operation* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   stat = rtXmlEncUIntAttr
      (pctxt, pvalue->index, OSUTF8("ns15:index"), 10);

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:name=\""), 12);

   if(pvalue->name < 0 || pvalue->name > 4)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Operation_name (pctxt, pvalue->name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Detective                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Detective (OSCTXT* pctxt,
   Detective *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode operation_list */

   pnode2 = pvalue->operation_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Operation (pctxt, ((Operation*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode highlighted_range_list */

   pnode2 = pvalue->highlighted_range_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Highlighted_range (pctxt, ((Highlighted_range*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Detective (OSCTXT* pctxt, Detective* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode highlighted_range_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->highlighted_range_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Highlighted_range (pctxt, ((Highlighted_range*)pnode->data)
         , OSUTF8("highlighted-range"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode operation_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->operation_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Operation (pctxt, ((Operation*)pnode->data)
         , OSUTF8("operation"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_cell_element                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_cell_element (OSCTXT* pctxt,
   Table_cell_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_H (pctxt, (Odf_H*)pvalue->u.h, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Odf_Numbered_paragraph (pctxt, (Odf_Numbered_paragraph*)pvalue->u.numbered_paragraph, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
            asn1E_Table (pctxt, (Table*)pvalue->u.table, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 6:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
            asn1E_Ns3_A (pctxt, (Ns3_A*)pvalue->u.a, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 7:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
            asn1E_Odf_Section (pctxt, (Odf_Section*)pvalue->u.section, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 8:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
            asn1E_Odf_Table_of_content (pctxt, (Odf_Table_of_content*)pvalue->u.table_of_content, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 9:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
            asn1E_Odf_Illustration_index (pctxt, (Odf_Illustration_index*)pvalue->u.illustration_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 10:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
            asn1E_Odf_Table_index (pctxt, (Odf_Table_index*)pvalue->u.table_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 11:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
            asn1E_Odf_Object_index (pctxt, (Odf_Object_index*)pvalue->u.object_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 12:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
            asn1E_Odf_User_index (pctxt, (Odf_User_index*)pvalue->u.user_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 13:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
            asn1E_Odf_Alphabetical_index (pctxt, (Odf_Alphabetical_index*)pvalue->u.alphabetical_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 14:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
            asn1E_Odf_Bibliography (pctxt, (Odf_Bibliography*)pvalue->u.bibliography, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 15:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|14,
            asn1E_Ns3_Rect (pctxt, (Ns3_Rect*)pvalue->u.rect, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 16:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|15,
            asn1E_Ns3_Line (pctxt, (Ns3_Line*)pvalue->u.line, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 17:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|16,
            asn1E_Ns3_Polyline (pctxt, (Ns3_Polyline*)pvalue->u.polyline, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 18:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|17,
            asn1E_Ns3_Polygon (pctxt, (Ns3_Polygon*)pvalue->u.polygon, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 19:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|18,
            asn1E_Ns3_Regular_polygon (pctxt, (Ns3_Regular_polygon*)pvalue->u.regular_polygon, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 20:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|19,
            asn1E_Ns3_Path (pctxt, (Ns3_Path*)pvalue->u.path, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 21:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|20,
            asn1E_Ns3_Circle (pctxt, (Ns3_Circle*)pvalue->u.circle, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 22:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|21,
            asn1E_Ns3_Ellipse (pctxt, (Ns3_Ellipse*)pvalue->u.ellipse, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 23:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|22,
            asn1E_Ns3_G (pctxt, (Ns3_G*)pvalue->u.g, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 24:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|23,
            asn1E_Ns3_Page_thumbnail (pctxt, (Ns3_Page_thumbnail*)pvalue->u.page_thumbnail, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 25:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|24,
            asn1E_Ns3_Frame (pctxt, (Ns3_Frame*)pvalue->u.frame, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 26:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|25,
            asn1E_Ns3_Measure (pctxt, (Ns3_Measure*)pvalue->u.measure, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 27:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|26,
            asn1E_Ns3_Caption (pctxt, (Ns3_Caption*)pvalue->u.caption, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 28:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|27,
            asn1E_Ns3_Connector (pctxt, (Ns3_Connector*)pvalue->u.connector, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 29:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|28,
            asn1E_Ns3_Control (pctxt, (Ns3_Control*)pvalue->u.control, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 30:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|29,
            asn1E_Ns7_Scene (pctxt, (Ns7_Scene*)pvalue->u.scene, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 31:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|30,
            asn1E_Ns3_Custom_shape (pctxt, (Ns3_Custom_shape*)pvalue->u.custom_shape, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 32:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|31,
            asn1E_Odf_Change (pctxt, (Odf_Change*)pvalue->u.change, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 33:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|32,
            asn1E_Odf_Change_start (pctxt, (Odf_Change_start*)pvalue->u.change_start, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 34:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|33,
            asn1E_Odf_Change_end (pctxt, (Odf_Change_end*)pvalue->u.change_end, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Table_cell_element (OSCTXT* pctxt, Table_cell_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode h */

         stat = XmlEnc_Odf_H (pctxt, pvalue->u.h, OSUTF8("h"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode numbered_paragraph */

         stat = XmlEnc_Odf_Numbered_paragraph (pctxt, pvalue->
            u.numbered_paragraph, OSUTF8("numbered-paragraph"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode table */

         stat = XmlEnc_Table (pctxt, pvalue->u.table
            , OSUTF8("table"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 6:
         /* encode a */

         stat = XmlEnc_Ns3_A (pctxt, pvalue->u.a, OSUTF8("a"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 7:
         /* encode section */

         stat = XmlEnc_Odf_Section (pctxt, pvalue->u.section
            , OSUTF8("section"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 8:
         /* encode table_of_content */

         stat = XmlEnc_Odf_Table_of_content (pctxt, pvalue->u.table_of_content
            , OSUTF8("table-of-content"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 9:
         /* encode illustration_index */

         stat = XmlEnc_Odf_Illustration_index (pctxt, pvalue->
            u.illustration_index, OSUTF8("illustration-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 10:
         /* encode table_index */

         stat = XmlEnc_Odf_Table_index (pctxt, pvalue->u.table_index
            , OSUTF8("table-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 11:
         /* encode object_index */

         stat = XmlEnc_Odf_Object_index (pctxt, pvalue->u.object_index
            , OSUTF8("object-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 12:
         /* encode user_index */

         stat = XmlEnc_Odf_User_index (pctxt, pvalue->u.user_index
            , OSUTF8("user-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 13:
         /* encode alphabetical_index */

         stat = XmlEnc_Odf_Alphabetical_index (pctxt, pvalue->
            u.alphabetical_index, OSUTF8("alphabetical-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 14:
         /* encode bibliography */

         stat = XmlEnc_Odf_Bibliography (pctxt, pvalue->u.bibliography
            , OSUTF8("bibliography"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 15:
         /* encode rect */

         stat = XmlEnc_Ns3_Rect (pctxt, pvalue->u.rect
            , OSUTF8("rect"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 16:
         /* encode line */

         stat = XmlEnc_Ns3_Line (pctxt, pvalue->u.line
            , OSUTF8("line"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 17:
         /* encode polyline */

         stat = XmlEnc_Ns3_Polyline (pctxt, pvalue->u.polyline
            , OSUTF8("polyline"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 18:
         /* encode polygon */

         stat = XmlEnc_Ns3_Polygon (pctxt, pvalue->u.polygon
            , OSUTF8("polygon"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 19:
         /* encode regular_polygon */

         stat = XmlEnc_Ns3_Regular_polygon (pctxt, pvalue->u.regular_polygon
            , OSUTF8("regular-polygon"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 20:
         /* encode path */

         stat = XmlEnc_Ns3_Path (pctxt, pvalue->u.path
            , OSUTF8("path"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 21:
         /* encode circle */

         stat = XmlEnc_Ns3_Circle (pctxt, pvalue->u.circle
            , OSUTF8("circle"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 22:
         /* encode ellipse */

         stat = XmlEnc_Ns3_Ellipse (pctxt, pvalue->u.ellipse
            , OSUTF8("ellipse"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 23:
         /* encode g */

         stat = XmlEnc_Ns3_G (pctxt, pvalue->u.g, OSUTF8("g"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 24:
         /* encode page_thumbnail */

         stat = XmlEnc_Ns3_Page_thumbnail (pctxt, pvalue->u.page_thumbnail
            , OSUTF8("page-thumbnail"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 25:
         /* encode frame */

         stat = XmlEnc_Ns3_Frame (pctxt, pvalue->u.frame
            , OSUTF8("frame"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 26:
         /* encode measure */

         stat = XmlEnc_Ns3_Measure (pctxt, pvalue->u.measure
            , OSUTF8("measure"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 27:
         /* encode caption */

         stat = XmlEnc_Ns3_Caption (pctxt, pvalue->u.caption
            , OSUTF8("caption"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 28:
         /* encode connector */

         stat = XmlEnc_Ns3_Connector (pctxt, pvalue->u.connector
            , OSUTF8("connector"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 29:
         /* encode control */

         stat = XmlEnc_Ns3_Control (pctxt, pvalue->u.control
            , OSUTF8("control"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 30:
         /* encode scene */

         stat = XmlEnc_Ns7_Scene (pctxt, pvalue->u.scene
            , OSUTF8("scene"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 31:
         /* encode custom_shape */

         stat = XmlEnc_Ns3_Custom_shape (pctxt, pvalue->u.custom_shape
            , OSUTF8("custom-shape"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 32:
         /* encode change */

         stat = XmlEnc_Odf_Change (pctxt, pvalue->u.change
            , OSUTF8("change"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 33:
         /* encode change_start */

         stat = XmlEnc_Odf_Change_start (pctxt, pvalue->u.change_start
            , OSUTF8("change-start"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 34:
         /* encode change_end */

         stat = XmlEnc_Odf_Change_end (pctxt, pvalue->u.change_end
            , OSUTF8("change-end"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_cell                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_cell (OSCTXT* pctxt,
   Table_cell *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Table_cell_element (pctxt, ((Table_cell_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|19, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode detective */

   if (pvalue->m.detectivePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|18,
         asn1E_Detective (pctxt, &pvalue->detective, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode annotation */

   if (pvalue->m.annotationPresent) {
      if (pvalue->annotation == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->annotation");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|17,
         asn1E_Ns13_Annotation (pctxt, (Ns13_Annotation*)pvalue->annotation, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode cell_range_source */

   if (pvalue->m.cell_range_sourcePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|16,
         asn1E_Cell_range_source (pctxt, &pvalue->cell_range_source, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|15,
         asn1E_Table_cell_style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode protect */

   if (pvalue->m.protectPresent) {
      if(pvalue->protect < 0 || pvalue->protect > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|14,
         asn1E_Table_cell_protect (pctxt, &pvalue->protect, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode number_rows_spanned */

   if (pvalue->m.number_rows_spannedPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         xe_unsigned (pctxt, &pvalue->number_rows_spanned, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode number_matrix_rows_spanned */

   if (pvalue->m.number_matrix_rows_spannedPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|12,
         xe_unsigned (pctxt, &pvalue->number_matrix_rows_spanned, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode number_matrix_columns_spanned */

   if (pvalue->m.number_matrix_columns_spannedPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
         xe_unsigned (pctxt, &pvalue->number_matrix_columns_spanned, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode number_columns_spanned */

   if (pvalue->m.number_columns_spannedPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
         xe_unsigned (pctxt, &pvalue->number_columns_spanned, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode number_columns_repeated */

   if (pvalue->m.number_columns_repeatedPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         xe_unsigned (pctxt, &pvalue->number_columns_repeated, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode formula */

   if (pvalue->m.formulaPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         xe_utf8str (pctxt, pvalue->formula, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode content_validation_name */

   if (pvalue->m.content_validation_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         xe_utf8str (pctxt, pvalue->content_validation_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode value_type */

   if (pvalue->m.value_typePresent) {
      if(pvalue->value_type < 0 || pvalue->value_type > 6)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         asn1E_Table_cell_value_type (pctxt, &pvalue->value_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode value */

   if (pvalue->m.valuePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns13_Value (pctxt, (Ns13_Value*)&pvalue->value, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode time_value */

   if (pvalue->m.time_valuePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns13_Time_value (pctxt, (Ns13_Time_value)pvalue->time_value, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode string_value */

   if (pvalue->m.string_valuePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns13_String_value (pctxt, (Ns13_String_value)pvalue->string_value, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode date_value */

   if (pvalue->m.date_valuePresent) {
      if (pvalue->date_value == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->date_value");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Ns13_Date_value (pctxt, (Ns13_Date_value*)pvalue->date_value, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode currency */

   if (pvalue->m.currencyPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns13_Currency (pctxt, (Ns13_Currency)pvalue->currency, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode boolean_value */

   if (pvalue->m.boolean_valuePresent) {
      if(pvalue->boolean_value < 0 || pvalue->boolean_value > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns13_Boolean_value (pctxt, (Ns13_Boolean_value*)&pvalue->boolean_value, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Table_cell (OSCTXT* pctxt, Table_cell* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.boolean_valuePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:boolean-value=\""), 21);

      if(pvalue->boolean_value < 0 || pvalue->boolean_value > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns13_Boolean_value (pctxt, pvalue->boolean_value, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.currencyPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:currency=\""), 16);

      stat = XmlEnc_Ns13_Currency (pctxt, pvalue->currency, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.date_valuePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:date-value=\""), 18);

      stat = XmlEnc_Ns13_Date_value (pctxt, pvalue->date_value, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.string_valuePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:string-value=\""), 20);

      stat = XmlEnc_Ns13_String_value (pctxt, pvalue->string_value, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.time_valuePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:time-value=\""), 18);

      stat = XmlEnc_Ns13_Time_value (pctxt, pvalue->time_value, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.valuePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:value=\""), 13);

      stat = XmlEnc_Ns13_Value (pctxt, pvalue->value, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.value_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:value-type=\""), 18);

      if(pvalue->value_type < 0 || pvalue->value_type > 6)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_cell_value_type (pctxt, pvalue->value_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.content_validation_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:content-validation-name=\""), 31);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->content_validation_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.formulaPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:formula=\""), 15);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->formula, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.number_columns_repeatedPresent) {
      stat = rtXmlEncUIntAttr
         (pctxt, pvalue->number_columns_repeated
            , OSUTF8("ns15:number-columns-repeated"), 28);
   }

   if (pvalue->m.number_columns_spannedPresent) {
      stat = rtXmlEncUIntAttr
         (pctxt, pvalue->number_columns_spanned
            , OSUTF8("ns15:number-columns-spanned"), 27);
   }

   if (pvalue->m.number_matrix_columns_spannedPresent) {
      stat = rtXmlEncUIntAttr
         (pctxt, pvalue->number_matrix_columns_spanned
            , OSUTF8("ns15:number-matrix-columns-spanned"), 34);
   }

   if (pvalue->m.number_matrix_rows_spannedPresent) {
      stat = rtXmlEncUIntAttr
         (pctxt, pvalue->number_matrix_rows_spanned
            , OSUTF8("ns15:number-matrix-rows-spanned"), 31);
   }

   if (pvalue->m.number_rows_spannedPresent) {
      stat = rtXmlEncUIntAttr
         (pctxt, pvalue->number_rows_spanned
            , OSUTF8("ns15:number-rows-spanned"), 24);
   }

   if (pvalue->m.protectPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:protect=\""), 15);

      if(pvalue->protect < 0 || pvalue->protect > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_cell_protect (pctxt, pvalue->protect, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:style-name=\""), 18);

      stat = XmlEnc_Table_cell_style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode cell_range_source */

   if (pvalue->m.cell_range_sourcePresent) {
      stat = XmlEnc_Cell_range_source (pctxt, &pvalue->cell_range_source
         , OSUTF8("cell-range-source"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode annotation */

   if (pvalue->m.annotationPresent) {
      stat = XmlEnc_Ns13_Annotation (pctxt, pvalue->annotation
         , OSUTF8("annotation"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode detective */

   if (pvalue->m.detectivePresent) {
      stat = XmlEnc_Detective (pctxt, &pvalue->detective
         , OSUTF8("detective"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Table_cell_element (pctxt, 
         ((Table_cell_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Covered_table_cell_value_type                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Covered_table_cell_value_type (OSCTXT* pctxt,
   Covered_table_cell_value_type *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 6)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Covered_table_cell_value_type (OSCTXT* pctxt, 
   Covered_table_cell_value_type value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Covered_table_cell_value_type_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Covered_table_cell_protect                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Covered_table_cell_protect (OSCTXT* pctxt,
   Covered_table_cell_protect *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Covered_table_cell_protect (OSCTXT* pctxt, 
   Covered_table_cell_protect value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Covered_table_cell_protect_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Covered_table_cell_style_name                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Covered_table_cell_style_name (OSCTXT* pctxt,
   Covered_table_cell_style_name *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_utf8str (pctxt, pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Covered_table_cell_style_name (OSCTXT* pctxt, 
   Covered_table_cell_style_name* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt_1, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Covered_table_cell_element                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Covered_table_cell_element (OSCTXT* pctxt,
   Covered_table_cell_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_H (pctxt, (Odf_H*)pvalue->u.h, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Odf_Numbered_paragraph (pctxt, (Odf_Numbered_paragraph*)pvalue->u.numbered_paragraph, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
            asn1E_Table (pctxt, (Table*)pvalue->u.table, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 6:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
            asn1E_Ns3_A (pctxt, (Ns3_A*)pvalue->u.a, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 7:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
            asn1E_Odf_Section (pctxt, (Odf_Section*)pvalue->u.section, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 8:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
            asn1E_Odf_Table_of_content (pctxt, (Odf_Table_of_content*)pvalue->u.table_of_content, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 9:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
            asn1E_Odf_Illustration_index (pctxt, (Odf_Illustration_index*)pvalue->u.illustration_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 10:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
            asn1E_Odf_Table_index (pctxt, (Odf_Table_index*)pvalue->u.table_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 11:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
            asn1E_Odf_Object_index (pctxt, (Odf_Object_index*)pvalue->u.object_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 12:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
            asn1E_Odf_User_index (pctxt, (Odf_User_index*)pvalue->u.user_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 13:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
            asn1E_Odf_Alphabetical_index (pctxt, (Odf_Alphabetical_index*)pvalue->u.alphabetical_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 14:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
            asn1E_Odf_Bibliography (pctxt, (Odf_Bibliography*)pvalue->u.bibliography, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 15:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|14,
            asn1E_Ns3_Rect (pctxt, (Ns3_Rect*)pvalue->u.rect, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 16:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|15,
            asn1E_Ns3_Line (pctxt, (Ns3_Line*)pvalue->u.line, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 17:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|16,
            asn1E_Ns3_Polyline (pctxt, (Ns3_Polyline*)pvalue->u.polyline, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 18:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|17,
            asn1E_Ns3_Polygon (pctxt, (Ns3_Polygon*)pvalue->u.polygon, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 19:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|18,
            asn1E_Ns3_Regular_polygon (pctxt, (Ns3_Regular_polygon*)pvalue->u.regular_polygon, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 20:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|19,
            asn1E_Ns3_Path (pctxt, (Ns3_Path*)pvalue->u.path, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 21:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|20,
            asn1E_Ns3_Circle (pctxt, (Ns3_Circle*)pvalue->u.circle, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 22:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|21,
            asn1E_Ns3_Ellipse (pctxt, (Ns3_Ellipse*)pvalue->u.ellipse, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 23:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|22,
            asn1E_Ns3_G (pctxt, (Ns3_G*)pvalue->u.g, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 24:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|23,
            asn1E_Ns3_Page_thumbnail (pctxt, (Ns3_Page_thumbnail*)pvalue->u.page_thumbnail, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 25:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|24,
            asn1E_Ns3_Frame (pctxt, (Ns3_Frame*)pvalue->u.frame, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 26:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|25,
            asn1E_Ns3_Measure (pctxt, (Ns3_Measure*)pvalue->u.measure, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 27:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|26,
            asn1E_Ns3_Caption (pctxt, (Ns3_Caption*)pvalue->u.caption, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 28:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|27,
            asn1E_Ns3_Connector (pctxt, (Ns3_Connector*)pvalue->u.connector, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 29:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|28,
            asn1E_Ns3_Control (pctxt, (Ns3_Control*)pvalue->u.control, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 30:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|29,
            asn1E_Ns7_Scene (pctxt, (Ns7_Scene*)pvalue->u.scene, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 31:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|30,
            asn1E_Ns3_Custom_shape (pctxt, (Ns3_Custom_shape*)pvalue->u.custom_shape, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 32:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|31,
            asn1E_Odf_Change (pctxt, (Odf_Change*)pvalue->u.change, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 33:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|32,
            asn1E_Odf_Change_start (pctxt, (Odf_Change_start*)pvalue->u.change_start, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 34:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|33,
            asn1E_Odf_Change_end (pctxt, (Odf_Change_end*)pvalue->u.change_end, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Covered_table_cell_element (OSCTXT* pctxt, 
   Covered_table_cell_element* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode h */

         stat = XmlEnc_Odf_H (pctxt, pvalue->u.h, OSUTF8("h"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode numbered_paragraph */

         stat = XmlEnc_Odf_Numbered_paragraph (pctxt, pvalue->
            u.numbered_paragraph, OSUTF8("numbered-paragraph"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode table */

         stat = XmlEnc_Table (pctxt, pvalue->u.table
            , OSUTF8("table"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 6:
         /* encode a */

         stat = XmlEnc_Ns3_A (pctxt, pvalue->u.a, OSUTF8("a"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 7:
         /* encode section */

         stat = XmlEnc_Odf_Section (pctxt, pvalue->u.section
            , OSUTF8("section"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 8:
         /* encode table_of_content */

         stat = XmlEnc_Odf_Table_of_content (pctxt, pvalue->u.table_of_content
            , OSUTF8("table-of-content"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 9:
         /* encode illustration_index */

         stat = XmlEnc_Odf_Illustration_index (pctxt, pvalue->
            u.illustration_index, OSUTF8("illustration-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 10:
         /* encode table_index */

         stat = XmlEnc_Odf_Table_index (pctxt, pvalue->u.table_index
            , OSUTF8("table-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 11:
         /* encode object_index */

         stat = XmlEnc_Odf_Object_index (pctxt, pvalue->u.object_index
            , OSUTF8("object-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 12:
         /* encode user_index */

         stat = XmlEnc_Odf_User_index (pctxt, pvalue->u.user_index
            , OSUTF8("user-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 13:
         /* encode alphabetical_index */

         stat = XmlEnc_Odf_Alphabetical_index (pctxt, pvalue->
            u.alphabetical_index, OSUTF8("alphabetical-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 14:
         /* encode bibliography */

         stat = XmlEnc_Odf_Bibliography (pctxt, pvalue->u.bibliography
            , OSUTF8("bibliography"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 15:
         /* encode rect */

         stat = XmlEnc_Ns3_Rect (pctxt, pvalue->u.rect
            , OSUTF8("rect"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 16:
         /* encode line */

         stat = XmlEnc_Ns3_Line (pctxt, pvalue->u.line
            , OSUTF8("line"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 17:
         /* encode polyline */

         stat = XmlEnc_Ns3_Polyline (pctxt, pvalue->u.polyline
            , OSUTF8("polyline"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 18:
         /* encode polygon */

         stat = XmlEnc_Ns3_Polygon (pctxt, pvalue->u.polygon
            , OSUTF8("polygon"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 19:
         /* encode regular_polygon */

         stat = XmlEnc_Ns3_Regular_polygon (pctxt, pvalue->u.regular_polygon
            , OSUTF8("regular-polygon"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 20:
         /* encode path */

         stat = XmlEnc_Ns3_Path (pctxt, pvalue->u.path
            , OSUTF8("path"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 21:
         /* encode circle */

         stat = XmlEnc_Ns3_Circle (pctxt, pvalue->u.circle
            , OSUTF8("circle"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 22:
         /* encode ellipse */

         stat = XmlEnc_Ns3_Ellipse (pctxt, pvalue->u.ellipse
            , OSUTF8("ellipse"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 23:
         /* encode g */

         stat = XmlEnc_Ns3_G (pctxt, pvalue->u.g, OSUTF8("g"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 24:
         /* encode page_thumbnail */

         stat = XmlEnc_Ns3_Page_thumbnail (pctxt, pvalue->u.page_thumbnail
            , OSUTF8("page-thumbnail"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 25:
         /* encode frame */

         stat = XmlEnc_Ns3_Frame (pctxt, pvalue->u.frame
            , OSUTF8("frame"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 26:
         /* encode measure */

         stat = XmlEnc_Ns3_Measure (pctxt, pvalue->u.measure
            , OSUTF8("measure"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 27:
         /* encode caption */

         stat = XmlEnc_Ns3_Caption (pctxt, pvalue->u.caption
            , OSUTF8("caption"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 28:
         /* encode connector */

         stat = XmlEnc_Ns3_Connector (pctxt, pvalue->u.connector
            , OSUTF8("connector"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 29:
         /* encode control */

         stat = XmlEnc_Ns3_Control (pctxt, pvalue->u.control
            , OSUTF8("control"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 30:
         /* encode scene */

         stat = XmlEnc_Ns7_Scene (pctxt, pvalue->u.scene
            , OSUTF8("scene"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 31:
         /* encode custom_shape */

         stat = XmlEnc_Ns3_Custom_shape (pctxt, pvalue->u.custom_shape
            , OSUTF8("custom-shape"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 32:
         /* encode change */

         stat = XmlEnc_Odf_Change (pctxt, pvalue->u.change
            , OSUTF8("change"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 33:
         /* encode change_start */

         stat = XmlEnc_Odf_Change_start (pctxt, pvalue->u.change_start
            , OSUTF8("change-start"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 34:
         /* encode change_end */

         stat = XmlEnc_Odf_Change_end (pctxt, pvalue->u.change_end
            , OSUTF8("change-end"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Covered_table_cell                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Covered_table_cell (OSCTXT* pctxt,
   Covered_table_cell *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Covered_table_cell_element (pctxt, ((Covered_table_cell_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|15, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode detective */

   if (pvalue->m.detectivePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|14,
         asn1E_Detective (pctxt, &pvalue->detective, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode annotation */

   if (pvalue->m.annotationPresent) {
      if (pvalue->annotation == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->annotation");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
         asn1E_Ns13_Annotation (pctxt, (Ns13_Annotation*)pvalue->annotation, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode cell_range_source */

   if (pvalue->m.cell_range_sourcePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
         asn1E_Cell_range_source (pctxt, &pvalue->cell_range_source, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
         asn1E_Covered_table_cell_style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode protect */

   if (pvalue->m.protectPresent) {
      if(pvalue->protect < 0 || pvalue->protect > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
         asn1E_Covered_table_cell_protect (pctxt, &pvalue->protect, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode number_columns_repeated */

   if (pvalue->m.number_columns_repeatedPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         xe_unsigned (pctxt, &pvalue->number_columns_repeated, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode formula */

   if (pvalue->m.formulaPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         xe_utf8str (pctxt, pvalue->formula, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode content_validation_name */

   if (pvalue->m.content_validation_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         xe_utf8str (pctxt, pvalue->content_validation_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode value_type */

   if (pvalue->m.value_typePresent) {
      if(pvalue->value_type < 0 || pvalue->value_type > 6)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         asn1E_Covered_table_cell_value_type (pctxt, &pvalue->value_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode value */

   if (pvalue->m.valuePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns13_Value (pctxt, (Ns13_Value*)&pvalue->value, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode time_value */

   if (pvalue->m.time_valuePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns13_Time_value (pctxt, (Ns13_Time_value)pvalue->time_value, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode string_value */

   if (pvalue->m.string_valuePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns13_String_value (pctxt, (Ns13_String_value)pvalue->string_value, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode date_value */

   if (pvalue->m.date_valuePresent) {
      if (pvalue->date_value == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->date_value");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Ns13_Date_value (pctxt, (Ns13_Date_value*)pvalue->date_value, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode currency */

   if (pvalue->m.currencyPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns13_Currency (pctxt, (Ns13_Currency)pvalue->currency, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode boolean_value */

   if (pvalue->m.boolean_valuePresent) {
      if(pvalue->boolean_value < 0 || pvalue->boolean_value > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns13_Boolean_value (pctxt, (Ns13_Boolean_value*)&pvalue->boolean_value, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Covered_table_cell (OSCTXT* pctxt, Covered_table_cell* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.boolean_valuePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:boolean-value=\""), 21);

      if(pvalue->boolean_value < 0 || pvalue->boolean_value > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns13_Boolean_value (pctxt, pvalue->boolean_value, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.currencyPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:currency=\""), 16);

      stat = XmlEnc_Ns13_Currency (pctxt, pvalue->currency, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.date_valuePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:date-value=\""), 18);

      stat = XmlEnc_Ns13_Date_value (pctxt, pvalue->date_value, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.string_valuePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:string-value=\""), 20);

      stat = XmlEnc_Ns13_String_value (pctxt, pvalue->string_value, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.time_valuePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:time-value=\""), 18);

      stat = XmlEnc_Ns13_Time_value (pctxt, pvalue->time_value, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.valuePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:value=\""), 13);

      stat = XmlEnc_Ns13_Value (pctxt, pvalue->value, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.value_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:value-type=\""), 18);

      if(pvalue->value_type < 0 || pvalue->value_type > 6)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Covered_table_cell_value_type (pctxt, pvalue->value_type
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.content_validation_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:content-validation-name=\""), 31);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->content_validation_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.formulaPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:formula=\""), 15);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->formula, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.number_columns_repeatedPresent) {
      stat = rtXmlEncUIntAttr
         (pctxt, pvalue->number_columns_repeated
            , OSUTF8("ns15:number-columns-repeated"), 28);
   }

   if (pvalue->m.protectPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:protect=\""), 15);

      if(pvalue->protect < 0 || pvalue->protect > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Covered_table_cell_protect (pctxt, pvalue->protect, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:style-name=\""), 18);

      stat = XmlEnc_Covered_table_cell_style_name (pctxt, &pvalue->style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode cell_range_source */

   if (pvalue->m.cell_range_sourcePresent) {
      stat = XmlEnc_Cell_range_source (pctxt, &pvalue->cell_range_source
         , OSUTF8("cell-range-source"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode annotation */

   if (pvalue->m.annotationPresent) {
      stat = XmlEnc_Ns13_Annotation (pctxt, pvalue->annotation
         , OSUTF8("annotation"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode detective */

   if (pvalue->m.detectivePresent) {
      stat = XmlEnc_Detective (pctxt, &pvalue->detective
         , OSUTF8("detective"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Covered_table_cell_element (pctxt, 
         ((Covered_table_cell_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_row_element                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_row_element (OSCTXT* pctxt,
   Table_row_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Table_cell (pctxt, pvalue->u.table_cell, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Covered_table_cell (pctxt, pvalue->u.covered_table_cell, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Table_row_element (OSCTXT* pctxt, Table_row_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode table_cell */

         stat = XmlEnc_Table_cell (pctxt, pvalue->u.table_cell
            , OSUTF8("table-cell"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode covered_table_cell */

         stat = XmlEnc_Covered_table_cell (pctxt, pvalue->u.covered_table_cell
            , OSUTF8("covered-table-cell"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_row                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_row (OSCTXT* pctxt,
   Table_row *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Table_row_element (pctxt, ((Table_row_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode visibility */

   if (pvalue->m.visibilityPresent) {
      if(pvalue->visibility < 0 || pvalue->visibility > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Table_row_visibility (pctxt, &pvalue->visibility, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Table_row_style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode number_rows_repeated */

   if (pvalue->m.number_rows_repeatedPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_unsigned (pctxt, &pvalue->number_rows_repeated, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode default_cell_style_name */

   if (pvalue->m.default_cell_style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Table_row_default_cell_style_name (pctxt, &pvalue->default_cell_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Table_row (OSCTXT* pctxt, Table_row* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.default_cell_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:default-cell-style-name=\""), 31);

      stat = XmlEnc_Table_row_default_cell_style_name (pctxt, &pvalue->
         default_cell_style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.number_rows_repeatedPresent) {
      stat = rtXmlEncUIntAttr
         (pctxt, pvalue->number_rows_repeated
            , OSUTF8("ns15:number-rows-repeated"), 25);
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:style-name=\""), 18);

      stat = XmlEnc_Table_row_style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.visibilityPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:visibility=\""), 18);

      if(pvalue->visibility < 0 || pvalue->visibility > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_row_visibility (pctxt, pvalue->visibility, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Table_row_element (pctxt, ((Table_row_element*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_rows                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_rows (OSCTXT* pctxt,
   Table_rows *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode table_row_list */

   pnode2 = pvalue->table_row_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Table_row (pctxt, ((Table_row*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Table_rows (OSCTXT* pctxt, Table_rows* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode table_row_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->table_row_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Table_row (pctxt, ((Table_row*)pnode->data)
         , OSUTF8("table-row"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_header_rows                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_header_rows (OSCTXT* pctxt,
   Table_header_rows *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode table_row_list */

   pnode2 = pvalue->table_row_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Table_row (pctxt, ((Table_row*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Table_header_rows (OSCTXT* pctxt, Table_header_rows* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode table_row_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->table_row_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Table_row (pctxt, ((Table_row*)pnode->data)
         , OSUTF8("table-row"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_row_group_element                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_row_group_element (OSCTXT* pctxt,
   Table_row_group_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Table_row_group (pctxt, (Table_row_group*)pvalue->u.table_row_group, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Table_rows (pctxt, pvalue->u.table_rows, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Table_row (pctxt, pvalue->u.table_row, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Table_header_rows (pctxt, pvalue->u.table_header_rows, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Table_row_group_element (OSCTXT* pctxt, 
   Table_row_group_element* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode table_row_group */

         stat = XmlEnc_Table_row_group (pctxt, pvalue->u.table_row_group
            , OSUTF8("table-row-group"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode table_rows */

         stat = XmlEnc_Table_rows (pctxt, pvalue->u.table_rows
            , OSUTF8("table-rows"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode table_row */

         stat = XmlEnc_Table_row (pctxt, pvalue->u.table_row
            , OSUTF8("table-row"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode table_header_rows */

         stat = XmlEnc_Table_header_rows (pctxt, pvalue->u.table_header_rows
            , OSUTF8("table-header-rows"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_row_group                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_row_group (OSCTXT* pctxt,
   Table_row_group *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Table_row_group_element (pctxt, ((Table_row_group_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode display */

   if (pvalue->m.displayPresent) {
      if(pvalue->display < 0 || pvalue->display > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Table_row_group_display (pctxt, &pvalue->display, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Table_row_group (OSCTXT* pctxt, Table_row_group* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.displayPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:display=\""), 15);

      if(pvalue->display < 0 || pvalue->display > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_row_group_display (pctxt, pvalue->display, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Table_row_group_element (pctxt, 
         ((Table_row_group_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table_element_1                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table_element_1 (OSCTXT* pctxt,
   Table_element_1 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Table_row_group (pctxt, pvalue->u.table_row_group, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Table_rows (pctxt, pvalue->u.table_rows, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Table_row (pctxt, pvalue->u.table_row, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Table_header_rows (pctxt, pvalue->u.table_header_rows, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Table_element_1 (OSCTXT* pctxt, Table_element_1* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode table_row_group */

         stat = XmlEnc_Table_row_group (pctxt, pvalue->u.table_row_group
            , OSUTF8("table-row-group"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode table_rows */

         stat = XmlEnc_Table_rows (pctxt, pvalue->u.table_rows
            , OSUTF8("table-rows"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode table_row */

         stat = XmlEnc_Table_row (pctxt, pvalue->u.table_row
            , OSUTF8("table-row"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode table_header_rows */

         stat = XmlEnc_Table_header_rows (pctxt, pvalue->u.table_header_rows
            , OSUTF8("table-header-rows"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Table                                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Table (OSCTXT* pctxt,
   Table *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_1_list */

   pnode2 = pvalue->choice_1_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Table_element_1 (pctxt, ((Table_element_1*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Table_element (pctxt, ((Table_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode shapes */

   if (pvalue->m.shapesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
         asn1E_Shapes (pctxt, &pvalue->shapes, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode forms */

   if (pvalue->m.formsPresent) {
      if (pvalue->forms == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->forms");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Ns13_Forms (pctxt, (Ns13_Forms*)pvalue->forms, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode scenario */

   if (pvalue->m.scenarioPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Scenario (pctxt, &pvalue->scenario, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode dde_source */

   if (pvalue->m.dde_sourcePresent) {
      if (pvalue->dde_source == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->dde_source");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Ns13_Dde_source (pctxt, (Ns13_Dde_source*)pvalue->dde_source, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_source */

   if (pvalue->m.table_sourcePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Table_source (pctxt, &pvalue->table_source, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Table_style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode protection_key */

   if (pvalue->m.protection_keyPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         xe_utf8str (pctxt, pvalue->protection_key, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode protected_ */

   if (pvalue->m.protected_Present) {
      if(pvalue->protected_ < 0 || pvalue->protected_ > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Table_protected_ (pctxt, &pvalue->protected_, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode print_ranges */

   if (pvalue->m.print_rangesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_utf8str (pctxt, pvalue->print_ranges, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode print */

   if (pvalue->m.printPresent) {
      if(pvalue->print < 0 || pvalue->print > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Table_print (pctxt, &pvalue->print, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode is_sub_table */

   if (pvalue->m.is_sub_tablePresent) {
      if(pvalue->is_sub_table < 0 || pvalue->is_sub_table > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Table_is_sub_table (pctxt, &pvalue->is_sub_table, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Table (OSCTXT* pctxt, Table* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.is_sub_tablePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:is-sub-table=\""), 20);

      if(pvalue->is_sub_table < 0 || pvalue->is_sub_table > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_is_sub_table (pctxt, pvalue->is_sub_table, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:name=\""), 12);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.printPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:print=\""), 13);

      if(pvalue->print < 0 || pvalue->print > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_print (pctxt, pvalue->print, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.print_rangesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:print-ranges=\""), 20);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->print_ranges, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.protected_Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:protected=\""), 17);

      if(pvalue->protected_ < 0 || pvalue->protected_ > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_protected_ (pctxt, pvalue->protected_, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.protection_keyPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:protection-key=\""), 22);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->protection_key, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:style-name=\""), 18);

      stat = XmlEnc_Table_style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode table_source */

   if (pvalue->m.table_sourcePresent) {
      stat = XmlEnc_Table_source (pctxt, &pvalue->table_source
         , OSUTF8("table-source"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode dde_source */

   if (pvalue->m.dde_sourcePresent) {
      stat = XmlEnc_Ns13_Dde_source (pctxt, pvalue->dde_source
         , OSUTF8("dde-source"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode scenario */

   if (pvalue->m.scenarioPresent) {
      stat = XmlEnc_Scenario (pctxt, &pvalue->scenario
         , OSUTF8("scenario"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode forms */

   if (pvalue->m.formsPresent) {
      stat = XmlEnc_Ns13_Forms (pctxt, pvalue->forms
         , OSUTF8("forms"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode shapes */

   if (pvalue->m.shapesPresent) {
      stat = XmlEnc_Shapes (pctxt, &pvalue->shapes
         , OSUTF8("shapes"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Table_element (pctxt, ((Table_element*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode choice_1_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_1_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Table_element_1 (pctxt, ((Table_element_1*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Calculation_settings_automatic_find_labels                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Calculation_settings_automatic_find_labels (OSCTXT* pctxt,
   Calculation_settings_automatic_find_labels *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Calculation_settings_automatic_find_labels (OSCTXT* pctxt, 
   Calculation_settings_automatic_find_labels value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Calculation_settings_automatic_find_labels_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Calculation_settings_case_sensitive                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Calculation_settings_case_sensitive (OSCTXT* pctxt,
   Calculation_settings_case_sensitive *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Calculation_settings_case_sensitive (OSCTXT* pctxt, 
   Calculation_settings_case_sensitive value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Calculation_settings_case_sensitive_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Calculation_settings_precision_as_shown                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Calculation_settings_precision_as_shown (OSCTXT* pctxt,
   Calculation_settings_precision_as_shown *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Calculation_settings_precision_as_shown (OSCTXT* pctxt, 
   Calculation_settings_precision_as_shown value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Calculation_settings_precision_as_shown_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Calculation_settings_search_criteria_must_apply_to_whole  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Calculation_settings_search_criteria_must_apply_to_whole_cell (OSCTXT* pctxt,
   Calculation_settings_search_criteria_must_apply_to_whole_cell *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Calculation_settings_search_criteria_must_apply_to_whole_cell 
   (OSCTXT* pctxt, 
   Calculation_settings_search_criteria_must_apply_to_whole_cell value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Calculation_settings_search_criteria_must_apply_to_whole_cell_ToString (
         value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Calculation_settings_use_regular_expressions              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Calculation_settings_use_regular_expressions (OSCTXT* pctxt,
   Calculation_settings_use_regular_expressions *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Calculation_settings_use_regular_expressions (OSCTXT* pctxt, 
   Calculation_settings_use_regular_expressions value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Calculation_settings_use_regular_expressions_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Null_date_value_type                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Null_date_value_type (OSCTXT* pctxt,
   Null_date_value_type *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 6)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Null_date_value_type (OSCTXT* pctxt, Null_date_value_type value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Null_date_value_type_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Null_date                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Null_date (OSCTXT* pctxt,
   Null_date *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode value_type */

   if (pvalue->m.value_typePresent) {
      if(pvalue->value_type < 0 || pvalue->value_type > 6)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Null_date_value_type (pctxt, &pvalue->value_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode date_value_type */

   if (pvalue->m.date_value_typePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_charstr (pctxt, pvalue->date_value_type, ASN1IMPL, TM_UNIV|TM_PRIM|26));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Null_date (OSCTXT* pctxt, Null_date* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.date_value_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:date-value-type=\""), 23);

      stat = rtXmlEncUTF8Str (pctxt, (const OSUTF8CHAR*)pvalue->date_value_type
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.value_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:value-type=\""), 18);

      if(pvalue->value_type < 0 || pvalue->value_type > 6)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Null_date_value_type (pctxt, pvalue->value_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Iteration_status                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Iteration_status (OSCTXT* pctxt,
   Iteration_status *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Iteration_status (OSCTXT* pctxt, Iteration_status value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Iteration_status_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Iteration                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Iteration (OSCTXT* pctxt,
   Iteration *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode steps */

   if (pvalue->m.stepsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_unsigned (pctxt, &pvalue->steps, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode status */

   if (pvalue->m.statusPresent) {
      if(pvalue->status < 0 || pvalue->status > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Iteration_status (pctxt, &pvalue->status, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode maximum_difference */

   if (pvalue->m.maximum_differencePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_real (pctxt, &pvalue->maximum_difference, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Iteration (OSCTXT* pctxt, Iteration* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.maximum_differencePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:maximum-difference=\""), 26);

      stat = rtXmlEncDouble (pctxt, pvalue->maximum_difference, 0, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.statusPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:status=\""), 14);

      if(pvalue->status < 0 || pvalue->status > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Iteration_status (pctxt, pvalue->status, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.stepsPresent) {
      stat = rtXmlEncUIntAttr
         (pctxt, pvalue->steps, OSUTF8("ns15:steps"), 10);
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Calculation_settings                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Calculation_settings (OSCTXT* pctxt,
   Calculation_settings *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode iteration */

   if (pvalue->m.iterationPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Iteration (pctxt, &pvalue->iteration, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode null_date */

   if (pvalue->m.null_datePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Null_date (pctxt, &pvalue->null_date, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode use_regular_expressions */

   if (pvalue->m.use_regular_expressionsPresent) {
      if(pvalue->use_regular_expressions < 0 || pvalue->use_regular_expressions > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Calculation_settings_use_regular_expressions (pctxt, &pvalue->use_regular_expressions, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode search_criteria_must_apply_to_whole_cell */

   if (pvalue->m.search_criteria_must_apply_to_whole_cellPresent) {
      if(pvalue->search_criteria_must_apply_to_whole_cell < 0 || pvalue->search_criteria_must_apply_to_whole_cell > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Calculation_settings_search_criteria_must_apply_to_whole_cell (pctxt, &pvalue->search_criteria_must_apply_to_whole_cell, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode precision_as_shown */

   if (pvalue->m.precision_as_shownPresent) {
      if(pvalue->precision_as_shown < 0 || pvalue->precision_as_shown > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Calculation_settings_precision_as_shown (pctxt, &pvalue->precision_as_shown, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode null_year */

   if (pvalue->m.null_yearPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_unsigned (pctxt, &pvalue->null_year, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode case_sensitive */

   if (pvalue->m.case_sensitivePresent) {
      if(pvalue->case_sensitive < 0 || pvalue->case_sensitive > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Calculation_settings_case_sensitive (pctxt, &pvalue->case_sensitive, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode automatic_find_labels */

   if (pvalue->m.automatic_find_labelsPresent) {
      if(pvalue->automatic_find_labels < 0 || pvalue->automatic_find_labels > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Calculation_settings_automatic_find_labels (pctxt, &pvalue->automatic_find_labels, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Calculation_settings (OSCTXT* pctxt, Calculation_settings* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.automatic_find_labelsPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:automatic-find-labels=\""), 29);

      if(pvalue->automatic_find_labels < 0 || pvalue->automatic_find_labels
          > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Calculation_settings_automatic_find_labels (pctxt, pvalue->
         automatic_find_labels, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.case_sensitivePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:case-sensitive=\""), 22);

      if(pvalue->case_sensitive < 0 || pvalue->case_sensitive > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Calculation_settings_case_sensitive (pctxt, pvalue->
         case_sensitive, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.null_yearPresent) {
      stat = rtXmlEncUIntAttr
         (pctxt, pvalue->null_year, OSUTF8("ns15:null-year"), 14);
   }

   if (pvalue->m.precision_as_shownPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:precision-as-shown=\""), 26);

      if(pvalue->precision_as_shown < 0 || pvalue->precision_as_shown > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Calculation_settings_precision_as_shown (pctxt, pvalue->
         precision_as_shown, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.search_criteria_must_apply_to_whole_cellPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:search-criteria-must-apply-to-whole-cell=\""), 48);

      if(pvalue->search_criteria_must_apply_to_whole_cell < 0 || pvalue->
         search_criteria_must_apply_to_whole_cell > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Calculation_settings_search_criteria_must_apply_to_whole_cell (pctxt
         , pvalue->search_criteria_must_apply_to_whole_cell, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.use_regular_expressionsPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:use-regular-expressions=\""), 31);

      if(pvalue->use_regular_expressions < 0 || pvalue->use_regular_expressions
          > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Calculation_settings_use_regular_expressions (pctxt, pvalue
         ->use_regular_expressions, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode null_date */

   if (pvalue->m.null_datePresent) {
      stat = XmlEnc_Null_date (pctxt, &pvalue->null_date
         , OSUTF8("null-date"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode iteration */

   if (pvalue->m.iterationPresent) {
      stat = XmlEnc_Iteration (pctxt, &pvalue->iteration
         , OSUTF8("iteration"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Content_validation_allow_empty_cell                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Content_validation_allow_empty_cell (OSCTXT* pctxt,
   Content_validation_allow_empty_cell *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Content_validation_allow_empty_cell (OSCTXT* pctxt, 
   Content_validation_allow_empty_cell value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Content_validation_allow_empty_cell_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Content_validation_display_list                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Content_validation_display_list (OSCTXT* pctxt,
   Content_validation_display_list *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Content_validation_display_list (OSCTXT* pctxt, 
   Content_validation_display_list value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Content_validation_display_list_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Help_message_display                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Help_message_display (OSCTXT* pctxt,
   Help_message_display *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Help_message_display (OSCTXT* pctxt, Help_message_display value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Help_message_display_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Help_message                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Help_message (OSCTXT* pctxt,
   Help_message *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode p_list */

   pnode2 = pvalue->p_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Odf_P (pctxt, (Odf_P*)((Odf_P*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode title */

   if (pvalue->m.titlePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->title, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode display */

   if (pvalue->m.displayPresent) {
      if(pvalue->display < 0 || pvalue->display > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Help_message_display (pctxt, &pvalue->display, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Help_message (OSCTXT* pctxt, Help_message* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.displayPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:display=\""), 15);

      if(pvalue->display < 0 || pvalue->display > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Help_message_display (pctxt, pvalue->display, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.titlePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:title=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->title, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode p_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->p_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Odf_P (pctxt, ((Odf_P*)pnode->data)
         , OSUTF8("p"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Error_message_display                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Error_message_display (OSCTXT* pctxt,
   Error_message_display *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Error_message_display (OSCTXT* pctxt, Error_message_display value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Error_message_display_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Error_message_message_type                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Error_message_message_type (OSCTXT* pctxt,
   Error_message_message_type *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Error_message_message_type (OSCTXT* pctxt, 
   Error_message_message_type value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Error_message_message_type_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Error_message                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Error_message (OSCTXT* pctxt,
   Error_message *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode p_list */

   pnode2 = pvalue->p_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Odf_P (pctxt, (Odf_P*)((Odf_P*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode title */

   if (pvalue->m.titlePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_utf8str (pctxt, pvalue->title, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode message_type */

   if (pvalue->m.message_typePresent) {
      if(pvalue->message_type < 0 || pvalue->message_type > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Error_message_message_type (pctxt, &pvalue->message_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode display */

   if (pvalue->m.displayPresent) {
      if(pvalue->display < 0 || pvalue->display > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Error_message_display (pctxt, &pvalue->display, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Error_message (OSCTXT* pctxt, Error_message* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.displayPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:display=\""), 15);

      if(pvalue->display < 0 || pvalue->display > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Error_message_display (pctxt, pvalue->display, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.message_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:message-type=\""), 20);

      if(pvalue->message_type < 0 || pvalue->message_type > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Error_message_message_type (pctxt, pvalue->message_type
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.titlePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:title=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->title, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode p_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->p_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Odf_P (pctxt, ((Odf_P*)pnode->data)
         , OSUTF8("p"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Error_macro_execute                                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Error_macro_execute (OSCTXT* pctxt,
   Error_macro_execute *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Error_macro_execute (OSCTXT* pctxt, Error_macro_execute value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Error_macro_execute_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Error_macro                                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Error_macro (OSCTXT* pctxt,
   Error_macro *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode execute */

   if (pvalue->m.executePresent) {
      if(pvalue->execute < 0 || pvalue->execute > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Error_macro_execute (pctxt, &pvalue->execute, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Error_macro (OSCTXT* pctxt, Error_macro* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.executePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:execute=\""), 15);

      if(pvalue->execute < 0 || pvalue->execute > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Error_macro_execute (pctxt, pvalue->execute, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Content_validation_sequence                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Content_validation_sequence (OSCTXT* pctxt,
   Content_validation_sequence *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode error_macro */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
      asn1E_Error_macro (pctxt, &pvalue->error_macro, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Content_validation_sequence (OSCTXT* pctxt, 
   Content_validation_sequence* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode error_macro */

   stat = XmlEnc_Error_macro (pctxt, &pvalue->error_macro
      , OSUTF8("error-macro"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Content_validation_choice                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Content_validation_choice (OSCTXT* pctxt,
   Content_validation_choice *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Error_message (pctxt, pvalue->u.error_message, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Content_validation_sequence (pctxt, pvalue->u.sequence, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Content_validation_choice (OSCTXT* pctxt, 
   Content_validation_choice* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode error_message */

         stat = XmlEnc_Error_message (pctxt, pvalue->u.error_message
            , OSUTF8("error-message"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode sequence */

         stat = XmlEnc_Content_validation_sequence (pctxt, pvalue->u.sequence
            , OSUTF8(""), 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Content_validation                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Content_validation (OSCTXT* pctxt,
   Content_validation *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode choice */

   if (pvalue->m.choicePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Content_validation_choice (pctxt, &pvalue->choice, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode help_message */

   if (pvalue->m.help_messagePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Help_message (pctxt, &pvalue->help_message, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
      xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode display_list */

   if (pvalue->m.display_listPresent) {
      if(pvalue->display_list < 0 || pvalue->display_list > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Content_validation_display_list (pctxt, &pvalue->display_list, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode condition */

   if (pvalue->m.conditionPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_utf8str (pctxt, pvalue->condition, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode base_cell_address */

   if (pvalue->m.base_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->base_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode allow_empty_cell */

   if (pvalue->m.allow_empty_cellPresent) {
      if(pvalue->allow_empty_cell < 0 || pvalue->allow_empty_cell > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Content_validation_allow_empty_cell (pctxt, &pvalue->allow_empty_cell, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Content_validation (OSCTXT* pctxt, Content_validation* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.allow_empty_cellPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:allow-empty-cell=\""), 24);

      if(pvalue->allow_empty_cell < 0 || pvalue->allow_empty_cell > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Content_validation_allow_empty_cell (pctxt, pvalue->
         allow_empty_cell, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.base_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:base-cell-address=\""), 25);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->base_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.conditionPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:condition=\""), 17);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->condition, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.display_listPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:display-list=\""), 20);

      if(pvalue->display_list < 0 || pvalue->display_list > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Content_validation_display_list (pctxt, pvalue->
         display_list, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:name=\""), 12);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode help_message */

   if (pvalue->m.help_messagePresent) {
      stat = XmlEnc_Help_message (pctxt, &pvalue->help_message
         , OSUTF8("help-message"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode choice */

   if (pvalue->m.choicePresent) {
      stat = XmlEnc_Content_validation_choice (pctxt, &pvalue->choice
         , OSUTF8(""), 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Content_validations                                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Content_validations (OSCTXT* pctxt,
   Content_validations *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode content_validation_list */

   pnode2 = pvalue->content_validation_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Content_validation (pctxt, ((Content_validation*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Content_validations (OSCTXT* pctxt, Content_validations* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode content_validation_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->content_validation_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Content_validation (pctxt, 
         ((Content_validation*)pnode->data)
         , OSUTF8("content-validation"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Label_range_orientation                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Label_range_orientation (OSCTXT* pctxt,
   Label_range_orientation *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Label_range_orientation (OSCTXT* pctxt, 
   Label_range_orientation value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Label_range_orientation_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Label_range                                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Label_range (OSCTXT* pctxt,
   Label_range *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode orientation */

   if(pvalue->orientation < 0 || pvalue->orientation > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
      asn1E_Label_range_orientation (pctxt, &pvalue->orientation, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode label_cell_range_address */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_utf8str (pctxt, pvalue->label_cell_range_address, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode data_cell_range_address */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_utf8str (pctxt, pvalue->data_cell_range_address, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Label_range (OSCTXT* pctxt, Label_range* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:data-cell-range-address=\""), 31);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->data_cell_range_address, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:label-cell-range-address=\""), 32);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->label_cell_range_address, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:orientation=\""), 19);

   if(pvalue->orientation < 0 || pvalue->orientation > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Label_range_orientation (pctxt, pvalue->orientation, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Label_ranges                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Label_ranges (OSCTXT* pctxt,
   Label_ranges *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode label_range_list */

   pnode2 = pvalue->label_range_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Label_range (pctxt, ((Label_range*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Label_ranges (OSCTXT* pctxt, Label_ranges* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode label_range_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->label_range_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Label_range (pctxt, ((Label_range*)pnode->data)
         , OSUTF8("label-range"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Named_range_range_usable_as_alt                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Named_range_range_usable_as_alt (OSCTXT* pctxt,
   Named_range_range_usable_as_alt *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Named_range_range_usable_as_alt (OSCTXT* pctxt, 
   Named_range_range_usable_as_alt value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Named_range_range_usable_as_alt_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Named_range_range_usable_as_alt_1_element                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Named_range_range_usable_as_alt_1_element (OSCTXT* pctxt,
   Named_range_range_usable_as_alt_1_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 3)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Named_range_range_usable_as_alt_1_element (OSCTXT* pctxt, 
   Named_range_range_usable_as_alt_1_element value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Named_range_range_usable_as_alt_1_element_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Named_range_range_usable_as_alt_1                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Named_range_range_usable_as_alt_1 (OSCTXT* pctxt,
   Named_range_range_usable_as_alt_1 *pvalue, ASN1TagType tagging)
{
   OSRTDListNode* pnode;
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   pnode = pvalue->tail;
   while (0 != pnode) {
      if(*((Named_range_range_usable_as_alt_1_element*)pnode->data) < 0 || *((Named_range_range_usable_as_alt_1_element*)pnode->data) > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = asn1E_Named_range_range_usable_as_alt_1_element (pctxt, ((Named_range_range_usable_as_alt_1_element*)pnode->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;

      pnode = pnode->prev;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Named_range_range_usable_as_alt_1 (OSCTXT* pctxt, 
   Named_range_range_usable_as_alt_1* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (elemName != 0) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->head;
   while (0 != pnode) {
      if(*((Named_range_range_usable_as_alt_1_element*)pnode->data) < 0 || *
         ((Named_range_range_usable_as_alt_1_element*)pnode->data) > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Named_range_range_usable_as_alt_1_element (pctxt, *
         ((Named_range_range_usable_as_alt_1_element*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      OSRTSAFEPUTCHAR (pctxt, ' ');
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Named_range_range_usable_as                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Named_range_range_usable_as (OSCTXT* pctxt,
   Named_range_range_usable_as *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         if(pvalue->u.alt < 0 || pvalue->u.alt > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            asn1E_Named_range_range_usable_as_alt (pctxt, &pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Named_range_range_usable_as_alt_1 (pctxt, pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Named_range_range_usable_as (OSCTXT* pctxt, 
   Named_range_range_usable_as* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         if(pvalue->u.alt < 0 || pvalue->u.alt > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Named_range_range_usable_as_alt (pctxt, pvalue->u.alt
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         stat = XmlEnc_Named_range_range_usable_as_alt_1 (pctxt, pvalue->
            u.alt_1, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Named_range                                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Named_range (OSCTXT* pctxt,
   Named_range *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode range_usable_as */

   if (pvalue->m.range_usable_asPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
         asn1E_Named_range_range_usable_as (pctxt, &pvalue->range_usable_as, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
      xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode cell_range_address */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      asn1E_Cell_range_address (pctxt, pvalue->cell_range_address, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode base_cell_address */

   if (pvalue->m.base_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->base_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Named_range (OSCTXT* pctxt, Named_range* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.base_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:base-cell-address=\""), 25);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->base_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:cell-range-address=\""), 26);

   stat = XmlEnc_Cell_range_address (pctxt, pvalue->cell_range_address, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:name=\""), 12);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.range_usable_asPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:range-usable-as=\""), 23);

      stat = XmlEnc_Named_range_range_usable_as (pctxt, &pvalue->
         range_usable_as, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Named_expression                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Named_expression (OSCTXT* pctxt,
   Named_expression *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
      xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode expression */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_utf8str (pctxt, pvalue->expression, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode base_cell_address */

   if (pvalue->m.base_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->base_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Named_expression (OSCTXT* pctxt, Named_expression* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.base_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:base-cell-address=\""), 25);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->base_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:expression=\""), 18);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->expression, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:name=\""), 12);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Named_expressions_element                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Named_expressions_element (OSCTXT* pctxt,
   Named_expressions_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Named_range (pctxt, pvalue->u.named_range, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Named_expression (pctxt, pvalue->u.named_expression, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Named_expressions_element (OSCTXT* pctxt, 
   Named_expressions_element* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode named_range */

         stat = XmlEnc_Named_range (pctxt, pvalue->u.named_range
            , OSUTF8("named-range"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode named_expression */

         stat = XmlEnc_Named_expression (pctxt, pvalue->u.named_expression
            , OSUTF8("named-expression"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Named_expressions                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Named_expressions (OSCTXT* pctxt,
   Named_expressions *pvalue, ASN1TagType tagging)
{
   OSRTDListNode* pnode1;
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   pnode1 = pvalue->tail;
   while (0 != pnode1) {
      ll = asn1E_Named_expressions_element (pctxt, ((Named_expressions_element*)pnode1->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;

      pnode1 = pnode1->prev;
   }
   ll1 = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll1);
   if (ll1 < 0) return LOG_RTERR (pctxt, ll1);

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Named_expressions (OSCTXT* pctxt, Named_expressions* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (elemName != 0) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->head;
   while (0 != pnode) {
      stat = XmlEnc_Named_expressions_element (pctxt, 
         ((Named_expressions_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Database_range_contains_header                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Database_range_contains_header (OSCTXT* pctxt,
   Database_range_contains_header *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Database_range_contains_header (OSCTXT* pctxt, 
   Database_range_contains_header value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Database_range_contains_header_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Database_range_display_filter_buttons                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Database_range_display_filter_buttons (OSCTXT* pctxt,
   Database_range_display_filter_buttons *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Database_range_display_filter_buttons (OSCTXT* pctxt, 
   Database_range_display_filter_buttons value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Database_range_display_filter_buttons_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Database_range_has_persistent_data                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Database_range_has_persistent_data (OSCTXT* pctxt,
   Database_range_has_persistent_data *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Database_range_has_persistent_data (OSCTXT* pctxt, 
   Database_range_has_persistent_data value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Database_range_has_persistent_data_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Database_range_is_selection                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Database_range_is_selection (OSCTXT* pctxt,
   Database_range_is_selection *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Database_range_is_selection (OSCTXT* pctxt, 
   Database_range_is_selection value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Database_range_is_selection_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Database_range_on_update_keep_size                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Database_range_on_update_keep_size (OSCTXT* pctxt,
   Database_range_on_update_keep_size *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Database_range_on_update_keep_size (OSCTXT* pctxt, 
   Database_range_on_update_keep_size value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Database_range_on_update_keep_size_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Database_range_on_update_keep_styles                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Database_range_on_update_keep_styles (OSCTXT* pctxt,
   Database_range_on_update_keep_styles *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Database_range_on_update_keep_styles (OSCTXT* pctxt, 
   Database_range_on_update_keep_styles value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Database_range_on_update_keep_styles_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Database_range_orientation                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Database_range_orientation (OSCTXT* pctxt,
   Database_range_orientation *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Database_range_orientation (OSCTXT* pctxt, 
   Database_range_orientation value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Database_range_orientation_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Database_range_refresh_delay                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Database_range_refresh_delay (OSCTXT* pctxt,
   Database_range_refresh_delay *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Database_range_refresh_delay (OSCTXT* pctxt, 
   Database_range_refresh_delay value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Database_range_refresh_delay_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Database_source_sql_parse_sql_statement                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Database_source_sql_parse_sql_statement (OSCTXT* pctxt,
   Database_source_sql_parse_sql_statement *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Database_source_sql_parse_sql_statement (OSCTXT* pctxt, 
   Database_source_sql_parse_sql_statement value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Database_source_sql_parse_sql_statement_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Database_source_sql                                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Database_source_sql (OSCTXT* pctxt,
   Database_source_sql *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode sql_statement */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
      xe_utf8str (pctxt, pvalue->sql_statement, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode parse_sql_statement */

   if (pvalue->m.parse_sql_statementPresent) {
      if(pvalue->parse_sql_statement < 0 || pvalue->parse_sql_statement > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Database_source_sql_parse_sql_statement (pctxt, &pvalue->parse_sql_statement, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode database_name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_utf8str (pctxt, pvalue->database_name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Database_source_sql (OSCTXT* pctxt, Database_source_sql* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:database-name=\""), 21);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->database_name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.parse_sql_statementPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:parse-sql-statement=\""), 27);

      if(pvalue->parse_sql_statement < 0 || pvalue->parse_sql_statement > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Database_source_sql_parse_sql_statement (pctxt, pvalue->
         parse_sql_statement, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:sql-statement=\""), 21);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->sql_statement, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Database_source_query                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Database_source_query (OSCTXT* pctxt,
   Database_source_query *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode query_name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_utf8str (pctxt, pvalue->query_name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode database_name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_utf8str (pctxt, pvalue->database_name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Database_source_query (OSCTXT* pctxt, 
   Database_source_query* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:database-name=\""), 21);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->database_name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:query-name=\""), 18);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->query_name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Database_source_table                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Database_source_table (OSCTXT* pctxt,
   Database_source_table *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode database_table_name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_utf8str (pctxt, pvalue->database_table_name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode database_name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_utf8str (pctxt, pvalue->database_name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Database_source_table (OSCTXT* pctxt, 
   Database_source_table* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:database-name=\""), 21);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->database_name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:database-table-name=\""), 27);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->database_table_name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Database_range_choice                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Database_range_choice (OSCTXT* pctxt,
   Database_range_choice *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Database_source_sql (pctxt, pvalue->u.database_source_sql, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Database_source_query (pctxt, pvalue->u.database_source_query, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Database_source_table (pctxt, pvalue->u.database_source_table, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Database_range_choice (OSCTXT* pctxt, 
   Database_range_choice* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode database_source_sql */

         stat = XmlEnc_Database_source_sql (pctxt, pvalue->
            u.database_source_sql, OSUTF8("database-source-sql"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode database_source_query */

         stat = XmlEnc_Database_source_query (pctxt, pvalue->
            u.database_source_query
            , OSUTF8("database-source-query"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode database_source_table */

         stat = XmlEnc_Database_source_table (pctxt, pvalue->
            u.database_source_table
            , OSUTF8("database-source-table"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Filter_condition_source                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Filter_condition_source (OSCTXT* pctxt,
   Filter_condition_source *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Filter_condition_source (OSCTXT* pctxt, 
   Filter_condition_source value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Filter_condition_source_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Filter_display_duplicates                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Filter_display_duplicates (OSCTXT* pctxt,
   Filter_display_duplicates *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Filter_display_duplicates (OSCTXT* pctxt, 
   Filter_display_duplicates value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Filter_display_duplicates_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Filter_condition_data_type                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Filter_condition_data_type (OSCTXT* pctxt,
   Filter_condition_data_type *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Filter_condition_data_type (OSCTXT* pctxt, 
   Filter_condition_data_type value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Filter_condition_data_type_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Filter_condition                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Filter_condition (OSCTXT* pctxt,
   Filter_condition *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode value */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
      xe_utf8str (pctxt, pvalue->value, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode operator_ */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
      xe_utf8str (pctxt, pvalue->operator_, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode field_number */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
      xe_unsigned (pctxt, &pvalue->field_number, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode data_type */

   if (pvalue->m.data_typePresent) {
      if(pvalue->data_type < 0 || pvalue->data_type > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Filter_condition_data_type (pctxt, &pvalue->data_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode case_sensitive */

   if (pvalue->m.case_sensitivePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->case_sensitive, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Filter_condition (OSCTXT* pctxt, Filter_condition* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.case_sensitivePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:case-sensitive=\""), 22);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->case_sensitive, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.data_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:data-type=\""), 17);

      if(pvalue->data_type < 0 || pvalue->data_type > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Filter_condition_data_type (pctxt, pvalue->data_type
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   stat = rtXmlEncUIntAttr
      (pctxt, pvalue->field_number, OSUTF8("ns15:field-number"), 17);

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:operator=\""), 16);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->operator_, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:value=\""), 13);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->value, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Filter_or_element                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Filter_or_element (OSCTXT* pctxt,
   Filter_or_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Filter_and (pctxt, (Filter_and*)pvalue->u.filter_and, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Filter_condition (pctxt, pvalue->u.filter_condition, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Filter_or_element (OSCTXT* pctxt, Filter_or_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode filter_and */

         stat = XmlEnc_Filter_and (pctxt, pvalue->u.filter_and
            , OSUTF8("filter-and"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode filter_condition */

         stat = XmlEnc_Filter_condition (pctxt, pvalue->u.filter_condition
            , OSUTF8("filter-condition"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Filter_or                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Filter_or (OSCTXT* pctxt,
   Filter_or *pvalue, ASN1TagType tagging)
{
   OSRTDListNode* pnode1;
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   pnode1 = pvalue->tail;
   while (0 != pnode1) {
      ll = asn1E_Filter_or_element (pctxt, ((Filter_or_element*)pnode1->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;

      pnode1 = pnode1->prev;
   }
   ll1 = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll1);
   if (ll1 < 0) return LOG_RTERR (pctxt, ll1);

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Filter_or (OSCTXT* pctxt, Filter_or* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (elemName != 0) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->head;
   while (0 != pnode) {
      stat = XmlEnc_Filter_or_element (pctxt, ((Filter_or_element*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Filter_and_element                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Filter_and_element (OSCTXT* pctxt,
   Filter_and_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Filter_or (pctxt, pvalue->u.filter_or, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Filter_condition (pctxt, pvalue->u.filter_condition, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Filter_and_element (OSCTXT* pctxt, Filter_and_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode filter_or */

         stat = XmlEnc_Filter_or (pctxt, pvalue->u.filter_or
            , OSUTF8("filter-or"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode filter_condition */

         stat = XmlEnc_Filter_condition (pctxt, pvalue->u.filter_condition
            , OSUTF8("filter-condition"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Filter_and                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Filter_and (OSCTXT* pctxt,
   Filter_and *pvalue, ASN1TagType tagging)
{
   OSRTDListNode* pnode;
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   pnode = pvalue->tail;
   while (0 != pnode) {
      ll = asn1E_Filter_and_element (pctxt, ((Filter_and_element*)pnode->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;

      pnode = pnode->prev;
   }
   ll1 = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll1);
   if (ll1 < 0) return LOG_RTERR (pctxt, ll1);

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Filter_and (OSCTXT* pctxt, Filter_and* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (elemName != 0) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->head;
   while (0 != pnode) {
      stat = XmlEnc_Filter_and_element (pctxt, 
         ((Filter_and_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Filter_choice                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Filter_choice (OSCTXT* pctxt,
   Filter_choice *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Filter_condition (pctxt, pvalue->u.filter_condition, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Filter_and (pctxt, pvalue->u.filter_and, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Filter_or (pctxt, pvalue->u.filter_or, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Filter_choice (OSCTXT* pctxt, Filter_choice* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode filter_condition */

         stat = XmlEnc_Filter_condition (pctxt, pvalue->u.filter_condition
            , OSUTF8("filter-condition"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode filter_and */

         stat = XmlEnc_Filter_and (pctxt, pvalue->u.filter_and
            , OSUTF8("filter-and"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode filter_or */

         stat = XmlEnc_Filter_or (pctxt, pvalue->u.filter_or
            , OSUTF8("filter-or"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Filter                                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Filter (OSCTXT* pctxt,
   Filter *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode choice */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
      asn1E_Filter_choice (pctxt, &pvalue->choice, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode target_range_address */

   if (pvalue->m.target_range_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_utf8str (pctxt, pvalue->target_range_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode display_duplicates */

   if (pvalue->m.display_duplicatesPresent) {
      if(pvalue->display_duplicates < 0 || pvalue->display_duplicates > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Filter_display_duplicates (pctxt, &pvalue->display_duplicates, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode condition_source_range_address */

   if (pvalue->m.condition_source_range_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->condition_source_range_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode condition_source */

   if (pvalue->m.condition_sourcePresent) {
      if(pvalue->condition_source < 0 || pvalue->condition_source > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Filter_condition_source (pctxt, &pvalue->condition_source, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Filter (OSCTXT* pctxt, Filter* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.condition_sourcePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:condition-source=\""), 24);

      if(pvalue->condition_source < 0 || pvalue->condition_source > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Filter_condition_source (pctxt, pvalue->condition_source
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.condition_source_range_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:condition-source-range-address=\""), 38);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->condition_source_range_address
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.display_duplicatesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:display-duplicates=\""), 26);

      if(pvalue->display_duplicates < 0 || pvalue->display_duplicates > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Filter_display_duplicates (pctxt, pvalue->
         display_duplicates, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.target_range_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:target-range-address=\""), 28);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->target_range_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode choice */

   stat = XmlEnc_Filter_choice (pctxt, &pvalue->choice, 0, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Sort_bind_styles_to_content                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Sort_bind_styles_to_content (OSCTXT* pctxt,
   Sort_bind_styles_to_content *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Sort_bind_styles_to_content (OSCTXT* pctxt, 
   Sort_bind_styles_to_content value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Sort_bind_styles_to_content_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Sort_case_sensitive                                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Sort_case_sensitive (OSCTXT* pctxt,
   Sort_case_sensitive *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Sort_case_sensitive (OSCTXT* pctxt, Sort_case_sensitive value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Sort_case_sensitive_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Sort_by_data_type_alt_1                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Sort_by_data_type_alt_1 (OSCTXT* pctxt,
   Sort_by_data_type_alt_1 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Sort_by_data_type_alt_1 (OSCTXT* pctxt, 
   Sort_by_data_type_alt_1 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Sort_by_data_type_alt_1_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Sort_by_data_type_alt_2                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Sort_by_data_type_alt_2 (OSCTXT* pctxt,
   Sort_by_data_type_alt_2 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Sort_by_data_type_alt_2 (OSCTXT* pctxt, 
   Sort_by_data_type_alt_2 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Sort_by_data_type_alt_2_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Sort_by_data_type_alt_3                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Sort_by_data_type_alt_3 (OSCTXT* pctxt,
   Sort_by_data_type_alt_3 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Sort_by_data_type_alt_3 (OSCTXT* pctxt, 
   Sort_by_data_type_alt_3 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Sort_by_data_type_alt_3_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Sort_by_data_type                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Sort_by_data_type (OSCTXT* pctxt,
   Sort_by_data_type *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            asn1E_Sort_by_data_type_alt_1 (pctxt, &pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
            asn1E_Sort_by_data_type_alt_2 (pctxt, &pvalue->u.alt_2, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         if(pvalue->u.alt_3 < 0 || pvalue->u.alt_3 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
            asn1E_Sort_by_data_type_alt_3 (pctxt, &pvalue->u.alt_3, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Sort_by_data_type (OSCTXT* pctxt, Sort_by_data_type* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Sort_by_data_type_alt_1 (pctxt, pvalue->u.alt_1
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode alt_2 */

         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Sort_by_data_type_alt_2 (pctxt, pvalue->u.alt_2
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode alt_3 */

         if(pvalue->u.alt_3 < 0 || pvalue->u.alt_3 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Sort_by_data_type_alt_3 (pctxt, pvalue->u.alt_3
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Sort_by_order                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Sort_by_order (OSCTXT* pctxt,
   Sort_by_order *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Sort_by_order (OSCTXT* pctxt, Sort_by_order value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Sort_by_order_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Sort_by                                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Sort_by (OSCTXT* pctxt,
   Sort_by *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode order */

   if (pvalue->m.orderPresent) {
      if(pvalue->order < 0 || pvalue->order > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Sort_by_order (pctxt, &pvalue->order, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode field_number */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_unsigned (pctxt, &pvalue->field_number, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode data_type */

   if (pvalue->m.data_typePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Sort_by_data_type (pctxt, &pvalue->data_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Sort_by (OSCTXT* pctxt, Sort_by* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.data_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:data-type=\""), 17);

      stat = XmlEnc_Sort_by_data_type (pctxt, &pvalue->data_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   stat = rtXmlEncUIntAttr
      (pctxt, pvalue->field_number, OSUTF8("ns15:field-number"), 17);

   if (pvalue->m.orderPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:order=\""), 13);

      if(pvalue->order < 0 || pvalue->order > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Sort_by_order (pctxt, pvalue->order, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Sort                                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Sort (OSCTXT* pctxt,
   Sort *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode sort_by_list */

   pnode2 = pvalue->sort_by_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Sort_by (pctxt, ((Sort_by*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode target_range_address */

   if (pvalue->m.target_range_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         xe_utf8str (pctxt, pvalue->target_range_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode language */

   if (pvalue->m.languagePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->language, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode country */

   if (pvalue->m.countryPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_utf8str (pctxt, pvalue->country, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode case_sensitive */

   if (pvalue->m.case_sensitivePresent) {
      if(pvalue->case_sensitive < 0 || pvalue->case_sensitive > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Sort_case_sensitive (pctxt, &pvalue->case_sensitive, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode bind_styles_to_content */

   if (pvalue->m.bind_styles_to_contentPresent) {
      if(pvalue->bind_styles_to_content < 0 || pvalue->bind_styles_to_content > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Sort_bind_styles_to_content (pctxt, &pvalue->bind_styles_to_content, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode algorithm */

   if (pvalue->m.algorithmPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->algorithm, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Sort (OSCTXT* pctxt, Sort* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.algorithmPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:algorithm=\""), 17);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->algorithm, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.bind_styles_to_contentPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:bind-styles-to-content=\""), 30);

      if(pvalue->bind_styles_to_content < 0 || pvalue->bind_styles_to_content
          > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Sort_bind_styles_to_content (pctxt, pvalue->
         bind_styles_to_content, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.case_sensitivePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:case-sensitive=\""), 22);

      if(pvalue->case_sensitive < 0 || pvalue->case_sensitive > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Sort_case_sensitive (pctxt, pvalue->case_sensitive, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.countryPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:country=\""), 15);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->country, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.languagePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:language=\""), 16);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->language, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.target_range_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:target-range-address=\""), 28);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->target_range_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode sort_by_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->sort_by_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Sort_by (pctxt, ((Sort_by*)pnode->data)
         , OSUTF8("sort-by"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_rules_bind_styles_to_content                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_rules_bind_styles_to_content (OSCTXT* pctxt,
   Subtotal_rules_bind_styles_to_content *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Subtotal_rules_bind_styles_to_content (OSCTXT* pctxt, 
   Subtotal_rules_bind_styles_to_content value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Subtotal_rules_bind_styles_to_content_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_rules_case_sensitive                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_rules_case_sensitive (OSCTXT* pctxt,
   Subtotal_rules_case_sensitive *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Subtotal_rules_case_sensitive (OSCTXT* pctxt, 
   Subtotal_rules_case_sensitive value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Subtotal_rules_case_sensitive_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_rules_page_breaks_on_group_change                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_rules_page_breaks_on_group_change (OSCTXT* pctxt,
   Subtotal_rules_page_breaks_on_group_change *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Subtotal_rules_page_breaks_on_group_change (OSCTXT* pctxt, 
   Subtotal_rules_page_breaks_on_group_change value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Subtotal_rules_page_breaks_on_group_change_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Sort_groups_data_type_alt_1                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Sort_groups_data_type_alt_1 (OSCTXT* pctxt,
   Sort_groups_data_type_alt_1 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Sort_groups_data_type_alt_1 (OSCTXT* pctxt, 
   Sort_groups_data_type_alt_1 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Sort_groups_data_type_alt_1_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Sort_groups_data_type_alt_2                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Sort_groups_data_type_alt_2 (OSCTXT* pctxt,
   Sort_groups_data_type_alt_2 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Sort_groups_data_type_alt_2 (OSCTXT* pctxt, 
   Sort_groups_data_type_alt_2 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Sort_groups_data_type_alt_2_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Sort_groups_data_type_alt_3                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Sort_groups_data_type_alt_3 (OSCTXT* pctxt,
   Sort_groups_data_type_alt_3 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Sort_groups_data_type_alt_3 (OSCTXT* pctxt, 
   Sort_groups_data_type_alt_3 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Sort_groups_data_type_alt_3_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Sort_groups_data_type                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Sort_groups_data_type (OSCTXT* pctxt,
   Sort_groups_data_type *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            asn1E_Sort_groups_data_type_alt_1 (pctxt, &pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
            asn1E_Sort_groups_data_type_alt_2 (pctxt, &pvalue->u.alt_2, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         if(pvalue->u.alt_3 < 0 || pvalue->u.alt_3 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
            asn1E_Sort_groups_data_type_alt_3 (pctxt, &pvalue->u.alt_3, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Sort_groups_data_type (OSCTXT* pctxt, 
   Sort_groups_data_type* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Sort_groups_data_type_alt_1 (pctxt, pvalue->u.alt_1
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode alt_2 */

         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Sort_groups_data_type_alt_2 (pctxt, pvalue->u.alt_2
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode alt_3 */

         if(pvalue->u.alt_3 < 0 || pvalue->u.alt_3 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Sort_groups_data_type_alt_3 (pctxt, pvalue->u.alt_3
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Sort_groups_order                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Sort_groups_order (OSCTXT* pctxt,
   Sort_groups_order *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Sort_groups_order (OSCTXT* pctxt, Sort_groups_order value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Sort_groups_order_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Sort_groups                                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Sort_groups (OSCTXT* pctxt,
   Sort_groups *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode order */

   if (pvalue->m.orderPresent) {
      if(pvalue->order < 0 || pvalue->order > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Sort_groups_order (pctxt, &pvalue->order, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode data_type */

   if (pvalue->m.data_typePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Sort_groups_data_type (pctxt, &pvalue->data_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Sort_groups (OSCTXT* pctxt, Sort_groups* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.data_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:data-type=\""), 17);

      stat = XmlEnc_Sort_groups_data_type (pctxt, &pvalue->data_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.orderPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:order=\""), 13);

      if(pvalue->order < 0 || pvalue->order > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Sort_groups_order (pctxt, pvalue->order, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_field_function_alt_1                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_field_function_alt_1 (OSCTXT* pctxt,
   Subtotal_field_function_alt_1 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Subtotal_field_function_alt_1 (OSCTXT* pctxt, 
   Subtotal_field_function_alt_1 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Subtotal_field_function_alt_1_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_field_function_alt_2                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_field_function_alt_2 (OSCTXT* pctxt,
   Subtotal_field_function_alt_2 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Subtotal_field_function_alt_2 (OSCTXT* pctxt, 
   Subtotal_field_function_alt_2 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Subtotal_field_function_alt_2_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_field_function_alt_3                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_field_function_alt_3 (OSCTXT* pctxt,
   Subtotal_field_function_alt_3 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Subtotal_field_function_alt_3 (OSCTXT* pctxt, 
   Subtotal_field_function_alt_3 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Subtotal_field_function_alt_3_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_field_function_alt_4                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_field_function_alt_4 (OSCTXT* pctxt,
   Subtotal_field_function_alt_4 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Subtotal_field_function_alt_4 (OSCTXT* pctxt, 
   Subtotal_field_function_alt_4 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Subtotal_field_function_alt_4_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_field_function_alt_5                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_field_function_alt_5 (OSCTXT* pctxt,
   Subtotal_field_function_alt_5 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Subtotal_field_function_alt_5 (OSCTXT* pctxt, 
   Subtotal_field_function_alt_5 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Subtotal_field_function_alt_5_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_field_function_alt_6                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_field_function_alt_6 (OSCTXT* pctxt,
   Subtotal_field_function_alt_6 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Subtotal_field_function_alt_6 (OSCTXT* pctxt, 
   Subtotal_field_function_alt_6 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Subtotal_field_function_alt_6_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_field_function_alt_7                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_field_function_alt_7 (OSCTXT* pctxt,
   Subtotal_field_function_alt_7 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Subtotal_field_function_alt_7 (OSCTXT* pctxt, 
   Subtotal_field_function_alt_7 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Subtotal_field_function_alt_7_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_field_function_alt_8                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_field_function_alt_8 (OSCTXT* pctxt,
   Subtotal_field_function_alt_8 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Subtotal_field_function_alt_8 (OSCTXT* pctxt, 
   Subtotal_field_function_alt_8 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Subtotal_field_function_alt_8_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_field_function_alt_9                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_field_function_alt_9 (OSCTXT* pctxt,
   Subtotal_field_function_alt_9 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Subtotal_field_function_alt_9 (OSCTXT* pctxt, 
   Subtotal_field_function_alt_9 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Subtotal_field_function_alt_9_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_field_function_alt_10                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_field_function_alt_10 (OSCTXT* pctxt,
   Subtotal_field_function_alt_10 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Subtotal_field_function_alt_10 (OSCTXT* pctxt, 
   Subtotal_field_function_alt_10 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Subtotal_field_function_alt_10_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_field_function_alt_11                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_field_function_alt_11 (OSCTXT* pctxt,
   Subtotal_field_function_alt_11 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Subtotal_field_function_alt_11 (OSCTXT* pctxt, 
   Subtotal_field_function_alt_11 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Subtotal_field_function_alt_11_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_field_function_alt_12                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_field_function_alt_12 (OSCTXT* pctxt,
   Subtotal_field_function_alt_12 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Subtotal_field_function_alt_12 (OSCTXT* pctxt, 
   Subtotal_field_function_alt_12 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Subtotal_field_function_alt_12_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_field_function                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_field_function (OSCTXT* pctxt,
   Subtotal_field_function *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            asn1E_Subtotal_field_function_alt_1 (pctxt, &pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
            asn1E_Subtotal_field_function_alt_2 (pctxt, &pvalue->u.alt_2, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         if(pvalue->u.alt_3 < 0 || pvalue->u.alt_3 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
            asn1E_Subtotal_field_function_alt_3 (pctxt, &pvalue->u.alt_3, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         if(pvalue->u.alt_4 < 0 || pvalue->u.alt_4 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
            asn1E_Subtotal_field_function_alt_4 (pctxt, &pvalue->u.alt_4, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 6:
         if(pvalue->u.alt_5 < 0 || pvalue->u.alt_5 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
            asn1E_Subtotal_field_function_alt_5 (pctxt, &pvalue->u.alt_5, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 7:
         if(pvalue->u.alt_6 < 0 || pvalue->u.alt_6 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
            asn1E_Subtotal_field_function_alt_6 (pctxt, &pvalue->u.alt_6, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 8:
         if(pvalue->u.alt_7 < 0 || pvalue->u.alt_7 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
            asn1E_Subtotal_field_function_alt_7 (pctxt, &pvalue->u.alt_7, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 9:
         if(pvalue->u.alt_8 < 0 || pvalue->u.alt_8 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
            asn1E_Subtotal_field_function_alt_8 (pctxt, &pvalue->u.alt_8, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 10:
         if(pvalue->u.alt_9 < 0 || pvalue->u.alt_9 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
            asn1E_Subtotal_field_function_alt_9 (pctxt, &pvalue->u.alt_9, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 11:
         if(pvalue->u.alt_10 < 0 || pvalue->u.alt_10 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
            asn1E_Subtotal_field_function_alt_10 (pctxt, &pvalue->u.alt_10, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 12:
         if(pvalue->u.alt_11 < 0 || pvalue->u.alt_11 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
            asn1E_Subtotal_field_function_alt_11 (pctxt, &pvalue->u.alt_11, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 13:
         if(pvalue->u.alt_12 < 0 || pvalue->u.alt_12 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|12,
            asn1E_Subtotal_field_function_alt_12 (pctxt, &pvalue->u.alt_12, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Subtotal_field_function (OSCTXT* pctxt, 
   Subtotal_field_function* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Subtotal_field_function_alt_1 (pctxt, pvalue->u.alt_1
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode alt_2 */

         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Subtotal_field_function_alt_2 (pctxt, pvalue->u.alt_2
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode alt_3 */

         if(pvalue->u.alt_3 < 0 || pvalue->u.alt_3 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Subtotal_field_function_alt_3 (pctxt, pvalue->u.alt_3
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode alt_4 */

         if(pvalue->u.alt_4 < 0 || pvalue->u.alt_4 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Subtotal_field_function_alt_4 (pctxt, pvalue->u.alt_4
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 6:
         /* encode alt_5 */

         if(pvalue->u.alt_5 < 0 || pvalue->u.alt_5 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Subtotal_field_function_alt_5 (pctxt, pvalue->u.alt_5
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 7:
         /* encode alt_6 */

         if(pvalue->u.alt_6 < 0 || pvalue->u.alt_6 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Subtotal_field_function_alt_6 (pctxt, pvalue->u.alt_6
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 8:
         /* encode alt_7 */

         if(pvalue->u.alt_7 < 0 || pvalue->u.alt_7 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Subtotal_field_function_alt_7 (pctxt, pvalue->u.alt_7
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 9:
         /* encode alt_8 */

         if(pvalue->u.alt_8 < 0 || pvalue->u.alt_8 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Subtotal_field_function_alt_8 (pctxt, pvalue->u.alt_8
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 10:
         /* encode alt_9 */

         if(pvalue->u.alt_9 < 0 || pvalue->u.alt_9 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Subtotal_field_function_alt_9 (pctxt, pvalue->u.alt_9
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 11:
         /* encode alt_10 */

         if(pvalue->u.alt_10 < 0 || pvalue->u.alt_10 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Subtotal_field_function_alt_10 (pctxt, pvalue->u.alt_10
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 12:
         /* encode alt_11 */

         if(pvalue->u.alt_11 < 0 || pvalue->u.alt_11 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Subtotal_field_function_alt_11 (pctxt, pvalue->u.alt_11
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 13:
         /* encode alt_12 */

         if(pvalue->u.alt_12 < 0 || pvalue->u.alt_12 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Subtotal_field_function_alt_12 (pctxt, pvalue->u.alt_12
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_field                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_field (OSCTXT* pctxt,
   Subtotal_field *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode function */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
      asn1E_Subtotal_field_function (pctxt, &pvalue->function, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode field_number */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_unsigned (pctxt, &pvalue->field_number, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Subtotal_field (OSCTXT* pctxt, Subtotal_field* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   stat = rtXmlEncUIntAttr
      (pctxt, pvalue->field_number, OSUTF8("ns15:field-number"), 17);

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:function=\""), 16);

   stat = XmlEnc_Subtotal_field_function (pctxt, &pvalue->function, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_rule                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_rule (OSCTXT* pctxt,
   Subtotal_rule *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode subtotal_field_list */

   pnode2 = pvalue->subtotal_field_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Subtotal_field (pctxt, ((Subtotal_field*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode group_by_field_number */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_unsigned (pctxt, &pvalue->group_by_field_number, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Subtotal_rule (OSCTXT* pctxt, Subtotal_rule* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   stat = rtXmlEncUIntAttr
      (pctxt, pvalue->group_by_field_number
         , OSUTF8("ns15:group-by-field-number"), 26);

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode subtotal_field_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->subtotal_field_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Subtotal_field (pctxt, ((Subtotal_field*)pnode->data)
         , OSUTF8("subtotal-field"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Subtotal_rules                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Subtotal_rules (OSCTXT* pctxt,
   Subtotal_rules *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode subtotal_rule_list */

   pnode2 = pvalue->subtotal_rule_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Subtotal_rule (pctxt, ((Subtotal_rule*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode sort_groups */

   if (pvalue->m.sort_groupsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
         asn1E_Sort_groups (pctxt, &pvalue->sort_groups, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode page_breaks_on_group_change */

   if (pvalue->m.page_breaks_on_group_changePresent) {
      if(pvalue->page_breaks_on_group_change < 0 || pvalue->page_breaks_on_group_change > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Subtotal_rules_page_breaks_on_group_change (pctxt, &pvalue->page_breaks_on_group_change, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode case_sensitive */

   if (pvalue->m.case_sensitivePresent) {
      if(pvalue->case_sensitive < 0 || pvalue->case_sensitive > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Subtotal_rules_case_sensitive (pctxt, &pvalue->case_sensitive, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode bind_styles_to_content */

   if (pvalue->m.bind_styles_to_contentPresent) {
      if(pvalue->bind_styles_to_content < 0 || pvalue->bind_styles_to_content > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Subtotal_rules_bind_styles_to_content (pctxt, &pvalue->bind_styles_to_content, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Subtotal_rules (OSCTXT* pctxt, Subtotal_rules* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.bind_styles_to_contentPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:bind-styles-to-content=\""), 30);

      if(pvalue->bind_styles_to_content < 0 || pvalue->bind_styles_to_content
          > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Subtotal_rules_bind_styles_to_content (pctxt, pvalue->
         bind_styles_to_content, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.case_sensitivePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:case-sensitive=\""), 22);

      if(pvalue->case_sensitive < 0 || pvalue->case_sensitive > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Subtotal_rules_case_sensitive (pctxt, pvalue->
         case_sensitive, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.page_breaks_on_group_changePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:page-breaks-on-group-change=\""), 35);

      if(pvalue->page_breaks_on_group_change < 0 || pvalue->
         page_breaks_on_group_change > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Subtotal_rules_page_breaks_on_group_change (pctxt, pvalue->
         page_breaks_on_group_change, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode sort_groups */

   if (pvalue->m.sort_groupsPresent) {
      stat = XmlEnc_Sort_groups (pctxt, &pvalue->sort_groups
         , OSUTF8("sort-groups"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode subtotal_rule_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->subtotal_rule_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Subtotal_rule (pctxt, ((Subtotal_rule*)pnode->data)
         , OSUTF8("subtotal-rule"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Database_range                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Database_range (OSCTXT* pctxt,
   Database_range *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode subtotal_rules */

   if (pvalue->m.subtotal_rulesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
         asn1E_Subtotal_rules (pctxt, &pvalue->subtotal_rules, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode sort */

   if (pvalue->m.sortPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
         asn1E_Sort (pctxt, &pvalue->sort, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode filter */

   if (pvalue->m.filterPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
         asn1E_Filter (pctxt, &pvalue->filter, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode choice */

   if (pvalue->m.choicePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Database_range_choice (pctxt, &pvalue->choice, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode target_range_address */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
      xe_utf8str (pctxt, pvalue->target_range_address, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode refresh_delay */

   if (pvalue->m.refresh_delayPresent) {
      if(pvalue->refresh_delay < 0 || pvalue->refresh_delay > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         asn1E_Database_range_refresh_delay (pctxt, &pvalue->refresh_delay, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode orientation */

   if (pvalue->m.orientationPresent) {
      if(pvalue->orientation < 0 || pvalue->orientation > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Database_range_orientation (pctxt, &pvalue->orientation, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode on_update_keep_styles */

   if (pvalue->m.on_update_keep_stylesPresent) {
      if(pvalue->on_update_keep_styles < 0 || pvalue->on_update_keep_styles > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         asn1E_Database_range_on_update_keep_styles (pctxt, &pvalue->on_update_keep_styles, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode on_update_keep_size */

   if (pvalue->m.on_update_keep_sizePresent) {
      if(pvalue->on_update_keep_size < 0 || pvalue->on_update_keep_size > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Database_range_on_update_keep_size (pctxt, &pvalue->on_update_keep_size, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode is_selection */

   if (pvalue->m.is_selectionPresent) {
      if(pvalue->is_selection < 0 || pvalue->is_selection > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Database_range_is_selection (pctxt, &pvalue->is_selection, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode has_persistent_data */

   if (pvalue->m.has_persistent_dataPresent) {
      if(pvalue->has_persistent_data < 0 || pvalue->has_persistent_data > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Database_range_has_persistent_data (pctxt, &pvalue->has_persistent_data, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode display_filter_buttons */

   if (pvalue->m.display_filter_buttonsPresent) {
      if(pvalue->display_filter_buttons < 0 || pvalue->display_filter_buttons > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Database_range_display_filter_buttons (pctxt, &pvalue->display_filter_buttons, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode contains_header */

   if (pvalue->m.contains_headerPresent) {
      if(pvalue->contains_header < 0 || pvalue->contains_header > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Database_range_contains_header (pctxt, &pvalue->contains_header, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Database_range (OSCTXT* pctxt, Database_range* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.contains_headerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:contains-header=\""), 23);

      if(pvalue->contains_header < 0 || pvalue->contains_header > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Database_range_contains_header (pctxt, pvalue->
         contains_header, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.display_filter_buttonsPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:display-filter-buttons=\""), 30);

      if(pvalue->display_filter_buttons < 0 || pvalue->display_filter_buttons
          > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Database_range_display_filter_buttons (pctxt, pvalue->
         display_filter_buttons, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.has_persistent_dataPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:has-persistent-data=\""), 27);

      if(pvalue->has_persistent_data < 0 || pvalue->has_persistent_data > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Database_range_has_persistent_data (pctxt, pvalue->
         has_persistent_data, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.is_selectionPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:is-selection=\""), 20);

      if(pvalue->is_selection < 0 || pvalue->is_selection > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Database_range_is_selection (pctxt, pvalue->is_selection
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:name=\""), 12);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.on_update_keep_sizePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:on-update-keep-size=\""), 27);

      if(pvalue->on_update_keep_size < 0 || pvalue->on_update_keep_size > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Database_range_on_update_keep_size (pctxt, pvalue->
         on_update_keep_size, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.on_update_keep_stylesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:on-update-keep-styles=\""), 29);

      if(pvalue->on_update_keep_styles < 0 || pvalue->on_update_keep_styles
          > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Database_range_on_update_keep_styles (pctxt, pvalue->
         on_update_keep_styles, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.orientationPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:orientation=\""), 19);

      if(pvalue->orientation < 0 || pvalue->orientation > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Database_range_orientation (pctxt, pvalue->orientation
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.refresh_delayPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:refresh-delay=\""), 21);

      if(pvalue->refresh_delay < 0 || pvalue->refresh_delay > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Database_range_refresh_delay (pctxt, pvalue->refresh_delay
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:target-range-address=\""), 28);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->target_range_address, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode choice */

   if (pvalue->m.choicePresent) {
      stat = XmlEnc_Database_range_choice (pctxt, &pvalue->choice
         , OSUTF8(""), 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode filter */

   if (pvalue->m.filterPresent) {
      stat = XmlEnc_Filter (pctxt, &pvalue->filter
         , OSUTF8("filter"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode sort */

   if (pvalue->m.sortPresent) {
      stat = XmlEnc_Sort (pctxt, &pvalue->sort, OSUTF8("sort"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode subtotal_rules */

   if (pvalue->m.subtotal_rulesPresent) {
      stat = XmlEnc_Subtotal_rules (pctxt, &pvalue->subtotal_rules
         , OSUTF8("subtotal-rules"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Database_ranges                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Database_ranges (OSCTXT* pctxt,
   Database_ranges *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode database_range_list */

   pnode2 = pvalue->database_range_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Database_range (pctxt, ((Database_range*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Database_ranges (OSCTXT* pctxt, Database_ranges* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode database_range_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->database_range_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Database_range (pctxt, ((Database_range*)pnode->data)
         , OSUTF8("database-range"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_table_drill_down_on_double_click               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_table_drill_down_on_double_click (OSCTXT* pctxt,
   Data_pilot_table_drill_down_on_double_click *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_table_drill_down_on_double_click (OSCTXT* pctxt, 
   Data_pilot_table_drill_down_on_double_click value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_table_drill_down_on_double_click_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_table_grand_total                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_table_grand_total (OSCTXT* pctxt,
   Data_pilot_table_grand_total *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 3)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_table_grand_total (OSCTXT* pctxt, 
   Data_pilot_table_grand_total value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_table_grand_total_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_table_identify_categories                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_table_identify_categories (OSCTXT* pctxt,
   Data_pilot_table_identify_categories *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_table_identify_categories (OSCTXT* pctxt, 
   Data_pilot_table_identify_categories value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_table_identify_categories_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_table_ignore_empty_rows                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_table_ignore_empty_rows (OSCTXT* pctxt,
   Data_pilot_table_ignore_empty_rows *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_table_ignore_empty_rows (OSCTXT* pctxt, 
   Data_pilot_table_ignore_empty_rows value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_table_ignore_empty_rows_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_table_show_filter_button                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_table_show_filter_button (OSCTXT* pctxt,
   Data_pilot_table_show_filter_button *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_table_show_filter_button (OSCTXT* pctxt, 
   Data_pilot_table_show_filter_button value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_table_show_filter_button_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Source_service                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Source_service (OSCTXT* pctxt,
   Source_service *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode user_name */

   if (pvalue->m.user_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->user_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode source_name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
      xe_utf8str (pctxt, pvalue->source_name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode password */

   if (pvalue->m.passwordPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_utf8str (pctxt, pvalue->password, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode object_name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_utf8str (pctxt, pvalue->object_name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Source_service (OSCTXT* pctxt, Source_service* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:name=\""), 12);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:object-name=\""), 19);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->object_name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.passwordPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:password=\""), 16);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->password, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:source-name=\""), 19);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->source_name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.user_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:user-name=\""), 17);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->user_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Source_cell_range                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Source_cell_range (OSCTXT* pctxt,
   Source_cell_range *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode filter */

   if (pvalue->m.filterPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
         asn1E_Filter (pctxt, &pvalue->filter, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode cell_range_address */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      asn1E_Cell_range_address (pctxt, pvalue->cell_range_address, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Source_cell_range (OSCTXT* pctxt, Source_cell_range* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:cell-range-address=\""), 26);

   stat = XmlEnc_Cell_range_address (pctxt, pvalue->cell_range_address, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode filter */

   if (pvalue->m.filterPresent) {
      stat = XmlEnc_Filter (pctxt, &pvalue->filter
         , OSUTF8("filter"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_table_choice                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_table_choice (OSCTXT* pctxt,
   Data_pilot_table_choice *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Database_source_sql (pctxt, pvalue->u.database_source_sql, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Database_source_query (pctxt, pvalue->u.database_source_query, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Database_source_table (pctxt, pvalue->u.database_source_table, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Source_service (pctxt, pvalue->u.source_service, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
            asn1E_Source_cell_range (pctxt, pvalue->u.source_cell_range, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Data_pilot_table_choice (OSCTXT* pctxt, 
   Data_pilot_table_choice* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode database_source_sql */

         stat = XmlEnc_Database_source_sql (pctxt, pvalue->
            u.database_source_sql, OSUTF8("database-source-sql"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode database_source_query */

         stat = XmlEnc_Database_source_query (pctxt, pvalue->
            u.database_source_query
            , OSUTF8("database-source-query"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode database_source_table */

         stat = XmlEnc_Database_source_table (pctxt, pvalue->
            u.database_source_table
            , OSUTF8("database-source-table"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode source_service */

         stat = XmlEnc_Source_service (pctxt, pvalue->u.source_service
            , OSUTF8("source-service"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode source_cell_range */

         stat = XmlEnc_Source_cell_range (pctxt, pvalue->u.source_cell_range
            , OSUTF8("source-cell-range"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_function_alt_1                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_function_alt_1 (OSCTXT* pctxt,
   Data_pilot_field_function_alt_1 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_field_function_alt_1 (OSCTXT* pctxt, 
   Data_pilot_field_function_alt_1 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_field_function_alt_1_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_function_alt_2                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_function_alt_2 (OSCTXT* pctxt,
   Data_pilot_field_function_alt_2 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_field_function_alt_2 (OSCTXT* pctxt, 
   Data_pilot_field_function_alt_2 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_field_function_alt_2_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_function_alt_3                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_function_alt_3 (OSCTXT* pctxt,
   Data_pilot_field_function_alt_3 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_field_function_alt_3 (OSCTXT* pctxt, 
   Data_pilot_field_function_alt_3 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_field_function_alt_3_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_function_alt_4                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_function_alt_4 (OSCTXT* pctxt,
   Data_pilot_field_function_alt_4 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_field_function_alt_4 (OSCTXT* pctxt, 
   Data_pilot_field_function_alt_4 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_field_function_alt_4_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_function_alt_5                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_function_alt_5 (OSCTXT* pctxt,
   Data_pilot_field_function_alt_5 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_field_function_alt_5 (OSCTXT* pctxt, 
   Data_pilot_field_function_alt_5 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_field_function_alt_5_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_function_alt_6                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_function_alt_6 (OSCTXT* pctxt,
   Data_pilot_field_function_alt_6 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_field_function_alt_6 (OSCTXT* pctxt, 
   Data_pilot_field_function_alt_6 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_field_function_alt_6_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_function_alt_7                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_function_alt_7 (OSCTXT* pctxt,
   Data_pilot_field_function_alt_7 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_field_function_alt_7 (OSCTXT* pctxt, 
   Data_pilot_field_function_alt_7 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_field_function_alt_7_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_function_alt_8                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_function_alt_8 (OSCTXT* pctxt,
   Data_pilot_field_function_alt_8 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_field_function_alt_8 (OSCTXT* pctxt, 
   Data_pilot_field_function_alt_8 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_field_function_alt_8_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_function_alt_9                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_function_alt_9 (OSCTXT* pctxt,
   Data_pilot_field_function_alt_9 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_field_function_alt_9 (OSCTXT* pctxt, 
   Data_pilot_field_function_alt_9 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_field_function_alt_9_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_function_alt_10                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_function_alt_10 (OSCTXT* pctxt,
   Data_pilot_field_function_alt_10 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_field_function_alt_10 (OSCTXT* pctxt, 
   Data_pilot_field_function_alt_10 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_field_function_alt_10_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_function_alt_11                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_function_alt_11 (OSCTXT* pctxt,
   Data_pilot_field_function_alt_11 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_field_function_alt_11 (OSCTXT* pctxt, 
   Data_pilot_field_function_alt_11 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_field_function_alt_11_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_function_alt_12                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_function_alt_12 (OSCTXT* pctxt,
   Data_pilot_field_function_alt_12 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_field_function_alt_12 (OSCTXT* pctxt, 
   Data_pilot_field_function_alt_12 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_field_function_alt_12_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_function                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_function (OSCTXT* pctxt,
   Data_pilot_field_function *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            asn1E_Data_pilot_field_function_alt_1 (pctxt, &pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
            asn1E_Data_pilot_field_function_alt_2 (pctxt, &pvalue->u.alt_2, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         if(pvalue->u.alt_3 < 0 || pvalue->u.alt_3 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
            asn1E_Data_pilot_field_function_alt_3 (pctxt, &pvalue->u.alt_3, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         if(pvalue->u.alt_4 < 0 || pvalue->u.alt_4 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
            asn1E_Data_pilot_field_function_alt_4 (pctxt, &pvalue->u.alt_4, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 6:
         if(pvalue->u.alt_5 < 0 || pvalue->u.alt_5 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
            asn1E_Data_pilot_field_function_alt_5 (pctxt, &pvalue->u.alt_5, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 7:
         if(pvalue->u.alt_6 < 0 || pvalue->u.alt_6 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
            asn1E_Data_pilot_field_function_alt_6 (pctxt, &pvalue->u.alt_6, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 8:
         if(pvalue->u.alt_7 < 0 || pvalue->u.alt_7 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
            asn1E_Data_pilot_field_function_alt_7 (pctxt, &pvalue->u.alt_7, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 9:
         if(pvalue->u.alt_8 < 0 || pvalue->u.alt_8 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
            asn1E_Data_pilot_field_function_alt_8 (pctxt, &pvalue->u.alt_8, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 10:
         if(pvalue->u.alt_9 < 0 || pvalue->u.alt_9 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
            asn1E_Data_pilot_field_function_alt_9 (pctxt, &pvalue->u.alt_9, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 11:
         if(pvalue->u.alt_10 < 0 || pvalue->u.alt_10 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
            asn1E_Data_pilot_field_function_alt_10 (pctxt, &pvalue->u.alt_10, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 12:
         if(pvalue->u.alt_11 < 0 || pvalue->u.alt_11 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
            asn1E_Data_pilot_field_function_alt_11 (pctxt, &pvalue->u.alt_11, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 13:
         if(pvalue->u.alt_12 < 0 || pvalue->u.alt_12 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|12,
            asn1E_Data_pilot_field_function_alt_12 (pctxt, &pvalue->u.alt_12, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Data_pilot_field_function (OSCTXT* pctxt, 
   Data_pilot_field_function* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_field_function_alt_1 (pctxt, pvalue->u.alt_1
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode alt_2 */

         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_field_function_alt_2 (pctxt, pvalue->u.alt_2
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode alt_3 */

         if(pvalue->u.alt_3 < 0 || pvalue->u.alt_3 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_field_function_alt_3 (pctxt, pvalue->u.alt_3
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode alt_4 */

         if(pvalue->u.alt_4 < 0 || pvalue->u.alt_4 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_field_function_alt_4 (pctxt, pvalue->u.alt_4
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 6:
         /* encode alt_5 */

         if(pvalue->u.alt_5 < 0 || pvalue->u.alt_5 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_field_function_alt_5 (pctxt, pvalue->u.alt_5
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 7:
         /* encode alt_6 */

         if(pvalue->u.alt_6 < 0 || pvalue->u.alt_6 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_field_function_alt_6 (pctxt, pvalue->u.alt_6
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 8:
         /* encode alt_7 */

         if(pvalue->u.alt_7 < 0 || pvalue->u.alt_7 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_field_function_alt_7 (pctxt, pvalue->u.alt_7
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 9:
         /* encode alt_8 */

         if(pvalue->u.alt_8 < 0 || pvalue->u.alt_8 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_field_function_alt_8 (pctxt, pvalue->u.alt_8
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 10:
         /* encode alt_9 */

         if(pvalue->u.alt_9 < 0 || pvalue->u.alt_9 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_field_function_alt_9 (pctxt, pvalue->u.alt_9
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 11:
         /* encode alt_10 */

         if(pvalue->u.alt_10 < 0 || pvalue->u.alt_10 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_field_function_alt_10 (pctxt, pvalue->
            u.alt_10, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 12:
         /* encode alt_11 */

         if(pvalue->u.alt_11 < 0 || pvalue->u.alt_11 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_field_function_alt_11 (pctxt, pvalue->
            u.alt_11, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 13:
         /* encode alt_12 */

         if(pvalue->u.alt_12 < 0 || pvalue->u.alt_12 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_field_function_alt_12 (pctxt, pvalue->
            u.alt_12, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_orientation                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_orientation (OSCTXT* pctxt,
   Data_pilot_field_orientation *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 4)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_field_orientation (OSCTXT* pctxt, 
   Data_pilot_field_orientation value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_field_orientation_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_level_show_empty                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_level_show_empty (OSCTXT* pctxt,
   Data_pilot_level_show_empty *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_level_show_empty (OSCTXT* pctxt, 
   Data_pilot_level_show_empty value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_level_show_empty_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_subtotal_function_alt_1                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_subtotal_function_alt_1 (OSCTXT* pctxt,
   Data_pilot_subtotal_function_alt_1 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_subtotal_function_alt_1 (OSCTXT* pctxt, 
   Data_pilot_subtotal_function_alt_1 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_subtotal_function_alt_1_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_subtotal_function_alt_2                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_subtotal_function_alt_2 (OSCTXT* pctxt,
   Data_pilot_subtotal_function_alt_2 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_subtotal_function_alt_2 (OSCTXT* pctxt, 
   Data_pilot_subtotal_function_alt_2 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_subtotal_function_alt_2_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_subtotal_function_alt_3                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_subtotal_function_alt_3 (OSCTXT* pctxt,
   Data_pilot_subtotal_function_alt_3 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_subtotal_function_alt_3 (OSCTXT* pctxt, 
   Data_pilot_subtotal_function_alt_3 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_subtotal_function_alt_3_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_subtotal_function_alt_4                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_subtotal_function_alt_4 (OSCTXT* pctxt,
   Data_pilot_subtotal_function_alt_4 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_subtotal_function_alt_4 (OSCTXT* pctxt, 
   Data_pilot_subtotal_function_alt_4 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_subtotal_function_alt_4_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_subtotal_function_alt_5                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_subtotal_function_alt_5 (OSCTXT* pctxt,
   Data_pilot_subtotal_function_alt_5 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_subtotal_function_alt_5 (OSCTXT* pctxt, 
   Data_pilot_subtotal_function_alt_5 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_subtotal_function_alt_5_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_subtotal_function_alt_6                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_subtotal_function_alt_6 (OSCTXT* pctxt,
   Data_pilot_subtotal_function_alt_6 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_subtotal_function_alt_6 (OSCTXT* pctxt, 
   Data_pilot_subtotal_function_alt_6 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_subtotal_function_alt_6_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_subtotal_function_alt_7                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_subtotal_function_alt_7 (OSCTXT* pctxt,
   Data_pilot_subtotal_function_alt_7 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_subtotal_function_alt_7 (OSCTXT* pctxt, 
   Data_pilot_subtotal_function_alt_7 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_subtotal_function_alt_7_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_subtotal_function_alt_8                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_subtotal_function_alt_8 (OSCTXT* pctxt,
   Data_pilot_subtotal_function_alt_8 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_subtotal_function_alt_8 (OSCTXT* pctxt, 
   Data_pilot_subtotal_function_alt_8 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_subtotal_function_alt_8_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_subtotal_function_alt_9                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_subtotal_function_alt_9 (OSCTXT* pctxt,
   Data_pilot_subtotal_function_alt_9 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_subtotal_function_alt_9 (OSCTXT* pctxt, 
   Data_pilot_subtotal_function_alt_9 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_subtotal_function_alt_9_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_subtotal_function_alt_10                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_subtotal_function_alt_10 (OSCTXT* pctxt,
   Data_pilot_subtotal_function_alt_10 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_subtotal_function_alt_10 (OSCTXT* pctxt, 
   Data_pilot_subtotal_function_alt_10 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_subtotal_function_alt_10_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_subtotal_function_alt_11                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_subtotal_function_alt_11 (OSCTXT* pctxt,
   Data_pilot_subtotal_function_alt_11 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_subtotal_function_alt_11 (OSCTXT* pctxt, 
   Data_pilot_subtotal_function_alt_11 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_subtotal_function_alt_11_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_subtotal_function_alt_12                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_subtotal_function_alt_12 (OSCTXT* pctxt,
   Data_pilot_subtotal_function_alt_12 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_subtotal_function_alt_12 (OSCTXT* pctxt, 
   Data_pilot_subtotal_function_alt_12 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_subtotal_function_alt_12_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_subtotal_function                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_subtotal_function (OSCTXT* pctxt,
   Data_pilot_subtotal_function *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            asn1E_Data_pilot_subtotal_function_alt_1 (pctxt, &pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
            asn1E_Data_pilot_subtotal_function_alt_2 (pctxt, &pvalue->u.alt_2, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         if(pvalue->u.alt_3 < 0 || pvalue->u.alt_3 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
            asn1E_Data_pilot_subtotal_function_alt_3 (pctxt, &pvalue->u.alt_3, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         if(pvalue->u.alt_4 < 0 || pvalue->u.alt_4 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
            asn1E_Data_pilot_subtotal_function_alt_4 (pctxt, &pvalue->u.alt_4, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 6:
         if(pvalue->u.alt_5 < 0 || pvalue->u.alt_5 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
            asn1E_Data_pilot_subtotal_function_alt_5 (pctxt, &pvalue->u.alt_5, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 7:
         if(pvalue->u.alt_6 < 0 || pvalue->u.alt_6 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
            asn1E_Data_pilot_subtotal_function_alt_6 (pctxt, &pvalue->u.alt_6, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 8:
         if(pvalue->u.alt_7 < 0 || pvalue->u.alt_7 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
            asn1E_Data_pilot_subtotal_function_alt_7 (pctxt, &pvalue->u.alt_7, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 9:
         if(pvalue->u.alt_8 < 0 || pvalue->u.alt_8 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
            asn1E_Data_pilot_subtotal_function_alt_8 (pctxt, &pvalue->u.alt_8, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 10:
         if(pvalue->u.alt_9 < 0 || pvalue->u.alt_9 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
            asn1E_Data_pilot_subtotal_function_alt_9 (pctxt, &pvalue->u.alt_9, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 11:
         if(pvalue->u.alt_10 < 0 || pvalue->u.alt_10 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
            asn1E_Data_pilot_subtotal_function_alt_10 (pctxt, &pvalue->u.alt_10, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 12:
         if(pvalue->u.alt_11 < 0 || pvalue->u.alt_11 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
            asn1E_Data_pilot_subtotal_function_alt_11 (pctxt, &pvalue->u.alt_11, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 13:
         if(pvalue->u.alt_12 < 0 || pvalue->u.alt_12 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|12,
            asn1E_Data_pilot_subtotal_function_alt_12 (pctxt, &pvalue->u.alt_12, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Data_pilot_subtotal_function (OSCTXT* pctxt, 
   Data_pilot_subtotal_function* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_subtotal_function_alt_1 (pctxt, pvalue->
            u.alt_1, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode alt_2 */

         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_subtotal_function_alt_2 (pctxt, pvalue->
            u.alt_2, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode alt_3 */

         if(pvalue->u.alt_3 < 0 || pvalue->u.alt_3 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_subtotal_function_alt_3 (pctxt, pvalue->
            u.alt_3, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode alt_4 */

         if(pvalue->u.alt_4 < 0 || pvalue->u.alt_4 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_subtotal_function_alt_4 (pctxt, pvalue->
            u.alt_4, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 6:
         /* encode alt_5 */

         if(pvalue->u.alt_5 < 0 || pvalue->u.alt_5 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_subtotal_function_alt_5 (pctxt, pvalue->
            u.alt_5, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 7:
         /* encode alt_6 */

         if(pvalue->u.alt_6 < 0 || pvalue->u.alt_6 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_subtotal_function_alt_6 (pctxt, pvalue->
            u.alt_6, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 8:
         /* encode alt_7 */

         if(pvalue->u.alt_7 < 0 || pvalue->u.alt_7 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_subtotal_function_alt_7 (pctxt, pvalue->
            u.alt_7, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 9:
         /* encode alt_8 */

         if(pvalue->u.alt_8 < 0 || pvalue->u.alt_8 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_subtotal_function_alt_8 (pctxt, pvalue->
            u.alt_8, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 10:
         /* encode alt_9 */

         if(pvalue->u.alt_9 < 0 || pvalue->u.alt_9 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_subtotal_function_alt_9 (pctxt, pvalue->
            u.alt_9, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 11:
         /* encode alt_10 */

         if(pvalue->u.alt_10 < 0 || pvalue->u.alt_10 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_subtotal_function_alt_10 (pctxt, pvalue->
            u.alt_10, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 12:
         /* encode alt_11 */

         if(pvalue->u.alt_11 < 0 || pvalue->u.alt_11 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_subtotal_function_alt_11 (pctxt, pvalue->
            u.alt_11, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 13:
         /* encode alt_12 */

         if(pvalue->u.alt_12 < 0 || pvalue->u.alt_12 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_subtotal_function_alt_12 (pctxt, pvalue->
            u.alt_12, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_subtotal                                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_subtotal (OSCTXT* pctxt,
   Data_pilot_subtotal *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode function */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
      asn1E_Data_pilot_subtotal_function (pctxt, &pvalue->function, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Data_pilot_subtotal (OSCTXT* pctxt, Data_pilot_subtotal* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:function=\""), 16);

   stat = XmlEnc_Data_pilot_subtotal_function (pctxt, &pvalue->function
      , 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_subtotals                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_subtotals (OSCTXT* pctxt,
   Data_pilot_subtotals *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode data_pilot_subtotal_list */

   pnode2 = pvalue->data_pilot_subtotal_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Data_pilot_subtotal (pctxt, ((Data_pilot_subtotal*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Data_pilot_subtotals (OSCTXT* pctxt, Data_pilot_subtotals* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode data_pilot_subtotal_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->data_pilot_subtotal_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Data_pilot_subtotal (pctxt, 
         ((Data_pilot_subtotal*)pnode->data)
         , OSUTF8("data-pilot-subtotal"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_member_display                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_member_display (OSCTXT* pctxt,
   Data_pilot_member_display *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_member_display (OSCTXT* pctxt, 
   Data_pilot_member_display value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_member_display_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_member_show_details                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_member_show_details (OSCTXT* pctxt,
   Data_pilot_member_show_details *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_member_show_details (OSCTXT* pctxt, 
   Data_pilot_member_show_details value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_member_show_details_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_member                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_member (OSCTXT* pctxt,
   Data_pilot_member *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode show_details */

   if (pvalue->m.show_detailsPresent) {
      if(pvalue->show_details < 0 || pvalue->show_details > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Data_pilot_member_show_details (pctxt, &pvalue->show_details, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode display */

   if (pvalue->m.displayPresent) {
      if(pvalue->display < 0 || pvalue->display > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Data_pilot_member_display (pctxt, &pvalue->display, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Data_pilot_member (OSCTXT* pctxt, Data_pilot_member* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.displayPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:display=\""), 15);

      if(pvalue->display < 0 || pvalue->display > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Data_pilot_member_display (pctxt, pvalue->display, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:name=\""), 12);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.show_detailsPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:show-details=\""), 20);

      if(pvalue->show_details < 0 || pvalue->show_details > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Data_pilot_member_show_details (pctxt, pvalue->show_details
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_members                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_members (OSCTXT* pctxt,
   Data_pilot_members *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode data_pilot_member_list */

   pnode2 = pvalue->data_pilot_member_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Data_pilot_member (pctxt, ((Data_pilot_member*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Data_pilot_members (OSCTXT* pctxt, Data_pilot_members* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode data_pilot_member_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->data_pilot_member_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Data_pilot_member (pctxt, ((Data_pilot_member*)pnode->data)
         , OSUTF8("data-pilot-member"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_display_info_display_member_mode               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_display_info_display_member_mode (OSCTXT* pctxt,
   Data_pilot_display_info_display_member_mode *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_display_info_display_member_mode (OSCTXT* pctxt, 
   Data_pilot_display_info_display_member_mode value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_display_info_display_member_mode_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_display_info_enabled                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_display_info_enabled (OSCTXT* pctxt,
   Data_pilot_display_info_enabled *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_display_info_enabled (OSCTXT* pctxt, 
   Data_pilot_display_info_enabled value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_display_info_enabled_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_display_info                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_display_info (OSCTXT* pctxt,
   Data_pilot_display_info *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode member_count */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
      xe_unsigned (pctxt, &pvalue->member_count, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode enabled */

   if(pvalue->enabled < 0 || pvalue->enabled > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
      asn1E_Data_pilot_display_info_enabled (pctxt, &pvalue->enabled, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode display_member_mode */

   if(pvalue->display_member_mode < 0 || pvalue->display_member_mode > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      asn1E_Data_pilot_display_info_display_member_mode (pctxt, &pvalue->display_member_mode, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode data_field */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_utf8str (pctxt, pvalue->data_field, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Data_pilot_display_info (OSCTXT* pctxt, 
   Data_pilot_display_info* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:data-field=\""), 18);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->data_field, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:display-member-mode=\""), 27);

   if(pvalue->display_member_mode < 0 || pvalue->display_member_mode > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Data_pilot_display_info_display_member_mode (pctxt, pvalue->
      display_member_mode, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:enabled=\""), 15);

   if(pvalue->enabled < 0 || pvalue->enabled > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Data_pilot_display_info_enabled (pctxt, pvalue->enabled
      , 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   stat = rtXmlEncUIntAttr
      (pctxt, pvalue->member_count, OSUTF8("ns15:member-count"), 17);

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_sort_info_order                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_sort_info_order (OSCTXT* pctxt,
   Data_pilot_sort_info_order *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_sort_info_order (OSCTXT* pctxt, 
   Data_pilot_sort_info_order value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_sort_info_order_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_sort_info_sort_mode                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_sort_info_sort_mode (OSCTXT* pctxt,
   Data_pilot_sort_info_sort_mode *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 3)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_sort_info_sort_mode (OSCTXT* pctxt, 
   Data_pilot_sort_info_sort_mode value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_sort_info_sort_mode_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_sort_info                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_sort_info (OSCTXT* pctxt,
   Data_pilot_sort_info *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode sort_mode */

   if(pvalue->sort_mode < 0 || pvalue->sort_mode > 3)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
      asn1E_Data_pilot_sort_info_sort_mode (pctxt, &pvalue->sort_mode, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode order */

   if(pvalue->order < 0 || pvalue->order > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      asn1E_Data_pilot_sort_info_order (pctxt, &pvalue->order, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode data_field */

   if (pvalue->m.data_fieldPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->data_field, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Data_pilot_sort_info (OSCTXT* pctxt, Data_pilot_sort_info* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.data_fieldPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:data-field=\""), 18);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->data_field, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:order=\""), 13);

   if(pvalue->order < 0 || pvalue->order > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Data_pilot_sort_info_order (pctxt, pvalue->order, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:sort-mode=\""), 17);

   if(pvalue->sort_mode < 0 || pvalue->sort_mode > 3)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Data_pilot_sort_info_sort_mode (pctxt, pvalue->sort_mode
      , 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_layout_info_add_empty_lines                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_layout_info_add_empty_lines (OSCTXT* pctxt,
   Data_pilot_layout_info_add_empty_lines *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_layout_info_add_empty_lines (OSCTXT* pctxt, 
   Data_pilot_layout_info_add_empty_lines value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_layout_info_add_empty_lines_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_layout_info_layout_mode                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_layout_info_layout_mode (OSCTXT* pctxt,
   Data_pilot_layout_info_layout_mode *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_layout_info_layout_mode (OSCTXT* pctxt, 
   Data_pilot_layout_info_layout_mode value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_layout_info_layout_mode_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_layout_info                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_layout_info (OSCTXT* pctxt,
   Data_pilot_layout_info *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode layout_mode */

   if(pvalue->layout_mode < 0 || pvalue->layout_mode > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      asn1E_Data_pilot_layout_info_layout_mode (pctxt, &pvalue->layout_mode, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode add_empty_lines */

   if(pvalue->add_empty_lines < 0 || pvalue->add_empty_lines > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      asn1E_Data_pilot_layout_info_add_empty_lines (pctxt, &pvalue->add_empty_lines, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Data_pilot_layout_info (OSCTXT* pctxt, 
   Data_pilot_layout_info* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:add-empty-lines=\""), 23);

   if(pvalue->add_empty_lines < 0 || pvalue->add_empty_lines > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Data_pilot_layout_info_add_empty_lines (pctxt, pvalue->
      add_empty_lines, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:layout-mode=\""), 19);

   if(pvalue->layout_mode < 0 || pvalue->layout_mode > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Data_pilot_layout_info_layout_mode (pctxt, pvalue->layout_mode
      , 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_level                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_level (OSCTXT* pctxt,
   Data_pilot_level *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode data_pilot_layout_info */

   if (pvalue->m.data_pilot_layout_infoPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Data_pilot_layout_info (pctxt, &pvalue->data_pilot_layout_info, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode data_pilot_sort_info */

   if (pvalue->m.data_pilot_sort_infoPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
         asn1E_Data_pilot_sort_info (pctxt, &pvalue->data_pilot_sort_info, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode data_pilot_display_info */

   if (pvalue->m.data_pilot_display_infoPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
         asn1E_Data_pilot_display_info (pctxt, &pvalue->data_pilot_display_info, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode data_pilot_members */

   if (pvalue->m.data_pilot_membersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Data_pilot_members (pctxt, &pvalue->data_pilot_members, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode data_pilot_subtotals */

   if (pvalue->m.data_pilot_subtotalsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
         asn1E_Data_pilot_subtotals (pctxt, &pvalue->data_pilot_subtotals, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode show_empty */

   if (pvalue->m.show_emptyPresent) {
      if(pvalue->show_empty < 0 || pvalue->show_empty > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Data_pilot_level_show_empty (pctxt, &pvalue->show_empty, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Data_pilot_level (OSCTXT* pctxt, Data_pilot_level* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.show_emptyPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:show-empty=\""), 18);

      if(pvalue->show_empty < 0 || pvalue->show_empty > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Data_pilot_level_show_empty (pctxt, pvalue->show_empty
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode data_pilot_subtotals */

   if (pvalue->m.data_pilot_subtotalsPresent) {
      stat = XmlEnc_Data_pilot_subtotals (pctxt, &pvalue->data_pilot_subtotals
         , OSUTF8("data-pilot-subtotals"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode data_pilot_members */

   if (pvalue->m.data_pilot_membersPresent) {
      stat = XmlEnc_Data_pilot_members (pctxt, &pvalue->data_pilot_members
         , OSUTF8("data-pilot-members"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode data_pilot_display_info */

   if (pvalue->m.data_pilot_display_infoPresent) {
      stat = XmlEnc_Data_pilot_display_info (pctxt, &pvalue->
         data_pilot_display_info
         , OSUTF8("data-pilot-display-info"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode data_pilot_sort_info */

   if (pvalue->m.data_pilot_sort_infoPresent) {
      stat = XmlEnc_Data_pilot_sort_info (pctxt, &pvalue->data_pilot_sort_info
         , OSUTF8("data-pilot-sort-info"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode data_pilot_layout_info */

   if (pvalue->m.data_pilot_layout_infoPresent) {
      stat = XmlEnc_Data_pilot_layout_info (pctxt, &pvalue->
         data_pilot_layout_info, OSUTF8("data-pilot-layout-info"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_reference_member_type                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_reference_member_type (OSCTXT* pctxt,
   Data_pilot_field_reference_member_type *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_field_reference_member_type (OSCTXT* pctxt, 
   Data_pilot_field_reference_member_type value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_field_reference_member_type_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_reference_type                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_reference_type (OSCTXT* pctxt,
   Data_pilot_field_reference_type *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 8)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_field_reference_type (OSCTXT* pctxt, 
   Data_pilot_field_reference_type value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_field_reference_type_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field_reference                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field_reference (OSCTXT* pctxt,
   Data_pilot_field_reference *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode type */

   if(pvalue->type < 0 || pvalue->type > 8)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
      asn1E_Data_pilot_field_reference_type (pctxt, &pvalue->type, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode member_type */

   if(pvalue->member_type < 0 || pvalue->member_type > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
      asn1E_Data_pilot_field_reference_member_type (pctxt, &pvalue->member_type, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode member_name */

   if (pvalue->m.member_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->member_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode field_name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_utf8str (pctxt, pvalue->field_name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Data_pilot_field_reference (OSCTXT* pctxt, 
   Data_pilot_field_reference* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:field-name=\""), 18);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->field_name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.member_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:member-name=\""), 19);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->member_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:member-type=\""), 19);

   if(pvalue->member_type < 0 || pvalue->member_type > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Data_pilot_field_reference_member_type (pctxt, pvalue->
      member_type, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:type=\""), 12);

   if(pvalue->type < 0 || pvalue->type > 8)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Data_pilot_field_reference_type (pctxt, pvalue->type, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_groups_date_end_alt_2                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_groups_date_end_alt_2 (OSCTXT* pctxt,
   Data_pilot_groups_date_end_alt_2 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_groups_date_end_alt_2 (OSCTXT* pctxt, 
   Data_pilot_groups_date_end_alt_2 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_groups_date_end_alt_2_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_groups_date_end                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_groups_date_end (OSCTXT* pctxt,
   Data_pilot_groups_date_end *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_charstr (pctxt, pvalue->u.alt, ASN1IMPL, TM_UNIV|TM_PRIM|26));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_charstr (pctxt, pvalue->u.alt_1, ASN1IMPL, TM_UNIV|TM_PRIM|26));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
            asn1E_Data_pilot_groups_date_end_alt_2 (pctxt, &pvalue->u.alt_2, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Data_pilot_groups_date_end (OSCTXT* pctxt, 
   Data_pilot_groups_date_end* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, (const OSUTF8CHAR*)pvalue->u.alt
            , 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         stat = rtXmlEncUTF8Str (pctxt, (const OSUTF8CHAR*)pvalue->u.alt_1
            , 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode alt_2 */

         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_groups_date_end_alt_2 (pctxt, pvalue->u.alt_2
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_groups_date_start_alt_2                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_groups_date_start_alt_2 (OSCTXT* pctxt,
   Data_pilot_groups_date_start_alt_2 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_groups_date_start_alt_2 (OSCTXT* pctxt, 
   Data_pilot_groups_date_start_alt_2 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_groups_date_start_alt_2_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_groups_date_start                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_groups_date_start (OSCTXT* pctxt,
   Data_pilot_groups_date_start *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_charstr (pctxt, pvalue->u.alt, ASN1IMPL, TM_UNIV|TM_PRIM|26));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_charstr (pctxt, pvalue->u.alt_1, ASN1IMPL, TM_UNIV|TM_PRIM|26));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
            asn1E_Data_pilot_groups_date_start_alt_2 (pctxt, &pvalue->u.alt_2, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Data_pilot_groups_date_start (OSCTXT* pctxt, 
   Data_pilot_groups_date_start* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, (const OSUTF8CHAR*)pvalue->u.alt
            , 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         stat = rtXmlEncUTF8Str (pctxt, (const OSUTF8CHAR*)pvalue->u.alt_1
            , 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode alt_2 */

         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_groups_date_start_alt_2 (pctxt, pvalue->
            u.alt_2, 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_groups_end_alt_1                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_groups_end_alt_1 (OSCTXT* pctxt,
   Data_pilot_groups_end_alt_1 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_groups_end_alt_1 (OSCTXT* pctxt, 
   Data_pilot_groups_end_alt_1 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_groups_end_alt_1_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_groups_end                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_groups_end (OSCTXT* pctxt,
   Data_pilot_groups_end *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_real (pctxt, &pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            asn1E_Data_pilot_groups_end_alt_1 (pctxt, &pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Data_pilot_groups_end (OSCTXT* pctxt, 
   Data_pilot_groups_end* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncDouble (pctxt, pvalue->u.alt, 0, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_groups_end_alt_1 (pctxt, pvalue->u.alt_1
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_groups_grouped_by                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_groups_grouped_by (OSCTXT* pctxt,
   Data_pilot_groups_grouped_by *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 6)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_groups_grouped_by (OSCTXT* pctxt, 
   Data_pilot_groups_grouped_by value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_groups_grouped_by_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_groups_start_alt_1                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_groups_start_alt_1 (OSCTXT* pctxt,
   Data_pilot_groups_start_alt_1 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Data_pilot_groups_start_alt_1 (OSCTXT* pctxt, 
   Data_pilot_groups_start_alt_1 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Data_pilot_groups_start_alt_1_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_groups_start                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_groups_start (OSCTXT* pctxt,
   Data_pilot_groups_start *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_real (pctxt, &pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            asn1E_Data_pilot_groups_start_alt_1 (pctxt, &pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Data_pilot_groups_start (OSCTXT* pctxt, 
   Data_pilot_groups_start* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncDouble (pctxt, pvalue->u.alt, 0, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Data_pilot_groups_start_alt_1 (pctxt, pvalue->u.alt_1
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_group_member                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_group_member (OSCTXT* pctxt,
   Data_pilot_group_member *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Data_pilot_group_member (OSCTXT* pctxt, 
   Data_pilot_group_member* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:name=\""), 12);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_group                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_group (OSCTXT* pctxt,
   Data_pilot_group *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode data_pilot_group_member_list */

   pnode2 = pvalue->data_pilot_group_member_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Data_pilot_group_member (pctxt, ((Data_pilot_group_member*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Data_pilot_group (OSCTXT* pctxt, Data_pilot_group* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:name=\""), 12);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode data_pilot_group_member_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->data_pilot_group_member_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Data_pilot_group_member (pctxt, 
         ((Data_pilot_group_member*)pnode->data)
         , OSUTF8("data-pilot-group-member"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_groups                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_groups (OSCTXT* pctxt,
   Data_pilot_groups *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode data_pilot_group_list */

   pnode2 = pvalue->data_pilot_group_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Data_pilot_group (pctxt, ((Data_pilot_group*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode step */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
      xe_real (pctxt, &pvalue->step, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode start */

   if (pvalue->m.startPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Data_pilot_groups_start (pctxt, &pvalue->start, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode source_field_name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
      xe_utf8str (pctxt, pvalue->source_field_name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode grouped_by */

   if(pvalue->grouped_by < 0 || pvalue->grouped_by > 6)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
      asn1E_Data_pilot_groups_grouped_by (pctxt, &pvalue->grouped_by, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode end */

   if (pvalue->m.endPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Data_pilot_groups_end (pctxt, &pvalue->end, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode date_start */

   if (pvalue->m.date_startPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
         asn1E_Data_pilot_groups_date_start (pctxt, &pvalue->date_start, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode date_end */

   if (pvalue->m.date_endPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Data_pilot_groups_date_end (pctxt, &pvalue->date_end, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Data_pilot_groups (OSCTXT* pctxt, Data_pilot_groups* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.date_endPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:date-end=\""), 16);

      stat = XmlEnc_Data_pilot_groups_date_end (pctxt, &pvalue->date_end
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.date_startPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:date-start=\""), 18);

      stat = XmlEnc_Data_pilot_groups_date_start (pctxt, &pvalue->date_start
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.endPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end=\""), 11);

      stat = XmlEnc_Data_pilot_groups_end (pctxt, &pvalue->end, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:grouped-by=\""), 18);

   if(pvalue->grouped_by < 0 || pvalue->grouped_by > 6)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Data_pilot_groups_grouped_by (pctxt, pvalue->grouped_by
      , 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:source-field-name=\""), 25);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->source_field_name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.startPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:start=\""), 13);

      stat = XmlEnc_Data_pilot_groups_start (pctxt, &pvalue->start, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:step=\""), 12);

   stat = rtXmlEncDouble (pctxt, pvalue->step, 0, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode data_pilot_group_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->data_pilot_group_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Data_pilot_group (pctxt, ((Data_pilot_group*)pnode->data)
         , OSUTF8("data-pilot-group"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_field                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_field (OSCTXT* pctxt,
   Data_pilot_field *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode data_pilot_groups */

   if (pvalue->m.data_pilot_groupsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Data_pilot_groups (pctxt, &pvalue->data_pilot_groups, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode data_pilot_field_reference */

   if (pvalue->m.data_pilot_field_referencePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Data_pilot_field_reference (pctxt, &pvalue->data_pilot_field_reference, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode data_pilot_level */

   if (pvalue->m.data_pilot_levelPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Data_pilot_level (pctxt, &pvalue->data_pilot_level, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode used_hierarchy */

   if (pvalue->m.used_hierarchyPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         xe_integer (pctxt, &pvalue->used_hierarchy, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode source_field_name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
      xe_utf8str (pctxt, pvalue->source_field_name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode selected_page */

   if (pvalue->m.selected_pagePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_utf8str (pctxt, pvalue->selected_page, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode orientation */

   if(pvalue->orientation < 0 || pvalue->orientation > 4)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
      asn1E_Data_pilot_field_orientation (pctxt, &pvalue->orientation, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode is_data_layout_field */

   if (pvalue->m.is_data_layout_fieldPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->is_data_layout_field, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode function */

   if (pvalue->m.functionPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Data_pilot_field_function (pctxt, &pvalue->function, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Data_pilot_field (OSCTXT* pctxt, Data_pilot_field* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.functionPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:function=\""), 16);

      stat = XmlEnc_Data_pilot_field_function (pctxt, &pvalue->function
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.is_data_layout_fieldPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:is-data-layout-field=\""), 28);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->is_data_layout_field, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:orientation=\""), 19);

   if(pvalue->orientation < 0 || pvalue->orientation > 4)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Data_pilot_field_orientation (pctxt, pvalue->orientation
      , 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.selected_pagePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:selected-page=\""), 21);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->selected_page, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:source-field-name=\""), 25);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->source_field_name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.used_hierarchyPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->used_hierarchy, OSUTF8("ns15:used-hierarchy"), 19);
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode data_pilot_level */

   if (pvalue->m.data_pilot_levelPresent) {
      stat = XmlEnc_Data_pilot_level (pctxt, &pvalue->data_pilot_level
         , OSUTF8("data-pilot-level"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode data_pilot_field_reference */

   if (pvalue->m.data_pilot_field_referencePresent) {
      stat = XmlEnc_Data_pilot_field_reference (pctxt, &pvalue->
         data_pilot_field_reference
         , OSUTF8("data-pilot-field-reference"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode data_pilot_groups */

   if (pvalue->m.data_pilot_groupsPresent) {
      stat = XmlEnc_Data_pilot_groups (pctxt, &pvalue->data_pilot_groups
         , OSUTF8("data-pilot-groups"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_table                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_table (OSCTXT* pctxt,
   Data_pilot_table *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode data_pilot_field_list */

   pnode2 = pvalue->data_pilot_field_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Data_pilot_field (pctxt, ((Data_pilot_field*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode choice */

   if (pvalue->m.choicePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Data_pilot_table_choice (pctxt, &pvalue->choice, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode target_range_address */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
      xe_utf8str (pctxt, pvalue->target_range_address, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode show_filter_button */

   if (pvalue->m.show_filter_buttonPresent) {
      if(pvalue->show_filter_button < 0 || pvalue->show_filter_button > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Data_pilot_table_show_filter_button (pctxt, &pvalue->show_filter_button, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
      xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode ignore_empty_rows */

   if (pvalue->m.ignore_empty_rowsPresent) {
      if(pvalue->ignore_empty_rows < 0 || pvalue->ignore_empty_rows > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Data_pilot_table_ignore_empty_rows (pctxt, &pvalue->ignore_empty_rows, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode identify_categories */

   if (pvalue->m.identify_categoriesPresent) {
      if(pvalue->identify_categories < 0 || pvalue->identify_categories > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Data_pilot_table_identify_categories (pctxt, &pvalue->identify_categories, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode grand_total */

   if (pvalue->m.grand_totalPresent) {
      if(pvalue->grand_total < 0 || pvalue->grand_total > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Data_pilot_table_grand_total (pctxt, &pvalue->grand_total, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode drill_down_on_double_click */

   if (pvalue->m.drill_down_on_double_clickPresent) {
      if(pvalue->drill_down_on_double_click < 0 || pvalue->drill_down_on_double_click > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Data_pilot_table_drill_down_on_double_click (pctxt, &pvalue->drill_down_on_double_click, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode buttons */

   if (pvalue->m.buttonsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->buttons, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode application_data */

   if (pvalue->m.application_dataPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->application_data, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Data_pilot_table (OSCTXT* pctxt, Data_pilot_table* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.application_dataPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:application-data=\""), 24);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->application_data, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.buttonsPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:buttons=\""), 15);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->buttons, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.drill_down_on_double_clickPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:drill-down-on-double-click=\""), 34);

      if(pvalue->drill_down_on_double_click < 0 || pvalue->
         drill_down_on_double_click > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Data_pilot_table_drill_down_on_double_click (pctxt, pvalue
         ->drill_down_on_double_click, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.grand_totalPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:grand-total=\""), 19);

      if(pvalue->grand_total < 0 || pvalue->grand_total > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Data_pilot_table_grand_total (pctxt, pvalue->grand_total
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.identify_categoriesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:identify-categories=\""), 27);

      if(pvalue->identify_categories < 0 || pvalue->identify_categories > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Data_pilot_table_identify_categories (pctxt, pvalue->
         identify_categories, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.ignore_empty_rowsPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:ignore-empty-rows=\""), 25);

      if(pvalue->ignore_empty_rows < 0 || pvalue->ignore_empty_rows > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Data_pilot_table_ignore_empty_rows (pctxt, pvalue->
         ignore_empty_rows, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:name=\""), 12);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.show_filter_buttonPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:show-filter-button=\""), 26);

      if(pvalue->show_filter_button < 0 || pvalue->show_filter_button > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Data_pilot_table_show_filter_button (pctxt, pvalue->
         show_filter_button, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:target-range-address=\""), 28);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->target_range_address, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode choice */

   if (pvalue->m.choicePresent) {
      stat = XmlEnc_Data_pilot_table_choice (pctxt, &pvalue->choice
         , OSUTF8(""), 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode data_pilot_field_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->data_pilot_field_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Data_pilot_field (pctxt, ((Data_pilot_field*)pnode->data)
         , OSUTF8("data-pilot-field"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Data_pilot_tables                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Data_pilot_tables (OSCTXT* pctxt,
   Data_pilot_tables *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode data_pilot_table_list */

   pnode2 = pvalue->data_pilot_table_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Data_pilot_table (pctxt, ((Data_pilot_table*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Data_pilot_tables (OSCTXT* pctxt, Data_pilot_tables* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode data_pilot_table_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->data_pilot_table_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Data_pilot_table (pctxt, ((Data_pilot_table*)pnode->data)
         , OSUTF8("data-pilot-table"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Consolidation_function_alt_1                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Consolidation_function_alt_1 (OSCTXT* pctxt,
   Consolidation_function_alt_1 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Consolidation_function_alt_1 (OSCTXT* pctxt, 
   Consolidation_function_alt_1 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Consolidation_function_alt_1_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Consolidation_function_alt_2                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Consolidation_function_alt_2 (OSCTXT* pctxt,
   Consolidation_function_alt_2 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Consolidation_function_alt_2 (OSCTXT* pctxt, 
   Consolidation_function_alt_2 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Consolidation_function_alt_2_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Consolidation_function_alt_3                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Consolidation_function_alt_3 (OSCTXT* pctxt,
   Consolidation_function_alt_3 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Consolidation_function_alt_3 (OSCTXT* pctxt, 
   Consolidation_function_alt_3 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Consolidation_function_alt_3_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Consolidation_function_alt_4                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Consolidation_function_alt_4 (OSCTXT* pctxt,
   Consolidation_function_alt_4 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Consolidation_function_alt_4 (OSCTXT* pctxt, 
   Consolidation_function_alt_4 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Consolidation_function_alt_4_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Consolidation_function_alt_5                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Consolidation_function_alt_5 (OSCTXT* pctxt,
   Consolidation_function_alt_5 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Consolidation_function_alt_5 (OSCTXT* pctxt, 
   Consolidation_function_alt_5 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Consolidation_function_alt_5_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Consolidation_function_alt_6                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Consolidation_function_alt_6 (OSCTXT* pctxt,
   Consolidation_function_alt_6 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Consolidation_function_alt_6 (OSCTXT* pctxt, 
   Consolidation_function_alt_6 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Consolidation_function_alt_6_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Consolidation_function_alt_7                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Consolidation_function_alt_7 (OSCTXT* pctxt,
   Consolidation_function_alt_7 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Consolidation_function_alt_7 (OSCTXT* pctxt, 
   Consolidation_function_alt_7 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Consolidation_function_alt_7_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Consolidation_function_alt_8                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Consolidation_function_alt_8 (OSCTXT* pctxt,
   Consolidation_function_alt_8 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Consolidation_function_alt_8 (OSCTXT* pctxt, 
   Consolidation_function_alt_8 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Consolidation_function_alt_8_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Consolidation_function_alt_9                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Consolidation_function_alt_9 (OSCTXT* pctxt,
   Consolidation_function_alt_9 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Consolidation_function_alt_9 (OSCTXT* pctxt, 
   Consolidation_function_alt_9 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Consolidation_function_alt_9_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Consolidation_function_alt_10                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Consolidation_function_alt_10 (OSCTXT* pctxt,
   Consolidation_function_alt_10 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Consolidation_function_alt_10 (OSCTXT* pctxt, 
   Consolidation_function_alt_10 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Consolidation_function_alt_10_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Consolidation_function_alt_11                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Consolidation_function_alt_11 (OSCTXT* pctxt,
   Consolidation_function_alt_11 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Consolidation_function_alt_11 (OSCTXT* pctxt, 
   Consolidation_function_alt_11 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Consolidation_function_alt_11_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Consolidation_function_alt_12                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Consolidation_function_alt_12 (OSCTXT* pctxt,
   Consolidation_function_alt_12 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Consolidation_function_alt_12 (OSCTXT* pctxt, 
   Consolidation_function_alt_12 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Consolidation_function_alt_12_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Consolidation_function                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Consolidation_function (OSCTXT* pctxt,
   Consolidation_function *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            asn1E_Consolidation_function_alt_1 (pctxt, &pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
            asn1E_Consolidation_function_alt_2 (pctxt, &pvalue->u.alt_2, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         if(pvalue->u.alt_3 < 0 || pvalue->u.alt_3 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
            asn1E_Consolidation_function_alt_3 (pctxt, &pvalue->u.alt_3, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         if(pvalue->u.alt_4 < 0 || pvalue->u.alt_4 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
            asn1E_Consolidation_function_alt_4 (pctxt, &pvalue->u.alt_4, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 6:
         if(pvalue->u.alt_5 < 0 || pvalue->u.alt_5 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
            asn1E_Consolidation_function_alt_5 (pctxt, &pvalue->u.alt_5, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 7:
         if(pvalue->u.alt_6 < 0 || pvalue->u.alt_6 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
            asn1E_Consolidation_function_alt_6 (pctxt, &pvalue->u.alt_6, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 8:
         if(pvalue->u.alt_7 < 0 || pvalue->u.alt_7 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
            asn1E_Consolidation_function_alt_7 (pctxt, &pvalue->u.alt_7, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 9:
         if(pvalue->u.alt_8 < 0 || pvalue->u.alt_8 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
            asn1E_Consolidation_function_alt_8 (pctxt, &pvalue->u.alt_8, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 10:
         if(pvalue->u.alt_9 < 0 || pvalue->u.alt_9 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
            asn1E_Consolidation_function_alt_9 (pctxt, &pvalue->u.alt_9, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 11:
         if(pvalue->u.alt_10 < 0 || pvalue->u.alt_10 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
            asn1E_Consolidation_function_alt_10 (pctxt, &pvalue->u.alt_10, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 12:
         if(pvalue->u.alt_11 < 0 || pvalue->u.alt_11 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
            asn1E_Consolidation_function_alt_11 (pctxt, &pvalue->u.alt_11, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 13:
         if(pvalue->u.alt_12 < 0 || pvalue->u.alt_12 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|12,
            asn1E_Consolidation_function_alt_12 (pctxt, &pvalue->u.alt_12, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Consolidation_function (OSCTXT* pctxt, 
   Consolidation_function* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Consolidation_function_alt_1 (pctxt, pvalue->u.alt_1
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode alt_2 */

         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Consolidation_function_alt_2 (pctxt, pvalue->u.alt_2
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode alt_3 */

         if(pvalue->u.alt_3 < 0 || pvalue->u.alt_3 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Consolidation_function_alt_3 (pctxt, pvalue->u.alt_3
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode alt_4 */

         if(pvalue->u.alt_4 < 0 || pvalue->u.alt_4 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Consolidation_function_alt_4 (pctxt, pvalue->u.alt_4
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 6:
         /* encode alt_5 */

         if(pvalue->u.alt_5 < 0 || pvalue->u.alt_5 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Consolidation_function_alt_5 (pctxt, pvalue->u.alt_5
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 7:
         /* encode alt_6 */

         if(pvalue->u.alt_6 < 0 || pvalue->u.alt_6 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Consolidation_function_alt_6 (pctxt, pvalue->u.alt_6
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 8:
         /* encode alt_7 */

         if(pvalue->u.alt_7 < 0 || pvalue->u.alt_7 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Consolidation_function_alt_7 (pctxt, pvalue->u.alt_7
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 9:
         /* encode alt_8 */

         if(pvalue->u.alt_8 < 0 || pvalue->u.alt_8 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Consolidation_function_alt_8 (pctxt, pvalue->u.alt_8
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 10:
         /* encode alt_9 */

         if(pvalue->u.alt_9 < 0 || pvalue->u.alt_9 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Consolidation_function_alt_9 (pctxt, pvalue->u.alt_9
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 11:
         /* encode alt_10 */

         if(pvalue->u.alt_10 < 0 || pvalue->u.alt_10 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Consolidation_function_alt_10 (pctxt, pvalue->u.alt_10
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 12:
         /* encode alt_11 */

         if(pvalue->u.alt_11 < 0 || pvalue->u.alt_11 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Consolidation_function_alt_11 (pctxt, pvalue->u.alt_11
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 13:
         /* encode alt_12 */

         if(pvalue->u.alt_12 < 0 || pvalue->u.alt_12 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Consolidation_function_alt_12 (pctxt, pvalue->u.alt_12
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Consolidation_link_to_source_data                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Consolidation_link_to_source_data (OSCTXT* pctxt,
   Consolidation_link_to_source_data *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Consolidation_link_to_source_data (OSCTXT* pctxt, 
   Consolidation_link_to_source_data value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Consolidation_link_to_source_data_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Consolidation_use_labels                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Consolidation_use_labels (OSCTXT* pctxt,
   Consolidation_use_labels *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 3)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Consolidation_use_labels (OSCTXT* pctxt, 
   Consolidation_use_labels value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Consolidation_use_labels_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Consolidation                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Consolidation (OSCTXT* pctxt,
   Consolidation *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode use_labels */

   if (pvalue->m.use_labelsPresent) {
      if(pvalue->use_labels < 0 || pvalue->use_labels > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Consolidation_use_labels (pctxt, &pvalue->use_labels, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode target_cell_address */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
      xe_utf8str (pctxt, pvalue->target_cell_address, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode source_cell_range_addresses */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
      xe_utf8str (pctxt, pvalue->source_cell_range_addresses, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode link_to_source_data */

   if (pvalue->m.link_to_source_dataPresent) {
      if(pvalue->link_to_source_data < 0 || pvalue->link_to_source_data > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Consolidation_link_to_source_data (pctxt, &pvalue->link_to_source_data, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode function */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
      asn1E_Consolidation_function (pctxt, &pvalue->function, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Consolidation (OSCTXT* pctxt, Consolidation* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:function=\""), 16);

   stat = XmlEnc_Consolidation_function (pctxt, &pvalue->function, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.link_to_source_dataPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:link-to-source-data=\""), 27);

      if(pvalue->link_to_source_data < 0 || pvalue->link_to_source_data > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Consolidation_link_to_source_data (pctxt, pvalue->
         link_to_source_data, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:source-cell-range-addresses=\""), 35);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->source_cell_range_addresses, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:target-cell-address=\""), 27);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->target_cell_address, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.use_labelsPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:use-labels=\""), 18);

      if(pvalue->use_labels < 0 || pvalue->use_labels > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Consolidation_use_labels (pctxt, pvalue->use_labels
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Dde_link                                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Dde_link (OSCTXT* pctxt,
   Dde_link *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode table */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
      asn1E_Table (pctxt, &pvalue->table, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode dde_source */

   if (pvalue->dde_source == NULL) {
      rtxErrAddStrParm (pctxt, "pvalue->dde_source");
      return LOG_RTERR (pctxt, RTERR_NULLPTR);
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
      asn1E_Ns13_Dde_source (pctxt, (Ns13_Dde_source*)pvalue->dde_source, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Dde_link (OSCTXT* pctxt, Dde_link* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode dde_source */

   stat = XmlEnc_Ns13_Dde_source (pctxt, pvalue->dde_source
      , OSUTF8("dde-source"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   /* encode table */

   stat = XmlEnc_Table (pctxt, &pvalue->table, OSUTF8("table"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Dde_links                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Dde_links (OSCTXT* pctxt,
   Dde_links *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode dde_link_list */

   pnode2 = pvalue->dde_link_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Dde_link (pctxt, ((Dde_link*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Dde_links (OSCTXT* pctxt, Dde_links* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode dde_link_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->dde_link_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Dde_link (pctxt, ((Dde_link*)pnode->data)
         , OSUTF8("dde-link"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Protection_key                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Protection_key (OSCTXT* pctxt,
   Protection_key pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Protection_key (OSCTXT* pctxt, Protection_key value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Structure_protected                                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Structure_protected (OSCTXT* pctxt,
   Structure_protected *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Structure_protected (OSCTXT* pctxt, Structure_protected value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Structure_protected_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Cell_range                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Cell_range (OSCTXT* pctxt,
   Cell_range pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Cell_range (OSCTXT* pctxt, Cell_range value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Tracked_changes_track_changes                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns15_Tracked_changes_track_changes (OSCTXT* pctxt,
   Ns15_Tracked_changes_track_changes *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns15_Tracked_changes_track_changes (OSCTXT* pctxt, 
   Ns15_Tracked_changes_track_changes value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns15_Tracked_changes_track_changes_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Cell_content_change_acceptance_state                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Cell_content_change_acceptance_state (OSCTXT* pctxt,
   Cell_content_change_acceptance_state *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Cell_content_change_acceptance_state (OSCTXT* pctxt, 
   Cell_content_change_acceptance_state value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Cell_content_change_acceptance_state_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Insertion_acceptance_state                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Insertion_acceptance_state (OSCTXT* pctxt,
   Insertion_acceptance_state *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Insertion_acceptance_state (OSCTXT* pctxt, 
   Insertion_acceptance_state value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Insertion_acceptance_state_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Insertion_type                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Insertion_type (OSCTXT* pctxt,
   Insertion_type *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Insertion_type (OSCTXT* pctxt, Insertion_type value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Insertion_type_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Deletion_acceptance_state                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Deletion_acceptance_state (OSCTXT* pctxt,
   Deletion_acceptance_state *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Deletion_acceptance_state (OSCTXT* pctxt, 
   Deletion_acceptance_state value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Deletion_acceptance_state_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Deletion_type                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Deletion_type (OSCTXT* pctxt,
   Deletion_type *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Deletion_type (OSCTXT* pctxt, Deletion_type value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Deletion_type_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Movement_acceptance_state                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Movement_acceptance_state (OSCTXT* pctxt,
   Movement_acceptance_state *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Movement_acceptance_state (OSCTXT* pctxt, 
   Movement_acceptance_state value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Movement_acceptance_state_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Change_track_table_cell_value_type                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Change_track_table_cell_value_type (OSCTXT* pctxt,
   Change_track_table_cell_value_type *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 6)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Change_track_table_cell_value_type (OSCTXT* pctxt, 
   Change_track_table_cell_value_type value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Change_track_table_cell_value_type_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Change_track_table_cell_matrix_covered                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Change_track_table_cell_matrix_covered (OSCTXT* pctxt,
   Change_track_table_cell_matrix_covered *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Change_track_table_cell_matrix_covered (OSCTXT* pctxt, 
   Change_track_table_cell_matrix_covered value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Change_track_table_cell_matrix_covered_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Cell_address                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Cell_address (OSCTXT* pctxt,
   Cell_address *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode table */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
      xe_integer (pctxt, &pvalue->table, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode row */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_integer (pctxt, &pvalue->row, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode column */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_integer (pctxt, &pvalue->column, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Cell_address (OSCTXT* pctxt, Cell_address* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   stat = rtXmlEncIntAttr
      (pctxt, pvalue->column, OSUTF8("ns15:column"), 11);

   stat = rtXmlEncIntAttr
      (pctxt, pvalue->row, OSUTF8("ns15:row"), 8);

   stat = rtXmlEncIntAttr
      (pctxt, pvalue->table, OSUTF8("ns15:table"), 10);

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Dependency                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Dependency (OSCTXT* pctxt,
   Dependency *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode id */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_utf8str (pctxt, pvalue->id, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Dependency (OSCTXT* pctxt, Dependency* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:id=\""), 10);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->id, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Dependencies                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Dependencies (OSCTXT* pctxt,
   Dependencies *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode dependency_list */

   pnode2 = pvalue->dependency_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Dependency (pctxt, ((Dependency*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Dependencies (OSCTXT* pctxt, Dependencies* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode dependency_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->dependency_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Dependency (pctxt, ((Dependency*)pnode->data)
         , OSUTF8("dependency"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Change_track_table_cell                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Change_track_table_cell (OSCTXT* pctxt,
   Change_track_table_cell *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode p_list */

   pnode2 = pvalue->p_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Odf_P (pctxt, (Odf_P*)((Odf_P*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode number_matrix_rows_spanned */

   if (pvalue->m.number_matrix_rows_spannedPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
         xe_unsigned (pctxt, &pvalue->number_matrix_rows_spanned, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode number_matrix_columns_spanned */

   if (pvalue->m.number_matrix_columns_spannedPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
         xe_unsigned (pctxt, &pvalue->number_matrix_columns_spanned, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode matrix_covered */

   if (pvalue->m.matrix_coveredPresent) {
      if(pvalue->matrix_covered < 0 || pvalue->matrix_covered > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         asn1E_Change_track_table_cell_matrix_covered (pctxt, &pvalue->matrix_covered, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode formula */

   if (pvalue->m.formulaPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         xe_utf8str (pctxt, pvalue->formula, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode cell_address */

   if (pvalue->m.cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         xe_utf8str (pctxt, pvalue->cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode value_type */

   if (pvalue->m.value_typePresent) {
      if(pvalue->value_type < 0 || pvalue->value_type > 6)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         asn1E_Change_track_table_cell_value_type (pctxt, &pvalue->value_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode value */

   if (pvalue->m.valuePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns13_Value (pctxt, (Ns13_Value*)&pvalue->value, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode time_value */

   if (pvalue->m.time_valuePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns13_Time_value (pctxt, (Ns13_Time_value)pvalue->time_value, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode string_value */

   if (pvalue->m.string_valuePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns13_String_value (pctxt, (Ns13_String_value)pvalue->string_value, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode date_value */

   if (pvalue->m.date_valuePresent) {
      if (pvalue->date_value == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->date_value");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Ns13_Date_value (pctxt, (Ns13_Date_value*)pvalue->date_value, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode currency */

   if (pvalue->m.currencyPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns13_Currency (pctxt, (Ns13_Currency)pvalue->currency, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode boolean_value */

   if (pvalue->m.boolean_valuePresent) {
      if(pvalue->boolean_value < 0 || pvalue->boolean_value > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns13_Boolean_value (pctxt, (Ns13_Boolean_value*)&pvalue->boolean_value, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Change_track_table_cell (OSCTXT* pctxt, 
   Change_track_table_cell* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.boolean_valuePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:boolean-value=\""), 21);

      if(pvalue->boolean_value < 0 || pvalue->boolean_value > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns13_Boolean_value (pctxt, pvalue->boolean_value, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.currencyPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:currency=\""), 16);

      stat = XmlEnc_Ns13_Currency (pctxt, pvalue->currency, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.date_valuePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:date-value=\""), 18);

      stat = XmlEnc_Ns13_Date_value (pctxt, pvalue->date_value, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.string_valuePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:string-value=\""), 20);

      stat = XmlEnc_Ns13_String_value (pctxt, pvalue->string_value, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.time_valuePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:time-value=\""), 18);

      stat = XmlEnc_Ns13_Time_value (pctxt, pvalue->time_value, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.valuePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:value=\""), 13);

      stat = XmlEnc_Ns13_Value (pctxt, pvalue->value, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.value_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:value-type=\""), 18);

      if(pvalue->value_type < 0 || pvalue->value_type > 6)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Change_track_table_cell_value_type (pctxt, pvalue->
         value_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:cell-address=\""), 20);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.formulaPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:formula=\""), 15);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->formula, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.matrix_coveredPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:matrix-covered=\""), 22);

      if(pvalue->matrix_covered < 0 || pvalue->matrix_covered > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Change_track_table_cell_matrix_covered (pctxt, pvalue->
         matrix_covered, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.number_matrix_columns_spannedPresent) {
      stat = rtXmlEncUIntAttr
         (pctxt, pvalue->number_matrix_columns_spanned
            , OSUTF8("ns15:number-matrix-columns-spanned"), 34);
   }

   if (pvalue->m.number_matrix_rows_spannedPresent) {
      stat = rtXmlEncUIntAttr
         (pctxt, pvalue->number_matrix_rows_spanned
            , OSUTF8("ns15:number-matrix-rows-spanned"), 31);
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode p_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->p_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Odf_P (pctxt, ((Odf_P*)pnode->data)
         , OSUTF8("p"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Cell_content_deletion                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Cell_content_deletion (OSCTXT* pctxt,
   Cell_content_deletion *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode change_track_table_cell */

   if (pvalue->m.change_track_table_cellPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Change_track_table_cell (pctxt, &pvalue->change_track_table_cell, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode cell_address */

   if (pvalue->m.cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
         asn1E_Cell_address (pctxt, &pvalue->cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Cell_content_deletion (OSCTXT* pctxt, 
   Cell_content_deletion* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:id=\""), 10);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode cell_address */

   if (pvalue->m.cell_addressPresent) {
      stat = XmlEnc_Cell_address (pctxt, &pvalue->cell_address
         , OSUTF8("cell-address"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode change_track_table_cell */

   if (pvalue->m.change_track_table_cellPresent) {
      stat = XmlEnc_Change_track_table_cell (pctxt, &pvalue->
         change_track_table_cell
         , OSUTF8("change-track-table-cell"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Change_deletion                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Change_deletion (OSCTXT* pctxt,
   Change_deletion *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Change_deletion (OSCTXT* pctxt, Change_deletion* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:id=\""), 10);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Deletions_element                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Deletions_element (OSCTXT* pctxt,
   Deletions_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Cell_content_deletion (pctxt, pvalue->u.cell_content_deletion, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Change_deletion (pctxt, pvalue->u.change_deletion, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Deletions_element (OSCTXT* pctxt, Deletions_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode cell_content_deletion */

         stat = XmlEnc_Cell_content_deletion (pctxt, pvalue->
            u.cell_content_deletion
            , OSUTF8("cell-content-deletion"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode change_deletion */

         stat = XmlEnc_Change_deletion (pctxt, pvalue->u.change_deletion
            , OSUTF8("change-deletion"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Deletions                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Deletions (OSCTXT* pctxt,
   Deletions *pvalue, ASN1TagType tagging)
{
   OSRTDListNode* pnode1;
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   pnode1 = pvalue->tail;
   while (0 != pnode1) {
      ll = asn1E_Deletions_element (pctxt, ((Deletions_element*)pnode1->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;

      pnode1 = pnode1->prev;
   }
   ll1 = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll1);
   if (ll1 < 0) return LOG_RTERR (pctxt, ll1);

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Deletions (OSCTXT* pctxt, Deletions* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (elemName != 0) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->head;
   while (0 != pnode) {
      stat = XmlEnc_Deletions_element (pctxt, ((Deletions_element*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Previous                                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Previous (OSCTXT* pctxt,
   Previous *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode change_track_table_cell */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
      asn1E_Change_track_table_cell (pctxt, &pvalue->change_track_table_cell, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Previous (OSCTXT* pctxt, Previous* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:id=\""), 10);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode change_track_table_cell */

   stat = XmlEnc_Change_track_table_cell (pctxt, &pvalue->
      change_track_table_cell, OSUTF8("change-track-table-cell"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Cell_content_change                                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Cell_content_change (OSCTXT* pctxt,
   Cell_content_change *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode previous */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
      asn1E_Previous (pctxt, &pvalue->previous, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode deletions */

   if (pvalue->m.deletionsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Deletions (pctxt, &pvalue->deletions, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode dependencies */

   if (pvalue->m.dependenciesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Dependencies (pctxt, &pvalue->dependencies, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode change_info */

   if (pvalue->change_info == NULL) {
      rtxErrAddStrParm (pctxt, "pvalue->change_info");
      return LOG_RTERR (pctxt, RTERR_NULLPTR);
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
      asn1E_Ns13_Change_info (pctxt, (Ns13_Change_info*)pvalue->change_info, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode cell_address */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
      asn1E_Cell_address (pctxt, &pvalue->cell_address, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode rejecting_change_id */

   if (pvalue->m.rejecting_change_idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_utf8str (pctxt, pvalue->rejecting_change_id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_utf8str (pctxt, pvalue->id, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode acceptance_state */

   if (pvalue->m.acceptance_statePresent) {
      if(pvalue->acceptance_state < 0 || pvalue->acceptance_state > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Cell_content_change_acceptance_state (pctxt, &pvalue->acceptance_state, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Cell_content_change (OSCTXT* pctxt, Cell_content_change* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.acceptance_statePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:acceptance-state=\""), 24);

      if(pvalue->acceptance_state < 0 || pvalue->acceptance_state > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Cell_content_change_acceptance_state (pctxt, pvalue->
         acceptance_state, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:id=\""), 10);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->id, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.rejecting_change_idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:rejecting-change-id=\""), 27);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->rejecting_change_id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode cell_address */

   stat = XmlEnc_Cell_address (pctxt, &pvalue->cell_address
      , OSUTF8("cell-address"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   /* encode change_info */

   stat = XmlEnc_Ns13_Change_info (pctxt, pvalue->change_info
      , OSUTF8("change-info"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   /* encode dependencies */

   if (pvalue->m.dependenciesPresent) {
      stat = XmlEnc_Dependencies (pctxt, &pvalue->dependencies
         , OSUTF8("dependencies"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode deletions */

   if (pvalue->m.deletionsPresent) {
      stat = XmlEnc_Deletions (pctxt, &pvalue->deletions
         , OSUTF8("deletions"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode previous */

   stat = XmlEnc_Previous (pctxt, &pvalue->previous
      , OSUTF8("previous"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Insertion                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns15_Insertion (OSCTXT* pctxt,
   Ns15_Insertion *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode deletions */

   if (pvalue->m.deletionsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Deletions (pctxt, &pvalue->deletions, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode dependencies */

   if (pvalue->m.dependenciesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Dependencies (pctxt, &pvalue->dependencies, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode change_info */

   if (pvalue->change_info == NULL) {
      rtxErrAddStrParm (pctxt, "pvalue->change_info");
      return LOG_RTERR (pctxt, RTERR_NULLPTR);
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
      asn1E_Ns13_Change_info (pctxt, (Ns13_Change_info*)pvalue->change_info, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode type */

   if(pvalue->type < 0 || pvalue->type > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
      asn1E_Insertion_type (pctxt, &pvalue->type, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode table */

   if (pvalue->m.tablePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         xe_integer (pctxt, &pvalue->table, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode rejecting_change_id */

   if (pvalue->m.rejecting_change_idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->rejecting_change_id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode position */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
      xe_integer (pctxt, &pvalue->position, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode id */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
      xe_utf8str (pctxt, pvalue->id, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode count */

   if (pvalue->m.countPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_unsigned (pctxt, &pvalue->count, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode acceptance_state */

   if (pvalue->m.acceptance_statePresent) {
      if(pvalue->acceptance_state < 0 || pvalue->acceptance_state > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Insertion_acceptance_state (pctxt, &pvalue->acceptance_state, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns15_Insertion (OSCTXT* pctxt, Ns15_Insertion* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.acceptance_statePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:acceptance-state=\""), 24);

      if(pvalue->acceptance_state < 0 || pvalue->acceptance_state > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Insertion_acceptance_state (pctxt, pvalue->acceptance_state
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.countPresent) {
      stat = rtXmlEncUIntAttr
         (pctxt, pvalue->count, OSUTF8("ns15:count"), 10);
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:id=\""), 10);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->id, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   stat = rtXmlEncIntAttr
      (pctxt, pvalue->position, OSUTF8("ns15:position"), 13);

   if (pvalue->m.rejecting_change_idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:rejecting-change-id=\""), 27);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->rejecting_change_id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.tablePresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->table, OSUTF8("ns15:table"), 10);
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:type=\""), 12);

   if(pvalue->type < 0 || pvalue->type > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Insertion_type (pctxt, pvalue->type, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode change_info */

   stat = XmlEnc_Ns13_Change_info (pctxt, pvalue->change_info
      , OSUTF8("change-info"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   /* encode dependencies */

   if (pvalue->m.dependenciesPresent) {
      stat = XmlEnc_Dependencies (pctxt, &pvalue->dependencies
         , OSUTF8("dependencies"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode deletions */

   if (pvalue->m.deletionsPresent) {
      stat = XmlEnc_Deletions (pctxt, &pvalue->deletions
         , OSUTF8("deletions"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Movement_cut_off                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Movement_cut_off (OSCTXT* pctxt,
   Movement_cut_off *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode start_position */

   if (pvalue->m.start_positionPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_integer (pctxt, &pvalue->start_position, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode position */

   if (pvalue->m.positionPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_integer (pctxt, &pvalue->position, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_position */

   if (pvalue->m.end_positionPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_integer (pctxt, &pvalue->end_position, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Movement_cut_off (OSCTXT* pctxt, Movement_cut_off* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.end_positionPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->end_position, OSUTF8("ns15:end-position"), 17);
   }

   if (pvalue->m.positionPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->position, OSUTF8("ns15:position"), 13);
   }

   if (pvalue->m.start_positionPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->start_position, OSUTF8("ns15:start-position"), 19);
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Insertion_cut_off                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Insertion_cut_off (OSCTXT* pctxt,
   Insertion_cut_off *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode position */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_integer (pctxt, &pvalue->position, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode id */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_utf8str (pctxt, pvalue->id, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Insertion_cut_off (OSCTXT* pctxt, Insertion_cut_off* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:id=\""), 10);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->id, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   stat = rtXmlEncIntAttr
      (pctxt, pvalue->position, OSUTF8("ns15:position"), 13);

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Cut_offs_sequence                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Cut_offs_sequence (OSCTXT* pctxt,
   Cut_offs_sequence *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode movement_cut_off_list */

   pnode2 = pvalue->movement_cut_off_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Movement_cut_off (pctxt, ((Movement_cut_off*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode insertion_cut_off */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
      asn1E_Insertion_cut_off (pctxt, &pvalue->insertion_cut_off, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Cut_offs_sequence (OSCTXT* pctxt, Cut_offs_sequence* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode insertion_cut_off */

   stat = XmlEnc_Insertion_cut_off (pctxt, &pvalue->insertion_cut_off
      , OSUTF8("insertion-cut-off"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   /* encode movement_cut_off_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->movement_cut_off_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Movement_cut_off (pctxt, ((Movement_cut_off*)pnode->data)
         , OSUTF8("movement-cut-off"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Cut_offs                                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Cut_offs (OSCTXT* pctxt,
   Cut_offs *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         pnode2 = pvalue->u.movement_cut_off_list->tail;
         while (0 != pnode2) {
            ll = asn1E_Movement_cut_off (pctxt, ((Movement_cut_off*)pnode2->data), ASN1EXPL);
            if (ll < 0) return LOG_RTERR (pctxt, ll);
            ll2 += ll;

            pnode2 = pnode2->prev;
         }
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         else { ll1 += ll; ll2 = 0; }
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Cut_offs_sequence (pctxt, pvalue->u.sequence, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }

   ll1 = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll1);
   if (ll1 < 0) return LOG_RTERR (pctxt, ll1);

   if (tagging == ASN1EXPL) {
      ll1 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll1);
      if (ll1 < 0) return LOG_RTERR (pctxt, ll1);
   }

   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Cut_offs (OSCTXT* pctxt, Cut_offs* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode movement_cut_off_list */

         { const OSUTF8CHAR* savedPrefix = nsPrefix;
         nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
            "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

         { OSRTDListNode* pnode = pvalue->u.movement_cut_off_list->head;
         while (0 != pnode) {
            stat = XmlEnc_Movement_cut_off (pctxt, 
               ((Movement_cut_off*)pnode->data)
               , OSUTF8("movement-cut-off"), nsPrefix);
            if (stat != 0) return LOG_RTERR (pctxt, stat);
            pnode = pnode->next;
         }}
         nsPrefix = savedPrefix;
         }

         break;

      case 2:
         /* encode sequence */

         stat = XmlEnc_Cut_offs_sequence (pctxt, pvalue->u.sequence
            , OSUTF8(""), 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Deletion                                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns15_Deletion (OSCTXT* pctxt,
   Ns15_Deletion *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode cut_offs */

   if (pvalue->m.cut_offsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Cut_offs (pctxt, &pvalue->cut_offs, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode deletions */

   if (pvalue->m.deletionsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Deletions (pctxt, &pvalue->deletions, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode dependencies */

   if (pvalue->m.dependenciesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Dependencies (pctxt, &pvalue->dependencies, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode change_info */

   if (pvalue->change_info == NULL) {
      rtxErrAddStrParm (pctxt, "pvalue->change_info");
      return LOG_RTERR (pctxt, RTERR_NULLPTR);
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
      asn1E_Ns13_Change_info (pctxt, (Ns13_Change_info*)pvalue->change_info, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode type */

   if(pvalue->type < 0 || pvalue->type > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
      asn1E_Deletion_type (pctxt, &pvalue->type, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode table */

   if (pvalue->m.tablePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         xe_integer (pctxt, &pvalue->table, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode rejecting_change_id */

   if (pvalue->m.rejecting_change_idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->rejecting_change_id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode position */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
      xe_integer (pctxt, &pvalue->position, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode multi_deletion_spanned */

   if (pvalue->m.multi_deletion_spannedPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_integer (pctxt, &pvalue->multi_deletion_spanned, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_utf8str (pctxt, pvalue->id, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode acceptance_state */

   if (pvalue->m.acceptance_statePresent) {
      if(pvalue->acceptance_state < 0 || pvalue->acceptance_state > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Deletion_acceptance_state (pctxt, &pvalue->acceptance_state, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns15_Deletion (OSCTXT* pctxt, Ns15_Deletion* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.acceptance_statePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:acceptance-state=\""), 24);

      if(pvalue->acceptance_state < 0 || pvalue->acceptance_state > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Deletion_acceptance_state (pctxt, pvalue->acceptance_state
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:id=\""), 10);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->id, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.multi_deletion_spannedPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->multi_deletion_spanned
            , OSUTF8("ns15:multi-deletion-spanned"), 27);
   }

   stat = rtXmlEncIntAttr
      (pctxt, pvalue->position, OSUTF8("ns15:position"), 13);

   if (pvalue->m.rejecting_change_idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:rejecting-change-id=\""), 27);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->rejecting_change_id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.tablePresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->table, OSUTF8("ns15:table"), 10);
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:type=\""), 12);

   if(pvalue->type < 0 || pvalue->type > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Deletion_type (pctxt, pvalue->type, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode change_info */

   stat = XmlEnc_Ns13_Change_info (pctxt, pvalue->change_info
      , OSUTF8("change-info"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   /* encode dependencies */

   if (pvalue->m.dependenciesPresent) {
      stat = XmlEnc_Dependencies (pctxt, &pvalue->dependencies
         , OSUTF8("dependencies"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode deletions */

   if (pvalue->m.deletionsPresent) {
      stat = XmlEnc_Deletions (pctxt, &pvalue->deletions
         , OSUTF8("deletions"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode cut_offs */

   if (pvalue->m.cut_offsPresent) {
      stat = XmlEnc_Cut_offs (pctxt, &pvalue->cut_offs
         , OSUTF8("cut-offs"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Source_range_address                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Source_range_address (OSCTXT* pctxt,
   Source_range_address *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode table */

   if (pvalue->m.tablePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         xe_integer (pctxt, &pvalue->table, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode start_table */

   if (pvalue->m.start_tablePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         xe_integer (pctxt, &pvalue->start_table, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode start_row */

   if (pvalue->m.start_rowPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         xe_integer (pctxt, &pvalue->start_row, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode start_column */

   if (pvalue->m.start_columnPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         xe_integer (pctxt, &pvalue->start_column, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode row */

   if (pvalue->m.rowPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_integer (pctxt, &pvalue->row, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_table */

   if (pvalue->m.end_tablePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_integer (pctxt, &pvalue->end_table, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_row */

   if (pvalue->m.end_rowPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_integer (pctxt, &pvalue->end_row, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_column */

   if (pvalue->m.end_columnPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_integer (pctxt, &pvalue->end_column, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode column */

   if (pvalue->m.columnPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_integer (pctxt, &pvalue->column, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Source_range_address (OSCTXT* pctxt, Source_range_address* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.columnPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->column, OSUTF8("ns15:column"), 11);
   }

   if (pvalue->m.end_columnPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->end_column, OSUTF8("ns15:end-column"), 15);
   }

   if (pvalue->m.end_rowPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->end_row, OSUTF8("ns15:end-row"), 12);
   }

   if (pvalue->m.end_tablePresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->end_table, OSUTF8("ns15:end-table"), 14);
   }

   if (pvalue->m.rowPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->row, OSUTF8("ns15:row"), 8);
   }

   if (pvalue->m.start_columnPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->start_column, OSUTF8("ns15:start-column"), 17);
   }

   if (pvalue->m.start_rowPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->start_row, OSUTF8("ns15:start-row"), 14);
   }

   if (pvalue->m.start_tablePresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->start_table, OSUTF8("ns15:start-table"), 16);
   }

   if (pvalue->m.tablePresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->table, OSUTF8("ns15:table"), 10);
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Target_range_address                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Target_range_address (OSCTXT* pctxt,
   Target_range_address *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode table */

   if (pvalue->m.tablePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         xe_integer (pctxt, &pvalue->table, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode start_table */

   if (pvalue->m.start_tablePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         xe_integer (pctxt, &pvalue->start_table, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode start_row */

   if (pvalue->m.start_rowPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         xe_integer (pctxt, &pvalue->start_row, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode start_column */

   if (pvalue->m.start_columnPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         xe_integer (pctxt, &pvalue->start_column, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode row */

   if (pvalue->m.rowPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_integer (pctxt, &pvalue->row, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_table */

   if (pvalue->m.end_tablePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_integer (pctxt, &pvalue->end_table, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_row */

   if (pvalue->m.end_rowPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_integer (pctxt, &pvalue->end_row, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_column */

   if (pvalue->m.end_columnPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_integer (pctxt, &pvalue->end_column, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode column */

   if (pvalue->m.columnPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_integer (pctxt, &pvalue->column, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Target_range_address (OSCTXT* pctxt, Target_range_address* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.columnPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->column, OSUTF8("ns15:column"), 11);
   }

   if (pvalue->m.end_columnPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->end_column, OSUTF8("ns15:end-column"), 15);
   }

   if (pvalue->m.end_rowPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->end_row, OSUTF8("ns15:end-row"), 12);
   }

   if (pvalue->m.end_tablePresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->end_table, OSUTF8("ns15:end-table"), 14);
   }

   if (pvalue->m.rowPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->row, OSUTF8("ns15:row"), 8);
   }

   if (pvalue->m.start_columnPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->start_column, OSUTF8("ns15:start-column"), 17);
   }

   if (pvalue->m.start_rowPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->start_row, OSUTF8("ns15:start-row"), 14);
   }

   if (pvalue->m.start_tablePresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->start_table, OSUTF8("ns15:start-table"), 16);
   }

   if (pvalue->m.tablePresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->table, OSUTF8("ns15:table"), 10);
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Movement                                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Movement (OSCTXT* pctxt,
   Movement *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode deletions */

   if (pvalue->m.deletionsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Deletions (pctxt, &pvalue->deletions, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode dependencies */

   if (pvalue->m.dependenciesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Dependencies (pctxt, &pvalue->dependencies, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode change_info */

   if (pvalue->change_info == NULL) {
      rtxErrAddStrParm (pctxt, "pvalue->change_info");
      return LOG_RTERR (pctxt, RTERR_NULLPTR);
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
      asn1E_Ns13_Change_info (pctxt, (Ns13_Change_info*)pvalue->change_info, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode target_range_address */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
      asn1E_Target_range_address (pctxt, &pvalue->target_range_address, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode source_range_address */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
      asn1E_Source_range_address (pctxt, &pvalue->source_range_address, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode rejecting_change_id */

   if (pvalue->m.rejecting_change_idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_utf8str (pctxt, pvalue->rejecting_change_id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_utf8str (pctxt, pvalue->id, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode acceptance_state */

   if (pvalue->m.acceptance_statePresent) {
      if(pvalue->acceptance_state < 0 || pvalue->acceptance_state > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Movement_acceptance_state (pctxt, &pvalue->acceptance_state, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Movement (OSCTXT* pctxt, Movement* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.acceptance_statePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:acceptance-state=\""), 24);

      if(pvalue->acceptance_state < 0 || pvalue->acceptance_state > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Movement_acceptance_state (pctxt, pvalue->acceptance_state
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:id=\""), 10);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->id, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.rejecting_change_idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:rejecting-change-id=\""), 27);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->rejecting_change_id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode source_range_address */

   stat = XmlEnc_Source_range_address (pctxt, &pvalue->source_range_address
      , OSUTF8("source-range-address"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   /* encode target_range_address */

   stat = XmlEnc_Target_range_address (pctxt, &pvalue->target_range_address
      , OSUTF8("target-range-address"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   /* encode change_info */

   stat = XmlEnc_Ns13_Change_info (pctxt, pvalue->change_info
      , OSUTF8("change-info"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   /* encode dependencies */

   if (pvalue->m.dependenciesPresent) {
      stat = XmlEnc_Dependencies (pctxt, &pvalue->dependencies
         , OSUTF8("dependencies"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode deletions */

   if (pvalue->m.deletionsPresent) {
      stat = XmlEnc_Deletions (pctxt, &pvalue->deletions
         , OSUTF8("deletions"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Tracked_changes_element                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Tracked_changes_element (OSCTXT* pctxt,
   Tracked_changes_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Cell_content_change (pctxt, pvalue->u.cell_content_change, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Ns15_Insertion (pctxt, pvalue->u.insertion, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Ns15_Deletion (pctxt, pvalue->u.deletion, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Movement (pctxt, pvalue->u.movement, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Tracked_changes_element (OSCTXT* pctxt, 
   Tracked_changes_element* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode cell_content_change */

         stat = XmlEnc_Cell_content_change (pctxt, pvalue->
            u.cell_content_change, OSUTF8("cell-content-change"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode insertion */

         stat = XmlEnc_Ns15_Insertion (pctxt, pvalue->u.insertion
            , OSUTF8("insertion"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode deletion */

         stat = XmlEnc_Ns15_Deletion (pctxt, pvalue->u.deletion
            , OSUTF8("deletion"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode movement */

         stat = XmlEnc_Movement (pctxt, pvalue->u.movement
            , OSUTF8("movement"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Tracked_changes                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns15_Tracked_changes (OSCTXT* pctxt,
   Ns15_Tracked_changes *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Tracked_changes_element (pctxt, ((Tracked_changes_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode track_changes */

   if (pvalue->m.track_changesPresent) {
      if(pvalue->track_changes < 0 || pvalue->track_changes > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns15_Tracked_changes_track_changes (pctxt, &pvalue->track_changes, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns15_Tracked_changes (OSCTXT* pctxt, Ns15_Tracked_changes* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.track_changesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:track-changes=\""), 21);

      if(pvalue->track_changes < 0 || pvalue->track_changes > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns15_Tracked_changes_track_changes (pctxt, pvalue->
         track_changes, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Tracked_changes_element (pctxt, 
         ((Tracked_changes_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

int XmlEnc_Ns15_Tracked_changes_PDU (OSCTXT* pctxt, Ns15_Tracked_changes* pvalue)
{
   int stat;
   const OSUTF8CHAR* nsPrefix = 0;

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns1"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns2"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:config:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns3"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("xlink"), 
      OSUTF8("http://www.w3.org/1999/xlink"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns4"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:form:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns5"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:chart:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns6"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:script:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns7"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns8"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:style:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns9"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:animation:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns10"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:presentation:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns11"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:smil-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("xforms"), 
      OSUTF8("http://www.w3.org/2002/xforms"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns12"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns13"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:office:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns14"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns15"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:table:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("mathml"), 
      OSUTF8("http://www.w3.org/1998/Math/MathML"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns17"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:text:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns16"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:meta:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("elements"), 
      OSUTF8("http://purl.org/dc/elements/1.1/"), FALSE);

   nsPrefix = rtXmlNSGetPrefix (pctxt, 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:table:1.0"));

   stat = rtXmlEncStartDocument (pctxt);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncStartElement (pctxt, OSUTF8("tracked-changes"), nsPrefix, FALSE);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncNSAttrs (pctxt);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncXSIAttrs (pctxt, FALSE);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = XmlEnc_Ns15_Tracked_changes (pctxt, pvalue, 0, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncEndElement (pctxt, OSUTF8("tracked-changes"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return stat;
}
