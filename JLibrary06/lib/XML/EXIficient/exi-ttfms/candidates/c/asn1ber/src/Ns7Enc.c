/**
 * This file was generated by the Objective Systems ASN1C Compiler
 * (http://www.obj-sys.com).  Version: 6.0B, Date: 18-Oct-2006.
 */
#include "Ns7.h"
#include "Ns12.h"
#include "Ns3.h"
#include "Ns10.h"
#include "Ns15.h"
#include "Odf.h"
#include "rtxsrc/rtxCommon.h"

/**************************************************************/
/*                                                            */
/*  Ambient_color                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Ambient_color (OSCTXT* pctxt,
   Ns7_Ambient_color pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns7_Ambient_color (OSCTXT* pctxt, Ns7_Ambient_color value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Distance                                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Distance (OSCTXT* pctxt,
   Ns7_Distance pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns7_Distance (OSCTXT* pctxt, Ns7_Distance value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Focal_length                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Focal_length (OSCTXT* pctxt,
   Ns7_Focal_length pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns7_Focal_length (OSCTXT* pctxt, Ns7_Focal_length value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Lighting_mode                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Lighting_mode (OSCTXT* pctxt,
   Ns7_Lighting_mode *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns7_Lighting_mode (OSCTXT* pctxt, Ns7_Lighting_mode value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns7_Lighting_mode_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Projection                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Projection (OSCTXT* pctxt,
   Ns7_Projection *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns7_Projection (OSCTXT* pctxt, Ns7_Projection value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns7_Projection_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Shade_mode                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Shade_mode (OSCTXT* pctxt,
   Ns7_Shade_mode *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 3)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns7_Shade_mode (OSCTXT* pctxt, Ns7_Shade_mode value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns7_Shade_mode_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Shadow_slant                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Shadow_slant (OSCTXT* pctxt,
   Ns7_Shadow_slant *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_unsigned (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns7_Shadow_slant (OSCTXT* pctxt, Ns7_Shadow_slant value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUInt (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Transform                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Transform (OSCTXT* pctxt,
   Ns7_Transform pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns7_Transform (OSCTXT* pctxt, Ns7_Transform value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Vpn                                                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Vpn (OSCTXT* pctxt,
   Ns7_Vpn pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns7_Vpn (OSCTXT* pctxt, Ns7_Vpn value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Vrp                                                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Vrp (OSCTXT* pctxt,
   Ns7_Vrp pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns7_Vrp (OSCTXT* pctxt, Ns7_Vrp value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Vup                                                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Vup (OSCTXT* pctxt,
   Ns7_Vup pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns7_Vup (OSCTXT* pctxt, Ns7_Vup value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Light_enabled                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Light_enabled (OSCTXT* pctxt,
   Ns7_Light_enabled *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns7_Light_enabled (OSCTXT* pctxt, Ns7_Light_enabled value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns7_Light_enabled_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Light_specular                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Light_specular (OSCTXT* pctxt,
   Ns7_Light_specular *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns7_Light_specular (OSCTXT* pctxt, Ns7_Light_specular value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns7_Light_specular_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Light                                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Light (OSCTXT* pctxt,
   Ns7_Light *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode specular */

   if (pvalue->m.specularPresent) {
      if(pvalue->specular < 0 || pvalue->specular > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns7_Light_specular (pctxt, &pvalue->specular, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode enabled */

   if (pvalue->m.enabledPresent) {
      if(pvalue->enabled < 0 || pvalue->enabled > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns7_Light_enabled (pctxt, &pvalue->enabled, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode direction */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_utf8str (pctxt, pvalue->direction, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode diffuse_color */

   if (pvalue->m.diffuse_colorPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->diffuse_color, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns7_Light (OSCTXT* pctxt, Ns7_Light* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.diffuse_colorPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:diffuse-color=\""), 20);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->diffuse_color, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:direction=\""), 16);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->direction, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.enabledPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:enabled=\""), 14);

      if(pvalue->enabled < 0 || pvalue->enabled > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns7_Light_enabled (pctxt, pvalue->enabled, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.specularPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:specular=\""), 15);

      if(pvalue->specular < 0 || pvalue->specular > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns7_Light_specular (pctxt, pvalue->specular, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Extrude                                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Extrude (OSCTXT* pctxt,
   Ns7_Extrude *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode viewBox */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
      asn1E_ViewBox (pctxt, (ViewBox*)&pvalue->viewBox, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode d */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
      asn1E_D (pctxt, (D)pvalue->d, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      if (pvalue->style_name_1 == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->style_name_1");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Ns3_Style_name (pctxt, (Ns3_Style_name*)pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Ns3_Class_names (pctxt, (Ns3_Class_names*)&pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns3_Z_index (pctxt, (Ns3_Z_index*)&pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      if (pvalue->style_name == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->style_name");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
         asn1E_Ns3_Style_name (pctxt, (Ns3_Style_name*)pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns3_Layer_1 (pctxt, (Ns3_Layer_1)pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Id (pctxt, (Ns3_Id)pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
         asn1E_Ns3_Class_names (pctxt, (Ns3_Class_names*)&pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns7_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns7_Extrude (OSCTXT* pctxt, Ns7_Extrude* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:transform=\""), 16);

      stat = XmlEnc_Ns7_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:d=\""), 9);

   stat = XmlEnc_D (pctxt, pvalue->d, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:viewBox=\""), 15);

   stat = XmlEnc_ViewBox (pctxt, &pvalue->viewBox, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Sphere                                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Sphere (OSCTXT* pctxt,
   Ns7_Sphere *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      if (pvalue->style_name_1 == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->style_name_1");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Ns3_Style_name (pctxt, (Ns3_Style_name*)pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Ns3_Class_names (pctxt, (Ns3_Class_names*)&pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Ns3_Z_index (pctxt, (Ns3_Z_index*)&pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      if (pvalue->style_name == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->style_name");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Ns3_Style_name (pctxt, (Ns3_Style_name*)pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns3_Layer_1 (pctxt, (Ns3_Layer_1)pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns3_Id (pctxt, (Ns3_Id)pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
         asn1E_Ns3_Class_names (pctxt, (Ns3_Class_names*)&pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns7_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode size */

   if (pvalue->m.sizePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->size, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode center */

   if (pvalue->m.centerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->center, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns7_Sphere (OSCTXT* pctxt, Ns7_Sphere* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.centerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:center=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->center, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.sizePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:size=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->size, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:transform=\""), 16);

      stat = XmlEnc_Ns7_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Rotate                                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Rotate (OSCTXT* pctxt,
   Ns7_Rotate *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode viewBox */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
      asn1E_ViewBox (pctxt, (ViewBox*)&pvalue->viewBox, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode d */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
      asn1E_D (pctxt, (D)pvalue->d, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      if (pvalue->style_name_1 == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->style_name_1");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Ns3_Style_name (pctxt, (Ns3_Style_name*)pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Ns3_Class_names (pctxt, (Ns3_Class_names*)&pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns3_Z_index (pctxt, (Ns3_Z_index*)&pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      if (pvalue->style_name == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->style_name");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
         asn1E_Ns3_Style_name (pctxt, (Ns3_Style_name*)pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns3_Layer_1 (pctxt, (Ns3_Layer_1)pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Id (pctxt, (Ns3_Id)pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
         asn1E_Ns3_Class_names (pctxt, (Ns3_Class_names*)&pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns7_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns7_Rotate (OSCTXT* pctxt, Ns7_Rotate* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:transform=\""), 16);

      stat = XmlEnc_Ns7_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:d=\""), 9);

   stat = XmlEnc_D (pctxt, pvalue->d, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:viewBox=\""), 15);

   stat = XmlEnc_ViewBox (pctxt, &pvalue->viewBox, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Cube                                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Cube (OSCTXT* pctxt,
   Ns7_Cube *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      if (pvalue->style_name_1 == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->style_name_1");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Ns3_Style_name (pctxt, (Ns3_Style_name*)pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Ns3_Class_names (pctxt, (Ns3_Class_names*)&pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Ns3_Z_index (pctxt, (Ns3_Z_index*)&pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      if (pvalue->style_name == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->style_name");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Ns3_Style_name (pctxt, (Ns3_Style_name*)pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns3_Layer_1 (pctxt, (Ns3_Layer_1)pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns3_Id (pctxt, (Ns3_Id)pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
         asn1E_Ns3_Class_names (pctxt, (Ns3_Class_names*)&pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns7_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode min_edge */

   if (pvalue->m.min_edgePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->min_edge, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode max_edge */

   if (pvalue->m.max_edgePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->max_edge, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns7_Cube (OSCTXT* pctxt, Ns7_Cube* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.max_edgePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:max-edge=\""), 15);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->max_edge, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.min_edgePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:min-edge=\""), 15);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->min_edge, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:transform=\""), 16);

      stat = XmlEnc_Ns7_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Scene_element                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Scene_element (OSCTXT* pctxt,
   Ns7_Scene_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Ns7_Scene (pctxt, (Ns7_Scene*)pvalue->u.scene, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Ns7_Extrude (pctxt, pvalue->u.extrude, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Ns7_Sphere (pctxt, pvalue->u.sphere, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Ns7_Rotate (pctxt, pvalue->u.rotate, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
            asn1E_Ns7_Cube (pctxt, pvalue->u.cube, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns7_Scene_element (OSCTXT* pctxt, Ns7_Scene_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode scene */

         stat = XmlEnc_Ns7_Scene (pctxt, pvalue->u.scene
            , OSUTF8("scene"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode extrude */

         stat = XmlEnc_Ns7_Extrude (pctxt, pvalue->u.extrude
            , OSUTF8("extrude"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode sphere */

         stat = XmlEnc_Ns7_Sphere (pctxt, pvalue->u.sphere
            , OSUTF8("sphere"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode rotate */

         stat = XmlEnc_Ns7_Rotate (pctxt, pvalue->u.rotate
            , OSUTF8("rotate"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode cube */

         stat = XmlEnc_Ns7_Cube (pctxt, pvalue->u.cube
            , OSUTF8("cube"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Scene                                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns7_Scene (OSCTXT* pctxt,
   Ns7_Scene *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns7_Scene_element (pctxt, ((Ns7_Scene_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|29, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode light_list */

   pnode2 = pvalue->light_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns7_Light (pctxt, ((Ns7_Light*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|28, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|27,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|26,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|25,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|24,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|23,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|22,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|21,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x */

   if (pvalue->m.xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|20,
         xe_utf8str (pctxt, pvalue->x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      if (pvalue->style_name_1 == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->style_name_1");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|17,
         asn1E_Ns3_Style_name (pctxt, (Ns3_Style_name*)pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|16,
         asn1E_Ns3_Class_names (pctxt, (Ns3_Class_names*)&pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|15,
         asn1E_Ns3_Z_index (pctxt, (Ns3_Z_index*)&pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      if (pvalue->style_name == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->style_name");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|14,
         asn1E_Ns3_Style_name (pctxt, (Ns3_Style_name*)pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         asn1E_Ns3_Layer_1 (pctxt, (Ns3_Layer_1)pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|12,
         asn1E_Ns3_Id (pctxt, (Ns3_Id)pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
         asn1E_Ns3_Class_names (pctxt, (Ns3_Class_names*)&pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode vup */

   if (pvalue->m.vupPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
         asn1E_Ns7_Vup (pctxt, pvalue->vup, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode vrp */

   if (pvalue->m.vrpPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         asn1E_Ns7_Vrp (pctxt, pvalue->vrp, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode vpn */

   if (pvalue->m.vpnPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         asn1E_Ns7_Vpn (pctxt, pvalue->vpn, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Ns7_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode shadow_slant */

   if (pvalue->m.shadow_slantPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         asn1E_Ns7_Shadow_slant (pctxt, &pvalue->shadow_slant, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode shade_mode */

   if (pvalue->m.shade_modePresent) {
      if(pvalue->shade_mode < 0 || pvalue->shade_mode > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns7_Shade_mode (pctxt, &pvalue->shade_mode, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode projection */

   if (pvalue->m.projectionPresent) {
      if(pvalue->projection < 0 || pvalue->projection > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns7_Projection (pctxt, &pvalue->projection, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode lighting_mode */

   if (pvalue->m.lighting_modePresent) {
      if(pvalue->lighting_mode < 0 || pvalue->lighting_mode > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns7_Lighting_mode (pctxt, &pvalue->lighting_mode, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode focal_length */

   if (pvalue->m.focal_lengthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns7_Focal_length (pctxt, pvalue->focal_length, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode distance */

   if (pvalue->m.distancePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns7_Distance (pctxt, pvalue->distance, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode ambient_color */

   if (pvalue->m.ambient_colorPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns7_Ambient_color (pctxt, pvalue->ambient_color, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns7_Scene (OSCTXT* pctxt, Ns7_Scene* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.ambient_colorPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:ambient-color=\""), 20);

      stat = XmlEnc_Ns7_Ambient_color (pctxt, pvalue->ambient_color, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.distancePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:distance=\""), 15);

      stat = XmlEnc_Ns7_Distance (pctxt, pvalue->distance, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.focal_lengthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:focal-length=\""), 19);

      stat = XmlEnc_Ns7_Focal_length (pctxt, pvalue->focal_length, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.lighting_modePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:lighting-mode=\""), 20);

      if(pvalue->lighting_mode < 0 || pvalue->lighting_mode > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns7_Lighting_mode (pctxt, pvalue->lighting_mode, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.projectionPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:projection=\""), 17);

      if(pvalue->projection < 0 || pvalue->projection > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns7_Projection (pctxt, pvalue->projection, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.shade_modePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:shade-mode=\""), 17);

      if(pvalue->shade_mode < 0 || pvalue->shade_mode > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns7_Shade_mode (pctxt, pvalue->shade_mode, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.shadow_slantPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:shadow-slant=\""), 19);

      stat = XmlEnc_Ns7_Shadow_slant (pctxt, pvalue->shadow_slant, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:transform=\""), 16);

      stat = XmlEnc_Ns7_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.vpnPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:vpn=\""), 10);

      stat = XmlEnc_Ns7_Vpn (pctxt, pvalue->vpn, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.vrpPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:vrp=\""), 10);

      stat = XmlEnc_Ns7_Vrp (pctxt, pvalue->vrp, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.vupPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:vup=\""), 10);

      stat = XmlEnc_Ns7_Vup (pctxt, pvalue->vup, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"));

   /* encode light_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"));

   { OSRTDListNode* pnode = pvalue->light_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns7_Light (pctxt, ((Ns7_Light*)pnode->data)
         , OSUTF8("light"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns7_Scene_element (pctxt, ((Ns7_Scene_element*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

