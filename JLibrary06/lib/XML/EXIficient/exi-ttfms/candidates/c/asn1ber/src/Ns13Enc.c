/**
 * This file was generated by the Objective Systems ASN1C Compiler
 * (http://www.obj-sys.com).  Version: 6.0B, Date: 18-Oct-2006.
 */
#include "Ns13.h"
#include "Ns10.h"
#include "Odf.h"
#include "Ns3.h"
#include "Ns15.h"
#include "Ns4.h"
#include "Xforms.h"
#include "Ns8.h"
#include "Ns14.h"
#include "Ns12.h"
#include "Ns7.h"
#include "Ns5.h"
#include "rtxsrc/rtxCommon.h"

/**************************************************************/
/*                                                            */
/*  Binary_data                                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Binary_data (OSCTXT* pctxt,
   Ns13_Binary_data *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_octstr (pctxt, pvalue->data, pvalue->numocts, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Binary_data (OSCTXT* pctxt, Ns13_Binary_data* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncBase64Binary
      (pctxt, pvalue->numocts, pvalue->data, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Name                                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Name (OSCTXT* pctxt,
   Ns13_Name pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Name (OSCTXT* pctxt, Ns13_Name value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Target_frame_name_alt_1                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Target_frame_name_alt_1 (OSCTXT* pctxt,
   Ns13_Target_frame_name_alt_1 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Target_frame_name_alt_1 (OSCTXT* pctxt, 
   Ns13_Target_frame_name_alt_1 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns13_Target_frame_name_alt_1_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Target_frame_name_alt_2                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Target_frame_name_alt_2 (OSCTXT* pctxt,
   Ns13_Target_frame_name_alt_2 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Target_frame_name_alt_2 (OSCTXT* pctxt, 
   Ns13_Target_frame_name_alt_2 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns13_Target_frame_name_alt_2_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Target_frame_name_alt_3                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Target_frame_name_alt_3 (OSCTXT* pctxt,
   Ns13_Target_frame_name_alt_3 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Target_frame_name_alt_3 (OSCTXT* pctxt, 
   Ns13_Target_frame_name_alt_3 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns13_Target_frame_name_alt_3_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Target_frame_name_alt_4                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Target_frame_name_alt_4 (OSCTXT* pctxt,
   Ns13_Target_frame_name_alt_4 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Target_frame_name_alt_4 (OSCTXT* pctxt, 
   Ns13_Target_frame_name_alt_4 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns13_Target_frame_name_alt_4_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Target_frame_name                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Target_frame_name (OSCTXT* pctxt,
   Ns13_Target_frame_name *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            asn1E_Ns13_Target_frame_name_alt_1 (pctxt, &pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
            asn1E_Ns13_Target_frame_name_alt_2 (pctxt, &pvalue->u.alt_2, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         if(pvalue->u.alt_3 < 0 || pvalue->u.alt_3 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
            asn1E_Ns13_Target_frame_name_alt_3 (pctxt, &pvalue->u.alt_3, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         if(pvalue->u.alt_4 < 0 || pvalue->u.alt_4 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
            asn1E_Ns13_Target_frame_name_alt_4 (pctxt, &pvalue->u.alt_4, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns13_Target_frame_name (OSCTXT* pctxt, 
   Ns13_Target_frame_name* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Ns13_Target_frame_name_alt_1 (pctxt, pvalue->u.alt_1
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode alt_2 */

         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Ns13_Target_frame_name_alt_2 (pctxt, pvalue->u.alt_2
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode alt_3 */

         if(pvalue->u.alt_3 < 0 || pvalue->u.alt_3 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Ns13_Target_frame_name_alt_3 (pctxt, pvalue->u.alt_3
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode alt_4 */

         if(pvalue->u.alt_4 < 0 || pvalue->u.alt_4 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Ns13_Target_frame_name_alt_4 (pctxt, pvalue->u.alt_4
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Event_listeners_element                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Event_listeners_element (OSCTXT* pctxt,
   Ns13_Event_listeners_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Ns10_Event_listener (pctxt, (Ns10_Event_listener*)pvalue->u.event_listener, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Ns10_Event_listener (pctxt, (Ns10_Event_listener*)pvalue->u.event_listener_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns13_Event_listeners_element (OSCTXT* pctxt, 
   Ns13_Event_listeners_element* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode event_listener */

         stat = XmlEnc_Ns10_Event_listener (pctxt, pvalue->u.event_listener
            , OSUTF8("event-listener"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode event_listener_1 */

         stat = XmlEnc_Ns10_Event_listener (pctxt, pvalue->u.event_listener_1
            , OSUTF8("event-listener"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Event_listeners                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Event_listeners (OSCTXT* pctxt,
   Ns13_Event_listeners *pvalue, ASN1TagType tagging)
{
   OSRTDListNode* pnode1;
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   pnode1 = pvalue->tail;
   while (0 != pnode1) {
      ll = asn1E_Ns13_Event_listeners_element (pctxt, ((Ns13_Event_listeners_element*)pnode1->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;

      pnode1 = pnode1->prev;
   }
   ll1 = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll1);
   if (ll1 < 0) return LOG_RTERR (pctxt, ll1);

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Event_listeners (OSCTXT* pctxt, Ns13_Event_listeners* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (elemName != 0) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->head;
   while (0 != pnode) {
      stat = XmlEnc_Ns13_Event_listeners_element (pctxt, 
         ((Ns13_Event_listeners_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Annotation_display                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Annotation_display (OSCTXT* pctxt,
   Ns13_Annotation_display *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Annotation_display (OSCTXT* pctxt, 
   Ns13_Annotation_display value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns13_Annotation_display_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Annotation_element                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Annotation_element (OSCTXT* pctxt,
   Ns13_Annotation_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns13_Annotation_element (OSCTXT* pctxt, 
   Ns13_Annotation_element* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Annotation                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Annotation (OSCTXT* pctxt,
   Ns13_Annotation *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns13_Annotation_element (pctxt, ((Ns13_Annotation_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|27, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode date_string */

   if (pvalue->m.date_stringPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|26,
         asn1E_Date_string (pctxt, pvalue->date_string, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode date */

   if (pvalue->m.datePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|25,
         asn1E_Elements_Date (pctxt, pvalue->date, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode creator */

   if (pvalue->m.creatorPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|24,
         asn1E_Creator (pctxt, pvalue->creator, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|23,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|22,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|21,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|20,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|17,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x */

   if (pvalue->m.xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|16,
         xe_utf8str (pctxt, pvalue->x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|15,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|14,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      if (pvalue->style_name_1 == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->style_name_1");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
         asn1E_Ns3_Style_name (pctxt, (Ns3_Style_name*)pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
         asn1E_Ns3_Class_names (pctxt, (Ns3_Class_names*)&pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode display */

   if (pvalue->m.displayPresent) {
      if(pvalue->display < 0 || pvalue->display > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
         asn1E_Ns13_Annotation_display (pctxt, &pvalue->display, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
         asn1E_Ns3_Z_index (pctxt, (Ns3_Z_index*)&pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         asn1E_Ns3_Transform (pctxt, (Ns3_Transform)pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_style_name */

   if (pvalue->m.text_style_namePresent) {
      if (pvalue->text_style_name == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->text_style_name");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Ns3_Text_style_name (pctxt, (Ns3_Text_style_name*)pvalue->text_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      if (pvalue->style_name == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->style_name");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Ns3_Style_name (pctxt, (Ns3_Style_name*)pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns3_Layer_1 (pctxt, (Ns3_Layer_1)pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns3_Id (pctxt, (Ns3_Id)pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode corner_radius */

   if (pvalue->m.corner_radiusPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns3_Corner_radius (pctxt, (Ns3_Corner_radius)pvalue->corner_radius, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Ns3_Class_names (pctxt, (Ns3_Class_names*)&pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode caption_point_y */

   if (pvalue->m.caption_point_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns3_Caption_point_y (pctxt, (Ns3_Caption_point_y)pvalue->caption_point_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode caption_point_x */

   if (pvalue->m.caption_point_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns3_Caption_point_x (pctxt, (Ns3_Caption_point_x)pvalue->caption_point_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Annotation (OSCTXT* pctxt, Ns13_Annotation* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.caption_point_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:caption-point-x=\""), 22);

      stat = XmlEnc_Ns3_Caption_point_x (pctxt, pvalue->caption_point_x
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.caption_point_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:caption-point-y=\""), 22);

      stat = XmlEnc_Ns3_Caption_point_y (pctxt, pvalue->caption_point_y
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.corner_radiusPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:corner-radius=\""), 20);

      stat = XmlEnc_Ns3_Corner_radius (pctxt, pvalue->corner_radius, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-style-name=\""), 22);

      stat = XmlEnc_Ns3_Text_style_name (pctxt, pvalue->text_style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:transform=\""), 16);

      stat = XmlEnc_Ns3_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.displayPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:display=\""), 15);

      if(pvalue->display < 0 || pvalue->display > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns13_Annotation_display (pctxt, pvalue->display, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode creator */

   if (pvalue->m.creatorPresent) {
      stat = XmlEnc_Creator (pctxt, pvalue->creator
         , OSUTF8("creator"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode date */

   if (pvalue->m.datePresent) {
      stat = XmlEnc_Elements_Date (pctxt, pvalue->date
         , OSUTF8("date"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode date_string */

   if (pvalue->m.date_stringPresent) {
      stat = XmlEnc_Date_string (pctxt, pvalue->date_string
         , OSUTF8("date-string"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns13_Annotation_element (pctxt, 
         ((Ns13_Annotation_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Automatic_update                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Automatic_update (OSCTXT* pctxt,
   Ns13_Automatic_update *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Automatic_update (OSCTXT* pctxt, Ns13_Automatic_update value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns13_Automatic_update_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Dde_source_conversion_mode                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Dde_source_conversion_mode (OSCTXT* pctxt,
   Ns13_Dde_source_conversion_mode *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Dde_source_conversion_mode (OSCTXT* pctxt, 
   Ns13_Dde_source_conversion_mode value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns13_Dde_source_conversion_mode_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Dde_application                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Dde_application (OSCTXT* pctxt,
   Ns13_Dde_application pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Dde_application (OSCTXT* pctxt, Ns13_Dde_application value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Dde_item                                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Dde_item (OSCTXT* pctxt,
   Ns13_Dde_item pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Dde_item (OSCTXT* pctxt, Ns13_Dde_item value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Dde_topic                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Dde_topic (OSCTXT* pctxt,
   Ns13_Dde_topic pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Dde_topic (OSCTXT* pctxt, Ns13_Dde_topic value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Dde_source                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Dde_source (OSCTXT* pctxt,
   Ns13_Dde_source *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns13_Name (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode dde_topic */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
      asn1E_Ns13_Dde_topic (pctxt, pvalue->dde_topic, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode dde_item */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
      asn1E_Ns13_Dde_item (pctxt, pvalue->dde_item, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode dde_application */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
      asn1E_Ns13_Dde_application (pctxt, pvalue->dde_application, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode conversion_mode */

   if (pvalue->m.conversion_modePresent) {
      if(pvalue->conversion_mode < 0 || pvalue->conversion_mode > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns13_Dde_source_conversion_mode (pctxt, &pvalue->conversion_mode, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode automatic_update */

   if (pvalue->m.automatic_updatePresent) {
      if(pvalue->automatic_update < 0 || pvalue->automatic_update > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns13_Automatic_update (pctxt, &pvalue->automatic_update, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Dde_source (OSCTXT* pctxt, Ns13_Dde_source* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.automatic_updatePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:automatic-update=\""), 24);

      if(pvalue->automatic_update < 0 || pvalue->automatic_update > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns13_Automatic_update (pctxt, pvalue->automatic_update
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.conversion_modePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:conversion-mode=\""), 23);

      if(pvalue->conversion_mode < 0 || pvalue->conversion_mode > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns13_Dde_source_conversion_mode (pctxt, pvalue->
         conversion_mode, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:dde-application=\""), 23);

   stat = XmlEnc_Ns13_Dde_application (pctxt, pvalue->dde_application, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:dde-item=\""), 16);

   stat = XmlEnc_Ns13_Dde_item (pctxt, pvalue->dde_item, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:dde-topic=\""), 17);

   stat = XmlEnc_Ns13_Dde_topic (pctxt, pvalue->dde_topic, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:name=\""), 12);

      stat = XmlEnc_Ns13_Name (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Target_frame_alt_1                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Target_frame_alt_1 (OSCTXT* pctxt,
   Ns13_Target_frame_alt_1 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Target_frame_alt_1 (OSCTXT* pctxt, 
   Ns13_Target_frame_alt_1 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns13_Target_frame_alt_1_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Target_frame_alt_2                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Target_frame_alt_2 (OSCTXT* pctxt,
   Ns13_Target_frame_alt_2 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Target_frame_alt_2 (OSCTXT* pctxt, 
   Ns13_Target_frame_alt_2 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns13_Target_frame_alt_2_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Target_frame_alt_3                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Target_frame_alt_3 (OSCTXT* pctxt,
   Ns13_Target_frame_alt_3 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Target_frame_alt_3 (OSCTXT* pctxt, 
   Ns13_Target_frame_alt_3 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns13_Target_frame_alt_3_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Target_frame_alt_4                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Target_frame_alt_4 (OSCTXT* pctxt,
   Ns13_Target_frame_alt_4 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Target_frame_alt_4 (OSCTXT* pctxt, 
   Ns13_Target_frame_alt_4 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns13_Target_frame_alt_4_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Target_frame                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Target_frame (OSCTXT* pctxt,
   Ns13_Target_frame *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            asn1E_Ns13_Target_frame_alt_1 (pctxt, &pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
            asn1E_Ns13_Target_frame_alt_2 (pctxt, &pvalue->u.alt_2, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         if(pvalue->u.alt_3 < 0 || pvalue->u.alt_3 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
            asn1E_Ns13_Target_frame_alt_3 (pctxt, &pvalue->u.alt_3, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         if(pvalue->u.alt_4 < 0 || pvalue->u.alt_4 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
            asn1E_Ns13_Target_frame_alt_4 (pctxt, &pvalue->u.alt_4, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns13_Target_frame (OSCTXT* pctxt, Ns13_Target_frame* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Ns13_Target_frame_alt_1 (pctxt, pvalue->u.alt_1
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode alt_2 */

         if(pvalue->u.alt_2 < 0 || pvalue->u.alt_2 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Ns13_Target_frame_alt_2 (pctxt, pvalue->u.alt_2
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode alt_3 */

         if(pvalue->u.alt_3 < 0 || pvalue->u.alt_3 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Ns13_Target_frame_alt_3 (pctxt, pvalue->u.alt_3
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode alt_4 */

         if(pvalue->u.alt_4 < 0 || pvalue->u.alt_4 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Ns13_Target_frame_alt_4 (pctxt, pvalue->u.alt_4
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Boolean_value                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Boolean_value (OSCTXT* pctxt,
   Ns13_Boolean_value *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Boolean_value (OSCTXT* pctxt, Ns13_Boolean_value value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns13_Boolean_value_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Currency                                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Currency (OSCTXT* pctxt,
   Ns13_Currency pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Currency (OSCTXT* pctxt, Ns13_Currency value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Date_value                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Date_value (OSCTXT* pctxt,
   Ns13_Date_value *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_charstr (pctxt, pvalue->u.alt, ASN1IMPL, TM_UNIV|TM_PRIM|26));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_charstr (pctxt, pvalue->u.alt_1, ASN1IMPL, TM_UNIV|TM_PRIM|26));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns13_Date_value (OSCTXT* pctxt, Ns13_Date_value* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, (const OSUTF8CHAR*)pvalue->u.alt
            , 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         stat = rtXmlEncUTF8Str (pctxt, (const OSUTF8CHAR*)pvalue->u.alt_1
            , 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  String_value                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_String_value (OSCTXT* pctxt,
   Ns13_String_value pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_String_value (OSCTXT* pctxt, Ns13_String_value value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Time_value                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Time_value (OSCTXT* pctxt,
   Ns13_Time_value pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Time_value (OSCTXT* pctxt, Ns13_Time_value value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Value                                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Value (OSCTXT* pctxt,
   Ns13_Value *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_real (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Value (OSCTXT* pctxt, Ns13_Value value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncDouble (pctxt, value, elemName, nsPrefix, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Forms_element                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Forms_element (OSCTXT* pctxt,
   Ns13_Forms_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Form (pctxt, (Form*)pvalue->u.form, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Model (pctxt, (Model*)pvalue->u.model, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns13_Forms_element (OSCTXT* pctxt, Ns13_Forms_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode form */

         stat = XmlEnc_Form (pctxt, pvalue->u.form, OSUTF8("form"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode model */

         stat = XmlEnc_Model (pctxt, pvalue->u.model
            , OSUTF8("model"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Forms                                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Forms (OSCTXT* pctxt,
   Ns13_Forms *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns13_Forms_element (pctxt, ((Ns13_Forms_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode automatic_focus */

   if (pvalue->m.automatic_focusPresent) {
      if(pvalue->automatic_focus < 0 || pvalue->automatic_focus > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Automatic_focus (pctxt, (Automatic_focus*)&pvalue->automatic_focus, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode apply_design_mode */

   if (pvalue->m.apply_design_modePresent) {
      if(pvalue->apply_design_mode < 0 || pvalue->apply_design_mode > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Apply_design_mode (pctxt, (Apply_design_mode*)&pvalue->apply_design_mode, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Forms (OSCTXT* pctxt, Ns13_Forms* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.apply_design_modePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns4:apply-design-mode=\""), 24);

      if(pvalue->apply_design_mode < 0 || pvalue->apply_design_mode > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Apply_design_mode (pctxt, pvalue->apply_design_mode
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.automatic_focusPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns4:automatic-focus=\""), 22);

      if(pvalue->automatic_focus < 0 || pvalue->automatic_focus > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Automatic_focus (pctxt, pvalue->automatic_focus, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns13_Forms_element (pctxt, 
         ((Ns13_Forms_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Server_map                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Server_map (OSCTXT* pctxt,
   Ns13_Server_map *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns13_Server_map (OSCTXT* pctxt, Ns13_Server_map value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns13_Server_map_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Meta                                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Meta (OSCTXT* pctxt,
   Ns13_Meta *pvalue, ASN1TagType tagging)
{
   OSRTDListNode* pnode1;
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   pnode1 = pvalue->tail;
   while (0 != pnode1) {
      ll = asn1E_Odf_Element14 (pctxt, (Odf_Element14*)((Odf_Element14*)pnode1->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;

      pnode1 = pnode1->prev;
   }
   ll1 = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll1);
   if (ll1 < 0) return LOG_RTERR (pctxt, ll1);

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Meta (OSCTXT* pctxt, Ns13_Meta* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (elemName != 0) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->head;
   while (0 != pnode) {
      stat = XmlEnc_Odf_Element14 (pctxt, *((Odf_Element14*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Settings                                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Settings (OSCTXT* pctxt,
   Ns13_Settings *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode config_item_set_list */

   pnode2 = pvalue->config_item_set_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Config_item_set (pctxt, ((Config_item_set*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Settings (OSCTXT* pctxt, Ns13_Settings* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode config_item_set_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->config_item_set_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Config_item_set (pctxt, ((Config_item_set*)pnode->data)
         , OSUTF8("config-item-set"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Script                                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Script (OSCTXT* pctxt,
   Ns13_Script *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode element14_list */

   pnode2 = pvalue->element14_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Odf_Element14 (pctxt, (Odf_Element14*)((Odf_Element14*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode language */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      asn1E_Ns6_Language (pctxt, pvalue->language, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Script (OSCTXT* pctxt, Ns13_Script* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns6:language=\""), 15);

   stat = XmlEnc_Ns6_Language (pctxt, pvalue->language, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode element14_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->element14_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Odf_Element14 (pctxt, *((Odf_Element14*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Scripts                                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Scripts (OSCTXT* pctxt,
   Ns13_Scripts *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
         asn1E_Ns13_Event_listeners (pctxt, &pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode script_list */

   pnode2 = pvalue->script_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns13_Script (pctxt, ((Ns13_Script*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Scripts (OSCTXT* pctxt, Ns13_Scripts* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode script_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->script_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns13_Script (pctxt, ((Ns13_Script*)pnode->data)
         , OSUTF8("script"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Font_face_decls                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Font_face_decls (OSCTXT* pctxt,
   Ns13_Font_face_decls *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode font_face_list */

   pnode2 = pvalue->font_face_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns8_Font_face (pctxt, (Ns8_Font_face*)((Ns8_Font_face*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Font_face_decls (OSCTXT* pctxt, Ns13_Font_face_decls* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode font_face_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->font_face_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns8_Font_face (pctxt, ((Ns8_Font_face*)pnode->data)
         , OSUTF8("font-face"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Styles_element                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Styles_element (OSCTXT* pctxt,
   Ns13_Styles_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Ns8_Style (pctxt, (Ns8_Style*)pvalue->u.style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_List_style (pctxt, (Odf_List_style*)pvalue->u.list_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Number_style (pctxt, (Number_style*)pvalue->u.number_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Currency_style (pctxt, (Currency_style*)pvalue->u.currency_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
            asn1E_Percentage_style (pctxt, (Percentage_style*)pvalue->u.percentage_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 6:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
            asn1E_Date_style (pctxt, (Date_style*)pvalue->u.date_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 7:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
            asn1E_Time_style (pctxt, (Time_style*)pvalue->u.time_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 8:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
            asn1E_Boolean_style (pctxt, (Boolean_style*)pvalue->u.boolean_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 9:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
            asn1E_Text_style (pctxt, (Text_style*)pvalue->u.text_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 10:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
            asn1E_Ns8_Default_style (pctxt, (Ns8_Default_style*)pvalue->u.default_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 11:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
            asn1E_Odf_Outline_style (pctxt, (Odf_Outline_style*)pvalue->u.outline_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 12:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
            asn1E_Odf_Notes_configuration (pctxt, (Odf_Notes_configuration*)pvalue->u.notes_configuration, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 13:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
            asn1E_Odf_Bibliography_configuration (pctxt, (Odf_Bibliography_configuration*)pvalue->u.bibliography_configuration, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 14:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
            asn1E_Odf_Linenumbering_configuration (pctxt, (Odf_Linenumbering_configuration*)pvalue->u.linenumbering_configuration, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 15:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|14,
            asn1E_Ns3_Gradient (pctxt, (Ns3_Gradient*)pvalue->u.gradient, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 16:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|15,
            asn1E_LinearGradient (pctxt, (LinearGradient*)pvalue->u.linearGradient, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 17:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|16,
            asn1E_RadialGradient (pctxt, (RadialGradient*)pvalue->u.radialGradient, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 18:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|17,
            asn1E_Ns3_Hatch (pctxt, (Ns3_Hatch*)pvalue->u.hatch, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 19:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|18,
            asn1E_Ns3_Fill_image (pctxt, (Ns3_Fill_image*)pvalue->u.fill_image, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 20:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|19,
            asn1E_Ns3_Marker (pctxt, (Ns3_Marker*)pvalue->u.marker, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 21:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|20,
            asn1E_Ns3_Stroke_dash (pctxt, (Ns3_Stroke_dash*)pvalue->u.stroke_dash, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 22:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|21,
            asn1E_Ns3_Opacity (pctxt, (Ns3_Opacity*)pvalue->u.opacity, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 23:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|22,
            asn1E_Ns8_Presentation_page_layout (pctxt, (Ns8_Presentation_page_layout*)pvalue->u.presentation_page_layout, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns13_Styles_element (OSCTXT* pctxt, Ns13_Styles_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode style */

         stat = XmlEnc_Ns8_Style (pctxt, pvalue->u.style
            , OSUTF8("style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode list_style */

         stat = XmlEnc_Odf_List_style (pctxt, pvalue->u.list_style
            , OSUTF8("list-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode number_style */

         stat = XmlEnc_Number_style (pctxt, pvalue->u.number_style
            , OSUTF8("number-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode currency_style */

         stat = XmlEnc_Currency_style (pctxt, pvalue->u.currency_style
            , OSUTF8("currency-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode percentage_style */

         stat = XmlEnc_Percentage_style (pctxt, pvalue->u.percentage_style
            , OSUTF8("percentage-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 6:
         /* encode date_style */

         stat = XmlEnc_Date_style (pctxt, pvalue->u.date_style
            , OSUTF8("date-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 7:
         /* encode time_style */

         stat = XmlEnc_Time_style (pctxt, pvalue->u.time_style
            , OSUTF8("time-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 8:
         /* encode boolean_style */

         stat = XmlEnc_Boolean_style (pctxt, pvalue->u.boolean_style
            , OSUTF8("boolean-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 9:
         /* encode text_style */

         stat = XmlEnc_Text_style (pctxt, pvalue->u.text_style
            , OSUTF8("text-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 10:
         /* encode default_style */

         stat = XmlEnc_Ns8_Default_style (pctxt, pvalue->u.default_style
            , OSUTF8("default-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 11:
         /* encode outline_style */

         stat = XmlEnc_Odf_Outline_style (pctxt, pvalue->u.outline_style
            , OSUTF8("outline-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 12:
         /* encode notes_configuration */

         stat = XmlEnc_Odf_Notes_configuration (pctxt, pvalue->
            u.notes_configuration, OSUTF8("notes-configuration"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 13:
         /* encode bibliography_configuration */

         stat = XmlEnc_Odf_Bibliography_configuration (pctxt, pvalue->
            u.bibliography_configuration
            , OSUTF8("bibliography-configuration"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 14:
         /* encode linenumbering_configuration */

         stat = XmlEnc_Odf_Linenumbering_configuration (pctxt, pvalue->
            u.linenumbering_configuration
            , OSUTF8("linenumbering-configuration"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 15:
         /* encode gradient */

         stat = XmlEnc_Ns3_Gradient (pctxt, pvalue->u.gradient
            , OSUTF8("gradient"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 16:
         /* encode linearGradient */

         stat = XmlEnc_LinearGradient (pctxt, pvalue->u.linearGradient
            , OSUTF8("linearGradient"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 17:
         /* encode radialGradient */

         stat = XmlEnc_RadialGradient (pctxt, pvalue->u.radialGradient
            , OSUTF8("radialGradient"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 18:
         /* encode hatch */

         stat = XmlEnc_Ns3_Hatch (pctxt, pvalue->u.hatch
            , OSUTF8("hatch"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 19:
         /* encode fill_image */

         stat = XmlEnc_Ns3_Fill_image (pctxt, pvalue->u.fill_image
            , OSUTF8("fill-image"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 20:
         /* encode marker */

         stat = XmlEnc_Ns3_Marker (pctxt, pvalue->u.marker
            , OSUTF8("marker"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 21:
         /* encode stroke_dash */

         stat = XmlEnc_Ns3_Stroke_dash (pctxt, pvalue->u.stroke_dash
            , OSUTF8("stroke-dash"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 22:
         /* encode opacity */

         stat = XmlEnc_Ns3_Opacity (pctxt, pvalue->u.opacity
            , OSUTF8("opacity"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 23:
         /* encode presentation_page_layout */

         stat = XmlEnc_Ns8_Presentation_page_layout (pctxt, pvalue->
            u.presentation_page_layout
            , OSUTF8("presentation-page-layout"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Styles                                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Styles (OSCTXT* pctxt,
   Ns13_Styles *pvalue, ASN1TagType tagging)
{
   OSRTDListNode* pnode1;
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   pnode1 = pvalue->tail;
   while (0 != pnode1) {
      ll = asn1E_Ns13_Styles_element (pctxt, ((Ns13_Styles_element*)pnode1->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;

      pnode1 = pnode1->prev;
   }
   ll1 = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll1);
   if (ll1 < 0) return LOG_RTERR (pctxt, ll1);

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Styles (OSCTXT* pctxt, Ns13_Styles* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (elemName != 0) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->head;
   while (0 != pnode) {
      stat = XmlEnc_Ns13_Styles_element (pctxt, 
         ((Ns13_Styles_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Automatic_styles_element                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Automatic_styles_element (OSCTXT* pctxt,
   Ns13_Automatic_styles_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Ns8_Style (pctxt, (Ns8_Style*)pvalue->u.style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_List_style (pctxt, (Odf_List_style*)pvalue->u.list_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Number_style (pctxt, (Number_style*)pvalue->u.number_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Currency_style (pctxt, (Currency_style*)pvalue->u.currency_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
            asn1E_Percentage_style (pctxt, (Percentage_style*)pvalue->u.percentage_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 6:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
            asn1E_Date_style (pctxt, (Date_style*)pvalue->u.date_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 7:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
            asn1E_Time_style (pctxt, (Time_style*)pvalue->u.time_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 8:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
            asn1E_Boolean_style (pctxt, (Boolean_style*)pvalue->u.boolean_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 9:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
            asn1E_Text_style (pctxt, (Text_style*)pvalue->u.text_style, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 10:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
            asn1E_Ns8_Page_layout (pctxt, (Ns8_Page_layout*)pvalue->u.page_layout, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns13_Automatic_styles_element (OSCTXT* pctxt, 
   Ns13_Automatic_styles_element* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode style */

         stat = XmlEnc_Ns8_Style (pctxt, pvalue->u.style
            , OSUTF8("style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode list_style */

         stat = XmlEnc_Odf_List_style (pctxt, pvalue->u.list_style
            , OSUTF8("list-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode number_style */

         stat = XmlEnc_Number_style (pctxt, pvalue->u.number_style
            , OSUTF8("number-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode currency_style */

         stat = XmlEnc_Currency_style (pctxt, pvalue->u.currency_style
            , OSUTF8("currency-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode percentage_style */

         stat = XmlEnc_Percentage_style (pctxt, pvalue->u.percentage_style
            , OSUTF8("percentage-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 6:
         /* encode date_style */

         stat = XmlEnc_Date_style (pctxt, pvalue->u.date_style
            , OSUTF8("date-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 7:
         /* encode time_style */

         stat = XmlEnc_Time_style (pctxt, pvalue->u.time_style
            , OSUTF8("time-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 8:
         /* encode boolean_style */

         stat = XmlEnc_Boolean_style (pctxt, pvalue->u.boolean_style
            , OSUTF8("boolean-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 9:
         /* encode text_style */

         stat = XmlEnc_Text_style (pctxt, pvalue->u.text_style
            , OSUTF8("text-style"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 10:
         /* encode page_layout */

         stat = XmlEnc_Ns8_Page_layout (pctxt, pvalue->u.page_layout
            , OSUTF8("page-layout"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Automatic_styles                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Automatic_styles (OSCTXT* pctxt,
   Ns13_Automatic_styles *pvalue, ASN1TagType tagging)
{
   OSRTDListNode* pnode1;
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   pnode1 = pvalue->tail;
   while (0 != pnode1) {
      ll = asn1E_Ns13_Automatic_styles_element (pctxt, ((Ns13_Automatic_styles_element*)pnode1->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;

      pnode1 = pnode1->prev;
   }
   ll1 = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll1);
   if (ll1 < 0) return LOG_RTERR (pctxt, ll1);

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Automatic_styles (OSCTXT* pctxt, 
   Ns13_Automatic_styles* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (elemName != 0) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->head;
   while (0 != pnode) {
      stat = XmlEnc_Ns13_Automatic_styles_element (pctxt, 
         ((Ns13_Automatic_styles_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Master_styles_element                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Master_styles_element (OSCTXT* pctxt,
   Ns13_Master_styles_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Ns8_Master_page (pctxt, (Ns8_Master_page*)pvalue->u.master_page, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Ns8_Handout_master (pctxt, (Ns8_Handout_master*)pvalue->u.handout_master, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Ns3_Layer_set (pctxt, (Ns3_Layer_set*)pvalue->u.layer_set, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns13_Master_styles_element (OSCTXT* pctxt, 
   Ns13_Master_styles_element* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode master_page */

         stat = XmlEnc_Ns8_Master_page (pctxt, pvalue->u.master_page
            , OSUTF8("master-page"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode handout_master */

         stat = XmlEnc_Ns8_Handout_master (pctxt, pvalue->u.handout_master
            , OSUTF8("handout-master"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode layer_set */

         stat = XmlEnc_Ns3_Layer_set (pctxt, pvalue->u.layer_set
            , OSUTF8("layer-set"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Master_styles                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Master_styles (OSCTXT* pctxt,
   Ns13_Master_styles *pvalue, ASN1TagType tagging)
{
   OSRTDListNode* pnode1;
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   pnode1 = pvalue->tail;
   while (0 != pnode1) {
      ll = asn1E_Ns13_Master_styles_element (pctxt, ((Ns13_Master_styles_element*)pnode1->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;

      pnode1 = pnode1->prev;
   }
   ll1 = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll1);
   if (ll1 < 0) return LOG_RTERR (pctxt, ll1);

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Master_styles (OSCTXT* pctxt, Ns13_Master_styles* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (elemName != 0) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->head;
   while (0 != pnode) {
      stat = XmlEnc_Ns13_Master_styles_element (pctxt, 
         ((Ns13_Master_styles_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Text_element_element                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Text_element_element (OSCTXT* pctxt,
   Ns13_Text_element_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_H (pctxt, (Odf_H*)pvalue->u.h, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Odf_Numbered_paragraph (pctxt, (Odf_Numbered_paragraph*)pvalue->u.numbered_paragraph, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
            asn1E_Table (pctxt, (Table*)pvalue->u.table, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 6:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
            asn1E_Ns3_A (pctxt, (Ns3_A*)pvalue->u.a, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 7:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
            asn1E_Odf_Section (pctxt, (Odf_Section*)pvalue->u.section, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 8:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
            asn1E_Odf_Table_of_content (pctxt, (Odf_Table_of_content*)pvalue->u.table_of_content, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 9:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
            asn1E_Odf_Illustration_index (pctxt, (Odf_Illustration_index*)pvalue->u.illustration_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 10:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
            asn1E_Odf_Table_index (pctxt, (Odf_Table_index*)pvalue->u.table_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 11:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
            asn1E_Odf_Object_index (pctxt, (Odf_Object_index*)pvalue->u.object_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 12:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
            asn1E_Odf_User_index (pctxt, (Odf_User_index*)pvalue->u.user_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 13:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
            asn1E_Odf_Alphabetical_index (pctxt, (Odf_Alphabetical_index*)pvalue->u.alphabetical_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 14:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
            asn1E_Odf_Bibliography (pctxt, (Odf_Bibliography*)pvalue->u.bibliography, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 15:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|14,
            asn1E_Ns3_Rect (pctxt, (Ns3_Rect*)pvalue->u.rect, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 16:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|15,
            asn1E_Ns3_Line (pctxt, (Ns3_Line*)pvalue->u.line, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 17:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|16,
            asn1E_Ns3_Polyline (pctxt, (Ns3_Polyline*)pvalue->u.polyline, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 18:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|17,
            asn1E_Ns3_Polygon (pctxt, (Ns3_Polygon*)pvalue->u.polygon, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 19:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|18,
            asn1E_Ns3_Regular_polygon (pctxt, (Ns3_Regular_polygon*)pvalue->u.regular_polygon, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 20:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|19,
            asn1E_Ns3_Path (pctxt, (Ns3_Path*)pvalue->u.path, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 21:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|20,
            asn1E_Ns3_Circle (pctxt, (Ns3_Circle*)pvalue->u.circle, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 22:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|21,
            asn1E_Ns3_Ellipse (pctxt, (Ns3_Ellipse*)pvalue->u.ellipse, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 23:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|22,
            asn1E_Ns3_G (pctxt, (Ns3_G*)pvalue->u.g, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 24:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|23,
            asn1E_Ns3_Page_thumbnail (pctxt, (Ns3_Page_thumbnail*)pvalue->u.page_thumbnail, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 25:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|24,
            asn1E_Ns3_Frame (pctxt, (Ns3_Frame*)pvalue->u.frame, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 26:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|25,
            asn1E_Ns3_Measure (pctxt, (Ns3_Measure*)pvalue->u.measure, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 27:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|26,
            asn1E_Ns3_Caption (pctxt, (Ns3_Caption*)pvalue->u.caption, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 28:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|27,
            asn1E_Ns3_Connector (pctxt, (Ns3_Connector*)pvalue->u.connector, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 29:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|28,
            asn1E_Ns3_Control (pctxt, (Ns3_Control*)pvalue->u.control, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 30:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|29,
            asn1E_Ns7_Scene (pctxt, (Ns7_Scene*)pvalue->u.scene, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 31:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|30,
            asn1E_Ns3_Custom_shape (pctxt, (Ns3_Custom_shape*)pvalue->u.custom_shape, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 32:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|31,
            asn1E_Odf_Change (pctxt, (Odf_Change*)pvalue->u.change, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 33:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|32,
            asn1E_Odf_Change_start (pctxt, (Odf_Change_start*)pvalue->u.change_start, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 34:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|33,
            asn1E_Odf_Change_end (pctxt, (Odf_Change_end*)pvalue->u.change_end, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns13_Text_element_element (OSCTXT* pctxt, 
   Ns13_Text_element_element* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode h */

         stat = XmlEnc_Odf_H (pctxt, pvalue->u.h, OSUTF8("h"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode numbered_paragraph */

         stat = XmlEnc_Odf_Numbered_paragraph (pctxt, pvalue->
            u.numbered_paragraph, OSUTF8("numbered-paragraph"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode table */

         stat = XmlEnc_Table (pctxt, pvalue->u.table
            , OSUTF8("table"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 6:
         /* encode a */

         stat = XmlEnc_Ns3_A (pctxt, pvalue->u.a, OSUTF8("a"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 7:
         /* encode section */

         stat = XmlEnc_Odf_Section (pctxt, pvalue->u.section
            , OSUTF8("section"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 8:
         /* encode table_of_content */

         stat = XmlEnc_Odf_Table_of_content (pctxt, pvalue->u.table_of_content
            , OSUTF8("table-of-content"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 9:
         /* encode illustration_index */

         stat = XmlEnc_Odf_Illustration_index (pctxt, pvalue->
            u.illustration_index, OSUTF8("illustration-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 10:
         /* encode table_index */

         stat = XmlEnc_Odf_Table_index (pctxt, pvalue->u.table_index
            , OSUTF8("table-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 11:
         /* encode object_index */

         stat = XmlEnc_Odf_Object_index (pctxt, pvalue->u.object_index
            , OSUTF8("object-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 12:
         /* encode user_index */

         stat = XmlEnc_Odf_User_index (pctxt, pvalue->u.user_index
            , OSUTF8("user-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 13:
         /* encode alphabetical_index */

         stat = XmlEnc_Odf_Alphabetical_index (pctxt, pvalue->
            u.alphabetical_index, OSUTF8("alphabetical-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 14:
         /* encode bibliography */

         stat = XmlEnc_Odf_Bibliography (pctxt, pvalue->u.bibliography
            , OSUTF8("bibliography"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 15:
         /* encode rect */

         stat = XmlEnc_Ns3_Rect (pctxt, pvalue->u.rect
            , OSUTF8("rect"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 16:
         /* encode line */

         stat = XmlEnc_Ns3_Line (pctxt, pvalue->u.line
            , OSUTF8("line"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 17:
         /* encode polyline */

         stat = XmlEnc_Ns3_Polyline (pctxt, pvalue->u.polyline
            , OSUTF8("polyline"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 18:
         /* encode polygon */

         stat = XmlEnc_Ns3_Polygon (pctxt, pvalue->u.polygon
            , OSUTF8("polygon"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 19:
         /* encode regular_polygon */

         stat = XmlEnc_Ns3_Regular_polygon (pctxt, pvalue->u.regular_polygon
            , OSUTF8("regular-polygon"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 20:
         /* encode path */

         stat = XmlEnc_Ns3_Path (pctxt, pvalue->u.path
            , OSUTF8("path"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 21:
         /* encode circle */

         stat = XmlEnc_Ns3_Circle (pctxt, pvalue->u.circle
            , OSUTF8("circle"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 22:
         /* encode ellipse */

         stat = XmlEnc_Ns3_Ellipse (pctxt, pvalue->u.ellipse
            , OSUTF8("ellipse"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 23:
         /* encode g */

         stat = XmlEnc_Ns3_G (pctxt, pvalue->u.g, OSUTF8("g"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 24:
         /* encode page_thumbnail */

         stat = XmlEnc_Ns3_Page_thumbnail (pctxt, pvalue->u.page_thumbnail
            , OSUTF8("page-thumbnail"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 25:
         /* encode frame */

         stat = XmlEnc_Ns3_Frame (pctxt, pvalue->u.frame
            , OSUTF8("frame"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 26:
         /* encode measure */

         stat = XmlEnc_Ns3_Measure (pctxt, pvalue->u.measure
            , OSUTF8("measure"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 27:
         /* encode caption */

         stat = XmlEnc_Ns3_Caption (pctxt, pvalue->u.caption
            , OSUTF8("caption"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 28:
         /* encode connector */

         stat = XmlEnc_Ns3_Connector (pctxt, pvalue->u.connector
            , OSUTF8("connector"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 29:
         /* encode control */

         stat = XmlEnc_Ns3_Control (pctxt, pvalue->u.control
            , OSUTF8("control"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 30:
         /* encode scene */

         stat = XmlEnc_Ns7_Scene (pctxt, pvalue->u.scene
            , OSUTF8("scene"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 31:
         /* encode custom_shape */

         stat = XmlEnc_Ns3_Custom_shape (pctxt, pvalue->u.custom_shape
            , OSUTF8("custom-shape"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 32:
         /* encode change */

         stat = XmlEnc_Odf_Change (pctxt, pvalue->u.change
            , OSUTF8("change"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 33:
         /* encode change_start */

         stat = XmlEnc_Odf_Change_start (pctxt, pvalue->u.change_start
            , OSUTF8("change-start"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 34:
         /* encode change_end */

         stat = XmlEnc_Odf_Change_end (pctxt, pvalue->u.change_end
            , OSUTF8("change-end"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Text_element                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Text_element (OSCTXT* pctxt,
   Ns13_Text_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns13_Text_element_element (pctxt, ((Ns13_Text_element_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode page_sequence */

   if (pvalue->m.page_sequencePresent) {
      if (pvalue->page_sequence == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->page_sequence");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Odf_Page_sequence (pctxt, (Odf_Page_sequence*)pvalue->page_sequence, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Text_element (OSCTXT* pctxt, Ns13_Text_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode page_sequence */

   if (pvalue->m.page_sequencePresent) {
      stat = XmlEnc_Odf_Page_sequence (pctxt, pvalue->page_sequence
         , OSUTF8("page-sequence"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns13_Text_element_element (pctxt, 
         ((Ns13_Text_element_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Text                                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Text (OSCTXT* pctxt,
   Ns13_Text *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode dde_links */

   if (pvalue->m.dde_linksPresent) {
      if (pvalue->dde_links == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->dde_links");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|16,
         asn1E_Dde_links (pctxt, (Dde_links*)pvalue->dde_links, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode consolidation */

   if (pvalue->m.consolidationPresent) {
      if (pvalue->consolidation == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->consolidation");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|15,
         asn1E_Consolidation (pctxt, (Consolidation*)pvalue->consolidation, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode data_pilot_tables */

   if (pvalue->m.data_pilot_tablesPresent) {
      if (pvalue->data_pilot_tables == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->data_pilot_tables");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|14,
         asn1E_Data_pilot_tables (pctxt, (Data_pilot_tables*)pvalue->data_pilot_tables, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode database_ranges */

   if (pvalue->m.database_rangesPresent) {
      if (pvalue->database_ranges == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->database_ranges");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
         asn1E_Database_ranges (pctxt, (Database_ranges*)pvalue->database_ranges, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode named_expressions */

   if (pvalue->m.named_expressionsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
         asn1E_Named_expressions (pctxt, (Named_expressions*)&pvalue->named_expressions, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode sequence_list */

   if (pvalue->m.sequence_listPresent) {
      pnode2 = pvalue->sequence_list.tail;
      while (0 != pnode2) {
         ll = asn1E_Ns13_Text_element (pctxt, ((Ns13_Text_element*)pnode2->data), ASN1EXPL);
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll2 += ll;

         pnode2 = pnode2->prev;
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11, ll2);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      else { ll1 += ll; ll2 = 0; }
   }
   /* encode label_ranges */

   if (pvalue->m.label_rangesPresent) {
      if (pvalue->label_ranges == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->label_ranges");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Label_ranges (pctxt, (Label_ranges*)pvalue->label_ranges, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode content_validations */

   if (pvalue->m.content_validationsPresent) {
      if (pvalue->content_validations == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->content_validations");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Content_validations (pctxt, (Content_validations*)pvalue->content_validations, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode calculation_settings */

   if (pvalue->m.calculation_settingsPresent) {
      if (pvalue->calculation_settings == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->calculation_settings");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Calculation_settings (pctxt, (Calculation_settings*)pvalue->calculation_settings, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode alphabetical_index_auto_mark_file */

   if (pvalue->m.alphabetical_index_auto_mark_filePresent) {
      if (pvalue->alphabetical_index_auto_mark_file == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->alphabetical_index_auto_mark_file");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Odf_Alphabetical_index_auto_mark_file (pctxt, (Odf_Alphabetical_index_auto_mark_file*)pvalue->alphabetical_index_auto_mark_file, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode dde_connection_decls */

   if (pvalue->m.dde_connection_declsPresent) {
      if (pvalue->dde_connection_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->dde_connection_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Odf_Dde_connection_decls (pctxt, (Odf_Dde_connection_decls*)pvalue->dde_connection_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode user_field_decls */

   if (pvalue->m.user_field_declsPresent) {
      if (pvalue->user_field_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->user_field_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Odf_User_field_decls (pctxt, (Odf_User_field_decls*)pvalue->user_field_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode sequence_decls */

   if (pvalue->m.sequence_declsPresent) {
      if (pvalue->sequence_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->sequence_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
         asn1E_Odf_Sequence_decls (pctxt, (Odf_Sequence_decls*)pvalue->sequence_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode variable_decls */

   if (pvalue->m.variable_declsPresent) {
      if (pvalue->variable_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->variable_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
         asn1E_Odf_Variable_decls (pctxt, (Odf_Variable_decls*)pvalue->variable_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode tracked_changes */

   if (pvalue->m.tracked_changesPresent) {
      if (pvalue->tracked_changes == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->tracked_changes");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Odf_Tracked_changes (pctxt, (Odf_Tracked_changes*)pvalue->tracked_changes, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode forms */

   if (pvalue->m.formsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
         asn1E_Ns13_Forms (pctxt, &pvalue->forms, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode global */

   if (pvalue->m.globalPresent) {
      if(pvalue->global < 0 || pvalue->global > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Odf_Global (pctxt, (Odf_Global*)&pvalue->global, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Text (OSCTXT* pctxt, Ns13_Text* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.globalPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:global=\""), 14);

      if(pvalue->global < 0 || pvalue->global > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Global (pctxt, pvalue->global, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode forms */

   if (pvalue->m.formsPresent) {
      stat = XmlEnc_Ns13_Forms (pctxt, &pvalue->forms
         , OSUTF8("forms"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode tracked_changes */

   if (pvalue->m.tracked_changesPresent) {
      stat = XmlEnc_Odf_Tracked_changes (pctxt, pvalue->tracked_changes
         , OSUTF8("tracked-changes"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode variable_decls */

   if (pvalue->m.variable_declsPresent) {
      stat = XmlEnc_Odf_Variable_decls (pctxt, pvalue->variable_decls
         , OSUTF8("variable-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode sequence_decls */

   if (pvalue->m.sequence_declsPresent) {
      stat = XmlEnc_Odf_Sequence_decls (pctxt, pvalue->sequence_decls
         , OSUTF8("sequence-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode user_field_decls */

   if (pvalue->m.user_field_declsPresent) {
      stat = XmlEnc_Odf_User_field_decls (pctxt, pvalue->user_field_decls
         , OSUTF8("user-field-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode dde_connection_decls */

   if (pvalue->m.dde_connection_declsPresent) {
      stat = XmlEnc_Odf_Dde_connection_decls (pctxt, pvalue->
         dde_connection_decls, OSUTF8("dde-connection-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode alphabetical_index_auto_mark_file */

   if (pvalue->m.alphabetical_index_auto_mark_filePresent) {
      stat = XmlEnc_Odf_Alphabetical_index_auto_mark_file (pctxt, pvalue->
         alphabetical_index_auto_mark_file
         , OSUTF8("alphabetical-index-auto-mark-file"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode calculation_settings */

   if (pvalue->m.calculation_settingsPresent) {
      stat = XmlEnc_Calculation_settings (pctxt, pvalue->calculation_settings
         , OSUTF8("calculation-settings"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode content_validations */

   if (pvalue->m.content_validationsPresent) {
      stat = XmlEnc_Content_validations (pctxt, pvalue->content_validations
         , OSUTF8("content-validations"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode label_ranges */

   if (pvalue->m.label_rangesPresent) {
      stat = XmlEnc_Label_ranges (pctxt, pvalue->label_ranges
         , OSUTF8("label-ranges"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode sequence_list */

   if (pvalue->m.sequence_listPresent) {
      { const OSUTF8CHAR* savedPrefix = nsPrefix;
      nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
         "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

      { OSRTDListNode* pnode = pvalue->sequence_list.head;
      while (0 != pnode) {
         stat = XmlEnc_Ns13_Text_element (pctxt, 
            ((Ns13_Text_element*)pnode->data), 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);
         pnode = pnode->next;
      }}
      nsPrefix = savedPrefix;
      }

   }
   /* encode named_expressions */

   if (pvalue->m.named_expressionsPresent) {
      stat = XmlEnc_Named_expressions (pctxt, &pvalue->named_expressions
         , OSUTF8("named-expressions"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode database_ranges */

   if (pvalue->m.database_rangesPresent) {
      stat = XmlEnc_Database_ranges (pctxt, pvalue->database_ranges
         , OSUTF8("database-ranges"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode data_pilot_tables */

   if (pvalue->m.data_pilot_tablesPresent) {
      stat = XmlEnc_Data_pilot_tables (pctxt, pvalue->data_pilot_tables
         , OSUTF8("data-pilot-tables"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode consolidation */

   if (pvalue->m.consolidationPresent) {
      stat = XmlEnc_Consolidation (pctxt, pvalue->consolidation
         , OSUTF8("consolidation"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode dde_links */

   if (pvalue->m.dde_linksPresent) {
      stat = XmlEnc_Dde_links (pctxt, pvalue->dde_links
         , OSUTF8("dde-links"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Drawing                                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Drawing (OSCTXT* pctxt,
   Ns13_Drawing *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode dde_links */

   if (pvalue->m.dde_linksPresent) {
      if (pvalue->dde_links == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->dde_links");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
         asn1E_Dde_links (pctxt, (Dde_links*)pvalue->dde_links, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode consolidation */

   if (pvalue->m.consolidationPresent) {
      if (pvalue->consolidation == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->consolidation");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
         asn1E_Consolidation (pctxt, (Consolidation*)pvalue->consolidation, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode data_pilot_tables */

   if (pvalue->m.data_pilot_tablesPresent) {
      if (pvalue->data_pilot_tables == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->data_pilot_tables");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
         asn1E_Data_pilot_tables (pctxt, (Data_pilot_tables*)pvalue->data_pilot_tables, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode database_ranges */

   if (pvalue->m.database_rangesPresent) {
      if (pvalue->database_ranges == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->database_ranges");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Database_ranges (pctxt, (Database_ranges*)pvalue->database_ranges, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode named_expressions */

   if (pvalue->m.named_expressionsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Named_expressions (pctxt, (Named_expressions*)&pvalue->named_expressions, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode page_list */

   pnode2 = pvalue->page_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Page (pctxt, (Ns3_Page*)((Ns3_Page*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode label_ranges */

   if (pvalue->m.label_rangesPresent) {
      if (pvalue->label_ranges == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->label_ranges");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Label_ranges (pctxt, (Label_ranges*)pvalue->label_ranges, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode content_validations */

   if (pvalue->m.content_validationsPresent) {
      if (pvalue->content_validations == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->content_validations");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Content_validations (pctxt, (Content_validations*)pvalue->content_validations, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode calculation_settings */

   if (pvalue->m.calculation_settingsPresent) {
      if (pvalue->calculation_settings == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->calculation_settings");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Calculation_settings (pctxt, (Calculation_settings*)pvalue->calculation_settings, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode alphabetical_index_auto_mark_file */

   if (pvalue->m.alphabetical_index_auto_mark_filePresent) {
      if (pvalue->alphabetical_index_auto_mark_file == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->alphabetical_index_auto_mark_file");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
         asn1E_Odf_Alphabetical_index_auto_mark_file (pctxt, (Odf_Alphabetical_index_auto_mark_file*)pvalue->alphabetical_index_auto_mark_file, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode dde_connection_decls */

   if (pvalue->m.dde_connection_declsPresent) {
      if (pvalue->dde_connection_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->dde_connection_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
         asn1E_Odf_Dde_connection_decls (pctxt, (Odf_Dde_connection_decls*)pvalue->dde_connection_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode user_field_decls */

   if (pvalue->m.user_field_declsPresent) {
      if (pvalue->user_field_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->user_field_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Odf_User_field_decls (pctxt, (Odf_User_field_decls*)pvalue->user_field_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode sequence_decls */

   if (pvalue->m.sequence_declsPresent) {
      if (pvalue->sequence_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->sequence_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
         asn1E_Odf_Sequence_decls (pctxt, (Odf_Sequence_decls*)pvalue->sequence_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode variable_decls */

   if (pvalue->m.variable_declsPresent) {
      if (pvalue->variable_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->variable_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Odf_Variable_decls (pctxt, (Odf_Variable_decls*)pvalue->variable_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Drawing (OSCTXT* pctxt, Ns13_Drawing* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode variable_decls */

   if (pvalue->m.variable_declsPresent) {
      stat = XmlEnc_Odf_Variable_decls (pctxt, pvalue->variable_decls
         , OSUTF8("variable-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode sequence_decls */

   if (pvalue->m.sequence_declsPresent) {
      stat = XmlEnc_Odf_Sequence_decls (pctxt, pvalue->sequence_decls
         , OSUTF8("sequence-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode user_field_decls */

   if (pvalue->m.user_field_declsPresent) {
      stat = XmlEnc_Odf_User_field_decls (pctxt, pvalue->user_field_decls
         , OSUTF8("user-field-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode dde_connection_decls */

   if (pvalue->m.dde_connection_declsPresent) {
      stat = XmlEnc_Odf_Dde_connection_decls (pctxt, pvalue->
         dde_connection_decls, OSUTF8("dde-connection-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode alphabetical_index_auto_mark_file */

   if (pvalue->m.alphabetical_index_auto_mark_filePresent) {
      stat = XmlEnc_Odf_Alphabetical_index_auto_mark_file (pctxt, pvalue->
         alphabetical_index_auto_mark_file
         , OSUTF8("alphabetical-index-auto-mark-file"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode calculation_settings */

   if (pvalue->m.calculation_settingsPresent) {
      stat = XmlEnc_Calculation_settings (pctxt, pvalue->calculation_settings
         , OSUTF8("calculation-settings"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode content_validations */

   if (pvalue->m.content_validationsPresent) {
      stat = XmlEnc_Content_validations (pctxt, pvalue->content_validations
         , OSUTF8("content-validations"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode label_ranges */

   if (pvalue->m.label_rangesPresent) {
      stat = XmlEnc_Label_ranges (pctxt, pvalue->label_ranges
         , OSUTF8("label-ranges"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode page_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->page_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Page (pctxt, ((Ns3_Page*)pnode->data)
         , OSUTF8("page"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode named_expressions */

   if (pvalue->m.named_expressionsPresent) {
      stat = XmlEnc_Named_expressions (pctxt, &pvalue->named_expressions
         , OSUTF8("named-expressions"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode database_ranges */

   if (pvalue->m.database_rangesPresent) {
      stat = XmlEnc_Database_ranges (pctxt, pvalue->database_ranges
         , OSUTF8("database-ranges"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode data_pilot_tables */

   if (pvalue->m.data_pilot_tablesPresent) {
      stat = XmlEnc_Data_pilot_tables (pctxt, pvalue->data_pilot_tables
         , OSUTF8("data-pilot-tables"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode consolidation */

   if (pvalue->m.consolidationPresent) {
      stat = XmlEnc_Consolidation (pctxt, pvalue->consolidation
         , OSUTF8("consolidation"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode dde_links */

   if (pvalue->m.dde_linksPresent) {
      stat = XmlEnc_Dde_links (pctxt, pvalue->dde_links
         , OSUTF8("dde-links"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Presentation_element                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Presentation_element (OSCTXT* pctxt,
   Ns13_Presentation_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Ns10_Header_decl (pctxt, (Ns10_Header_decl*)pvalue->u.header_decl, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Ns10_Footer_decl (pctxt, (Ns10_Footer_decl*)pvalue->u.footer_decl, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Ns10_Date_time_decl (pctxt, (Ns10_Date_time_decl*)pvalue->u.date_time_decl, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns13_Presentation_element (OSCTXT* pctxt, 
   Ns13_Presentation_element* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode header_decl */

         stat = XmlEnc_Ns10_Header_decl (pctxt, pvalue->u.header_decl
            , OSUTF8("header-decl"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode footer_decl */

         stat = XmlEnc_Ns10_Footer_decl (pctxt, pvalue->u.footer_decl
            , OSUTF8("footer-decl"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode date_time_decl */

         stat = XmlEnc_Ns10_Date_time_decl (pctxt, pvalue->u.date_time_decl
            , OSUTF8("date-time-decl"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Presentation                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Presentation (OSCTXT* pctxt,
   Ns13_Presentation *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode dde_links */

   if (pvalue->m.dde_linksPresent) {
      if (pvalue->dde_links == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->dde_links");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|15,
         asn1E_Dde_links (pctxt, (Dde_links*)pvalue->dde_links, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode consolidation */

   if (pvalue->m.consolidationPresent) {
      if (pvalue->consolidation == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->consolidation");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|14,
         asn1E_Consolidation (pctxt, (Consolidation*)pvalue->consolidation, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode data_pilot_tables */

   if (pvalue->m.data_pilot_tablesPresent) {
      if (pvalue->data_pilot_tables == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->data_pilot_tables");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
         asn1E_Data_pilot_tables (pctxt, (Data_pilot_tables*)pvalue->data_pilot_tables, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode database_ranges */

   if (pvalue->m.database_rangesPresent) {
      if (pvalue->database_ranges == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->database_ranges");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
         asn1E_Database_ranges (pctxt, (Database_ranges*)pvalue->database_ranges, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode named_expressions */

   if (pvalue->m.named_expressionsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
         asn1E_Named_expressions (pctxt, (Named_expressions*)&pvalue->named_expressions, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode settings */

   if (pvalue->m.settingsPresent) {
      if (pvalue->settings == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->settings");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Ns10_Settings (pctxt, (Ns10_Settings*)pvalue->settings, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode page_list */

   pnode2 = pvalue->page_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Page (pctxt, (Ns3_Page*)((Ns3_Page*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns13_Presentation_element (pctxt, ((Ns13_Presentation_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode label_ranges */

   if (pvalue->m.label_rangesPresent) {
      if (pvalue->label_ranges == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->label_ranges");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Label_ranges (pctxt, (Label_ranges*)pvalue->label_ranges, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode content_validations */

   if (pvalue->m.content_validationsPresent) {
      if (pvalue->content_validations == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->content_validations");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Content_validations (pctxt, (Content_validations*)pvalue->content_validations, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode calculation_settings */

   if (pvalue->m.calculation_settingsPresent) {
      if (pvalue->calculation_settings == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->calculation_settings");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Calculation_settings (pctxt, (Calculation_settings*)pvalue->calculation_settings, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode alphabetical_index_auto_mark_file */

   if (pvalue->m.alphabetical_index_auto_mark_filePresent) {
      if (pvalue->alphabetical_index_auto_mark_file == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->alphabetical_index_auto_mark_file");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
         asn1E_Odf_Alphabetical_index_auto_mark_file (pctxt, (Odf_Alphabetical_index_auto_mark_file*)pvalue->alphabetical_index_auto_mark_file, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode dde_connection_decls */

   if (pvalue->m.dde_connection_declsPresent) {
      if (pvalue->dde_connection_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->dde_connection_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
         asn1E_Odf_Dde_connection_decls (pctxt, (Odf_Dde_connection_decls*)pvalue->dde_connection_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode user_field_decls */

   if (pvalue->m.user_field_declsPresent) {
      if (pvalue->user_field_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->user_field_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Odf_User_field_decls (pctxt, (Odf_User_field_decls*)pvalue->user_field_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode sequence_decls */

   if (pvalue->m.sequence_declsPresent) {
      if (pvalue->sequence_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->sequence_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
         asn1E_Odf_Sequence_decls (pctxt, (Odf_Sequence_decls*)pvalue->sequence_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode variable_decls */

   if (pvalue->m.variable_declsPresent) {
      if (pvalue->variable_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->variable_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Odf_Variable_decls (pctxt, (Odf_Variable_decls*)pvalue->variable_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Presentation (OSCTXT* pctxt, Ns13_Presentation* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode variable_decls */

   if (pvalue->m.variable_declsPresent) {
      stat = XmlEnc_Odf_Variable_decls (pctxt, pvalue->variable_decls
         , OSUTF8("variable-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode sequence_decls */

   if (pvalue->m.sequence_declsPresent) {
      stat = XmlEnc_Odf_Sequence_decls (pctxt, pvalue->sequence_decls
         , OSUTF8("sequence-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode user_field_decls */

   if (pvalue->m.user_field_declsPresent) {
      stat = XmlEnc_Odf_User_field_decls (pctxt, pvalue->user_field_decls
         , OSUTF8("user-field-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode dde_connection_decls */

   if (pvalue->m.dde_connection_declsPresent) {
      stat = XmlEnc_Odf_Dde_connection_decls (pctxt, pvalue->
         dde_connection_decls, OSUTF8("dde-connection-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode alphabetical_index_auto_mark_file */

   if (pvalue->m.alphabetical_index_auto_mark_filePresent) {
      stat = XmlEnc_Odf_Alphabetical_index_auto_mark_file (pctxt, pvalue->
         alphabetical_index_auto_mark_file
         , OSUTF8("alphabetical-index-auto-mark-file"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode calculation_settings */

   if (pvalue->m.calculation_settingsPresent) {
      stat = XmlEnc_Calculation_settings (pctxt, pvalue->calculation_settings
         , OSUTF8("calculation-settings"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode content_validations */

   if (pvalue->m.content_validationsPresent) {
      stat = XmlEnc_Content_validations (pctxt, pvalue->content_validations
         , OSUTF8("content-validations"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode label_ranges */

   if (pvalue->m.label_rangesPresent) {
      stat = XmlEnc_Label_ranges (pctxt, pvalue->label_ranges
         , OSUTF8("label-ranges"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns13_Presentation_element (pctxt, 
         ((Ns13_Presentation_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode page_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->page_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Page (pctxt, ((Ns3_Page*)pnode->data)
         , OSUTF8("page"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode settings */

   if (pvalue->m.settingsPresent) {
      stat = XmlEnc_Ns10_Settings (pctxt, pvalue->settings
         , OSUTF8("settings"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode named_expressions */

   if (pvalue->m.named_expressionsPresent) {
      stat = XmlEnc_Named_expressions (pctxt, &pvalue->named_expressions
         , OSUTF8("named-expressions"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode database_ranges */

   if (pvalue->m.database_rangesPresent) {
      stat = XmlEnc_Database_ranges (pctxt, pvalue->database_ranges
         , OSUTF8("database-ranges"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode data_pilot_tables */

   if (pvalue->m.data_pilot_tablesPresent) {
      stat = XmlEnc_Data_pilot_tables (pctxt, pvalue->data_pilot_tables
         , OSUTF8("data-pilot-tables"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode consolidation */

   if (pvalue->m.consolidationPresent) {
      stat = XmlEnc_Consolidation (pctxt, pvalue->consolidation
         , OSUTF8("consolidation"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode dde_links */

   if (pvalue->m.dde_linksPresent) {
      stat = XmlEnc_Dde_links (pctxt, pvalue->dde_links
         , OSUTF8("dde-links"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Spreadsheet                                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Spreadsheet (OSCTXT* pctxt,
   Ns13_Spreadsheet *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode dde_links */

   if (pvalue->m.dde_linksPresent) {
      if (pvalue->dde_links == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->dde_links");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|16,
         asn1E_Dde_links (pctxt, (Dde_links*)pvalue->dde_links, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode consolidation */

   if (pvalue->m.consolidationPresent) {
      if (pvalue->consolidation == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->consolidation");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|15,
         asn1E_Consolidation (pctxt, (Consolidation*)pvalue->consolidation, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode data_pilot_tables */

   if (pvalue->m.data_pilot_tablesPresent) {
      if (pvalue->data_pilot_tables == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->data_pilot_tables");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|14,
         asn1E_Data_pilot_tables (pctxt, (Data_pilot_tables*)pvalue->data_pilot_tables, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode database_ranges */

   if (pvalue->m.database_rangesPresent) {
      if (pvalue->database_ranges == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->database_ranges");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
         asn1E_Database_ranges (pctxt, (Database_ranges*)pvalue->database_ranges, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode named_expressions */

   if (pvalue->m.named_expressionsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
         asn1E_Named_expressions (pctxt, (Named_expressions*)&pvalue->named_expressions, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_list */

   pnode2 = pvalue->table_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Table (pctxt, (Table*)((Table*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode label_ranges */

   if (pvalue->m.label_rangesPresent) {
      if (pvalue->label_ranges == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->label_ranges");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Label_ranges (pctxt, (Label_ranges*)pvalue->label_ranges, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode content_validations */

   if (pvalue->m.content_validationsPresent) {
      if (pvalue->content_validations == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->content_validations");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Content_validations (pctxt, (Content_validations*)pvalue->content_validations, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode calculation_settings */

   if (pvalue->m.calculation_settingsPresent) {
      if (pvalue->calculation_settings == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->calculation_settings");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Calculation_settings (pctxt, (Calculation_settings*)pvalue->calculation_settings, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode alphabetical_index_auto_mark_file */

   if (pvalue->m.alphabetical_index_auto_mark_filePresent) {
      if (pvalue->alphabetical_index_auto_mark_file == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->alphabetical_index_auto_mark_file");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Odf_Alphabetical_index_auto_mark_file (pctxt, (Odf_Alphabetical_index_auto_mark_file*)pvalue->alphabetical_index_auto_mark_file, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode dde_connection_decls */

   if (pvalue->m.dde_connection_declsPresent) {
      if (pvalue->dde_connection_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->dde_connection_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Odf_Dde_connection_decls (pctxt, (Odf_Dde_connection_decls*)pvalue->dde_connection_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode user_field_decls */

   if (pvalue->m.user_field_declsPresent) {
      if (pvalue->user_field_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->user_field_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Odf_User_field_decls (pctxt, (Odf_User_field_decls*)pvalue->user_field_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode sequence_decls */

   if (pvalue->m.sequence_declsPresent) {
      if (pvalue->sequence_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->sequence_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
         asn1E_Odf_Sequence_decls (pctxt, (Odf_Sequence_decls*)pvalue->sequence_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode variable_decls */

   if (pvalue->m.variable_declsPresent) {
      if (pvalue->variable_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->variable_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
         asn1E_Odf_Variable_decls (pctxt, (Odf_Variable_decls*)pvalue->variable_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode tracked_changes */

   if (pvalue->m.tracked_changesPresent) {
      if (pvalue->tracked_changes == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->tracked_changes");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Odf_Tracked_changes (pctxt, (Odf_Tracked_changes*)pvalue->tracked_changes, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode structure_protected */

   if (pvalue->m.structure_protectedPresent) {
      if(pvalue->structure_protected < 0 || pvalue->structure_protected > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Structure_protected (pctxt, (Structure_protected*)&pvalue->structure_protected, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode protection_key */

   if (pvalue->m.protection_keyPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Protection_key (pctxt, (Protection_key)pvalue->protection_key, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Spreadsheet (OSCTXT* pctxt, Ns13_Spreadsheet* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.protection_keyPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:protection-key=\""), 22);

      stat = XmlEnc_Protection_key (pctxt, pvalue->protection_key, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.structure_protectedPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:structure-protected=\""), 27);

      if(pvalue->structure_protected < 0 || pvalue->structure_protected > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Structure_protected (pctxt, pvalue->structure_protected
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode tracked_changes */

   if (pvalue->m.tracked_changesPresent) {
      stat = XmlEnc_Odf_Tracked_changes (pctxt, pvalue->tracked_changes
         , OSUTF8("tracked-changes"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode variable_decls */

   if (pvalue->m.variable_declsPresent) {
      stat = XmlEnc_Odf_Variable_decls (pctxt, pvalue->variable_decls
         , OSUTF8("variable-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode sequence_decls */

   if (pvalue->m.sequence_declsPresent) {
      stat = XmlEnc_Odf_Sequence_decls (pctxt, pvalue->sequence_decls
         , OSUTF8("sequence-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode user_field_decls */

   if (pvalue->m.user_field_declsPresent) {
      stat = XmlEnc_Odf_User_field_decls (pctxt, pvalue->user_field_decls
         , OSUTF8("user-field-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode dde_connection_decls */

   if (pvalue->m.dde_connection_declsPresent) {
      stat = XmlEnc_Odf_Dde_connection_decls (pctxt, pvalue->
         dde_connection_decls, OSUTF8("dde-connection-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode alphabetical_index_auto_mark_file */

   if (pvalue->m.alphabetical_index_auto_mark_filePresent) {
      stat = XmlEnc_Odf_Alphabetical_index_auto_mark_file (pctxt, pvalue->
         alphabetical_index_auto_mark_file
         , OSUTF8("alphabetical-index-auto-mark-file"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode calculation_settings */

   if (pvalue->m.calculation_settingsPresent) {
      stat = XmlEnc_Calculation_settings (pctxt, pvalue->calculation_settings
         , OSUTF8("calculation-settings"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode content_validations */

   if (pvalue->m.content_validationsPresent) {
      stat = XmlEnc_Content_validations (pctxt, pvalue->content_validations
         , OSUTF8("content-validations"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode label_ranges */

   if (pvalue->m.label_rangesPresent) {
      stat = XmlEnc_Label_ranges (pctxt, pvalue->label_ranges
         , OSUTF8("label-ranges"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode table_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->table_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Table (pctxt, ((Table*)pnode->data)
         , OSUTF8("table"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode named_expressions */

   if (pvalue->m.named_expressionsPresent) {
      stat = XmlEnc_Named_expressions (pctxt, &pvalue->named_expressions
         , OSUTF8("named-expressions"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode database_ranges */

   if (pvalue->m.database_rangesPresent) {
      stat = XmlEnc_Database_ranges (pctxt, pvalue->database_ranges
         , OSUTF8("database-ranges"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode data_pilot_tables */

   if (pvalue->m.data_pilot_tablesPresent) {
      stat = XmlEnc_Data_pilot_tables (pctxt, pvalue->data_pilot_tables
         , OSUTF8("data-pilot-tables"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode consolidation */

   if (pvalue->m.consolidationPresent) {
      stat = XmlEnc_Consolidation (pctxt, pvalue->consolidation
         , OSUTF8("consolidation"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode dde_links */

   if (pvalue->m.dde_linksPresent) {
      stat = XmlEnc_Dde_links (pctxt, pvalue->dde_links
         , OSUTF8("dde-links"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Chart                                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Chart (OSCTXT* pctxt,
   Ns13_Chart *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode dde_links */

   if (pvalue->m.dde_linksPresent) {
      if (pvalue->dde_links == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->dde_links");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
         asn1E_Dde_links (pctxt, (Dde_links*)pvalue->dde_links, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode consolidation */

   if (pvalue->m.consolidationPresent) {
      if (pvalue->consolidation == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->consolidation");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
         asn1E_Consolidation (pctxt, (Consolidation*)pvalue->consolidation, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode data_pilot_tables */

   if (pvalue->m.data_pilot_tablesPresent) {
      if (pvalue->data_pilot_tables == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->data_pilot_tables");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
         asn1E_Data_pilot_tables (pctxt, (Data_pilot_tables*)pvalue->data_pilot_tables, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode database_ranges */

   if (pvalue->m.database_rangesPresent) {
      if (pvalue->database_ranges == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->database_ranges");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Database_ranges (pctxt, (Database_ranges*)pvalue->database_ranges, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode named_expressions */

   if (pvalue->m.named_expressionsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Named_expressions (pctxt, (Named_expressions*)&pvalue->named_expressions, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode chart */

   if (pvalue->chart == NULL) {
      rtxErrAddStrParm (pctxt, "pvalue->chart");
      return LOG_RTERR (pctxt, RTERR_NULLPTR);
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
      asn1E_Chart (pctxt, (Chart*)pvalue->chart, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode label_ranges */

   if (pvalue->m.label_rangesPresent) {
      if (pvalue->label_ranges == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->label_ranges");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Label_ranges (pctxt, (Label_ranges*)pvalue->label_ranges, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode content_validations */

   if (pvalue->m.content_validationsPresent) {
      if (pvalue->content_validations == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->content_validations");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Content_validations (pctxt, (Content_validations*)pvalue->content_validations, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode calculation_settings */

   if (pvalue->m.calculation_settingsPresent) {
      if (pvalue->calculation_settings == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->calculation_settings");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Calculation_settings (pctxt, (Calculation_settings*)pvalue->calculation_settings, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode alphabetical_index_auto_mark_file */

   if (pvalue->m.alphabetical_index_auto_mark_filePresent) {
      if (pvalue->alphabetical_index_auto_mark_file == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->alphabetical_index_auto_mark_file");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
         asn1E_Odf_Alphabetical_index_auto_mark_file (pctxt, (Odf_Alphabetical_index_auto_mark_file*)pvalue->alphabetical_index_auto_mark_file, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode dde_connection_decls */

   if (pvalue->m.dde_connection_declsPresent) {
      if (pvalue->dde_connection_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->dde_connection_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
         asn1E_Odf_Dde_connection_decls (pctxt, (Odf_Dde_connection_decls*)pvalue->dde_connection_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode user_field_decls */

   if (pvalue->m.user_field_declsPresent) {
      if (pvalue->user_field_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->user_field_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Odf_User_field_decls (pctxt, (Odf_User_field_decls*)pvalue->user_field_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode sequence_decls */

   if (pvalue->m.sequence_declsPresent) {
      if (pvalue->sequence_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->sequence_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
         asn1E_Odf_Sequence_decls (pctxt, (Odf_Sequence_decls*)pvalue->sequence_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode variable_decls */

   if (pvalue->m.variable_declsPresent) {
      if (pvalue->variable_decls == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->variable_decls");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Odf_Variable_decls (pctxt, (Odf_Variable_decls*)pvalue->variable_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Chart (OSCTXT* pctxt, Ns13_Chart* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode variable_decls */

   if (pvalue->m.variable_declsPresent) {
      stat = XmlEnc_Odf_Variable_decls (pctxt, pvalue->variable_decls
         , OSUTF8("variable-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode sequence_decls */

   if (pvalue->m.sequence_declsPresent) {
      stat = XmlEnc_Odf_Sequence_decls (pctxt, pvalue->sequence_decls
         , OSUTF8("sequence-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode user_field_decls */

   if (pvalue->m.user_field_declsPresent) {
      stat = XmlEnc_Odf_User_field_decls (pctxt, pvalue->user_field_decls
         , OSUTF8("user-field-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode dde_connection_decls */

   if (pvalue->m.dde_connection_declsPresent) {
      stat = XmlEnc_Odf_Dde_connection_decls (pctxt, pvalue->
         dde_connection_decls, OSUTF8("dde-connection-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode alphabetical_index_auto_mark_file */

   if (pvalue->m.alphabetical_index_auto_mark_filePresent) {
      stat = XmlEnc_Odf_Alphabetical_index_auto_mark_file (pctxt, pvalue->
         alphabetical_index_auto_mark_file
         , OSUTF8("alphabetical-index-auto-mark-file"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode calculation_settings */

   if (pvalue->m.calculation_settingsPresent) {
      stat = XmlEnc_Calculation_settings (pctxt, pvalue->calculation_settings
         , OSUTF8("calculation-settings"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode content_validations */

   if (pvalue->m.content_validationsPresent) {
      stat = XmlEnc_Content_validations (pctxt, pvalue->content_validations
         , OSUTF8("content-validations"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode label_ranges */

   if (pvalue->m.label_rangesPresent) {
      stat = XmlEnc_Label_ranges (pctxt, pvalue->label_ranges
         , OSUTF8("label-ranges"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode chart */

   stat = XmlEnc_Chart (pctxt, pvalue->chart, OSUTF8("chart"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   /* encode named_expressions */

   if (pvalue->m.named_expressionsPresent) {
      stat = XmlEnc_Named_expressions (pctxt, &pvalue->named_expressions
         , OSUTF8("named-expressions"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode database_ranges */

   if (pvalue->m.database_rangesPresent) {
      stat = XmlEnc_Database_ranges (pctxt, pvalue->database_ranges
         , OSUTF8("database-ranges"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode data_pilot_tables */

   if (pvalue->m.data_pilot_tablesPresent) {
      stat = XmlEnc_Data_pilot_tables (pctxt, pvalue->data_pilot_tables
         , OSUTF8("data-pilot-tables"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode consolidation */

   if (pvalue->m.consolidationPresent) {
      stat = XmlEnc_Consolidation (pctxt, pvalue->consolidation
         , OSUTF8("consolidation"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode dde_links */

   if (pvalue->m.dde_linksPresent) {
      stat = XmlEnc_Dde_links (pctxt, pvalue->dde_links
         , OSUTF8("dde-links"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Image                                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Image (OSCTXT* pctxt,
   Ns13_Image *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode frame */

   if (pvalue->frame == NULL) {
      rtxErrAddStrParm (pctxt, "pvalue->frame");
      return LOG_RTERR (pctxt, RTERR_NULLPTR);
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
      asn1E_Ns3_Frame (pctxt, (Ns3_Frame*)pvalue->frame, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Image (OSCTXT* pctxt, Ns13_Image* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode frame */

   stat = XmlEnc_Ns3_Frame (pctxt, pvalue->frame, OSUTF8("frame"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Body                                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Body (OSCTXT* pctxt,
   Ns13_Body *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Ns13_Text (pctxt, pvalue->u.text, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Ns13_Drawing (pctxt, pvalue->u.drawing, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Ns13_Presentation (pctxt, pvalue->u.presentation, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Ns13_Spreadsheet (pctxt, pvalue->u.spreadsheet, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
            asn1E_Ns13_Chart (pctxt, pvalue->u.chart, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 6:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
            asn1E_Ns13_Image (pctxt, pvalue->u.image, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }

   ll1 = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll1);
   if (ll1 < 0) return LOG_RTERR (pctxt, ll1);

   if (tagging == ASN1EXPL) {
      ll1 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll1);
      if (ll1 < 0) return LOG_RTERR (pctxt, ll1);
   }

   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns13_Body (OSCTXT* pctxt, Ns13_Body* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode text */

         stat = XmlEnc_Ns13_Text (pctxt, pvalue->u.text
            , OSUTF8("text"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode drawing */

         stat = XmlEnc_Ns13_Drawing (pctxt, pvalue->u.drawing
            , OSUTF8("drawing"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode presentation */

         stat = XmlEnc_Ns13_Presentation (pctxt, pvalue->u.presentation
            , OSUTF8("presentation"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode spreadsheet */

         stat = XmlEnc_Ns13_Spreadsheet (pctxt, pvalue->u.spreadsheet
            , OSUTF8("spreadsheet"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode chart */

         stat = XmlEnc_Ns13_Chart (pctxt, pvalue->u.chart
            , OSUTF8("chart"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 6:
         /* encode image */

         stat = XmlEnc_Ns13_Image (pctxt, pvalue->u.image
            , OSUTF8("image"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Document                                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Document (OSCTXT* pctxt,
   Ns13_Document *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode body */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
      asn1E_Ns13_Body (pctxt, &pvalue->body, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode master_styles */

   if (pvalue->m.master_stylesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Ns13_Master_styles (pctxt, &pvalue->master_styles, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode automatic_styles */

   if (pvalue->m.automatic_stylesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Ns13_Automatic_styles (pctxt, &pvalue->automatic_styles, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode styles */

   if (pvalue->m.stylesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Ns13_Styles (pctxt, &pvalue->styles, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode font_face_decls */

   if (pvalue->m.font_face_declsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Ns13_Font_face_decls (pctxt, &pvalue->font_face_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode scripts */

   if (pvalue->m.scriptsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
         asn1E_Ns13_Scripts (pctxt, &pvalue->scripts, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode settings */

   if (pvalue->m.settingsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
         asn1E_Ns13_Settings (pctxt, &pvalue->settings, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode meta */

   if (pvalue->m.metaPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Ns13_Meta (pctxt, &pvalue->meta, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode version */

   if (pvalue->m.versionPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->version, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode mimetype */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_utf8str (pctxt, pvalue->mimetype, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Document (OSCTXT* pctxt, Ns13_Document* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:mimetype=\""), 16);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->mimetype, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.versionPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:version=\""), 15);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->version, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode meta */

   if (pvalue->m.metaPresent) {
      stat = XmlEnc_Ns13_Meta (pctxt, &pvalue->meta
         , OSUTF8("meta"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode settings */

   if (pvalue->m.settingsPresent) {
      stat = XmlEnc_Ns13_Settings (pctxt, &pvalue->settings
         , OSUTF8("settings"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode scripts */

   if (pvalue->m.scriptsPresent) {
      stat = XmlEnc_Ns13_Scripts (pctxt, &pvalue->scripts
         , OSUTF8("scripts"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode font_face_decls */

   if (pvalue->m.font_face_declsPresent) {
      stat = XmlEnc_Ns13_Font_face_decls (pctxt, &pvalue->font_face_decls
         , OSUTF8("font-face-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode styles */

   if (pvalue->m.stylesPresent) {
      stat = XmlEnc_Ns13_Styles (pctxt, &pvalue->styles
         , OSUTF8("styles"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode automatic_styles */

   if (pvalue->m.automatic_stylesPresent) {
      stat = XmlEnc_Ns13_Automatic_styles (pctxt, &pvalue->automatic_styles
         , OSUTF8("automatic-styles"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode master_styles */

   if (pvalue->m.master_stylesPresent) {
      stat = XmlEnc_Ns13_Master_styles (pctxt, &pvalue->master_styles
         , OSUTF8("master-styles"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode body */

   stat = XmlEnc_Ns13_Body (pctxt, &pvalue->body, OSUTF8("body"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Change_info                                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Change_info (OSCTXT* pctxt,
   Ns13_Change_info *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode p_list */

   pnode2 = pvalue->p_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Odf_P (pctxt, (Odf_P*)((Odf_P*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode date */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      asn1E_Elements_Date (pctxt, pvalue->date, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode creator */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      asn1E_Creator (pctxt, pvalue->creator, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Change_info (OSCTXT* pctxt, Ns13_Change_info* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode creator */

   stat = XmlEnc_Creator (pctxt, pvalue->creator
      , OSUTF8("creator"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   /* encode date */

   stat = XmlEnc_Elements_Date (pctxt, pvalue->date
      , OSUTF8("date"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   /* encode p_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   { OSRTDListNode* pnode = pvalue->p_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Odf_P (pctxt, ((Odf_P*)pnode->data)
         , OSUTF8("p"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Document_content                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Document_content (OSCTXT* pctxt,
   Ns13_Document_content *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode body */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
      asn1E_Ns13_Body (pctxt, &pvalue->body, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode automatic_styles */

   if (pvalue->m.automatic_stylesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
         asn1E_Ns13_Automatic_styles (pctxt, &pvalue->automatic_styles, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode font_face_decls */

   if (pvalue->m.font_face_declsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Ns13_Font_face_decls (pctxt, &pvalue->font_face_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode scripts */

   if (pvalue->m.scriptsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
         asn1E_Ns13_Scripts (pctxt, &pvalue->scripts, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode version */

   if (pvalue->m.versionPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->version, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Document_content (OSCTXT* pctxt, 
   Ns13_Document_content* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.versionPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:version=\""), 15);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->version, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode scripts */

   if (pvalue->m.scriptsPresent) {
      stat = XmlEnc_Ns13_Scripts (pctxt, &pvalue->scripts
         , OSUTF8("scripts"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode font_face_decls */

   if (pvalue->m.font_face_declsPresent) {
      stat = XmlEnc_Ns13_Font_face_decls (pctxt, &pvalue->font_face_decls
         , OSUTF8("font-face-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode automatic_styles */

   if (pvalue->m.automatic_stylesPresent) {
      stat = XmlEnc_Ns13_Automatic_styles (pctxt, &pvalue->automatic_styles
         , OSUTF8("automatic-styles"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode body */

   stat = XmlEnc_Ns13_Body (pctxt, &pvalue->body, OSUTF8("body"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Document_styles                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Document_styles (OSCTXT* pctxt,
   Ns13_Document_styles *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode master_styles */

   if (pvalue->m.master_stylesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
         asn1E_Ns13_Master_styles (pctxt, &pvalue->master_styles, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode automatic_styles */

   if (pvalue->m.automatic_stylesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
         asn1E_Ns13_Automatic_styles (pctxt, &pvalue->automatic_styles, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode styles */

   if (pvalue->m.stylesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Ns13_Styles (pctxt, &pvalue->styles, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode font_face_decls */

   if (pvalue->m.font_face_declsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
         asn1E_Ns13_Font_face_decls (pctxt, &pvalue->font_face_decls, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode version */

   if (pvalue->m.versionPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->version, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Document_styles (OSCTXT* pctxt, Ns13_Document_styles* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.versionPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:version=\""), 15);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->version, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode font_face_decls */

   if (pvalue->m.font_face_declsPresent) {
      stat = XmlEnc_Ns13_Font_face_decls (pctxt, &pvalue->font_face_decls
         , OSUTF8("font-face-decls"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode styles */

   if (pvalue->m.stylesPresent) {
      stat = XmlEnc_Ns13_Styles (pctxt, &pvalue->styles
         , OSUTF8("styles"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode automatic_styles */

   if (pvalue->m.automatic_stylesPresent) {
      stat = XmlEnc_Ns13_Automatic_styles (pctxt, &pvalue->automatic_styles
         , OSUTF8("automatic-styles"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode master_styles */

   if (pvalue->m.master_stylesPresent) {
      stat = XmlEnc_Ns13_Master_styles (pctxt, &pvalue->master_styles
         , OSUTF8("master-styles"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Document_meta                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Document_meta (OSCTXT* pctxt,
   Ns13_Document_meta *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode meta */

   if (pvalue->m.metaPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
         asn1E_Ns13_Meta (pctxt, &pvalue->meta, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode version */

   if (pvalue->m.versionPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->version, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Document_meta (OSCTXT* pctxt, Ns13_Document_meta* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.versionPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:version=\""), 15);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->version, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode meta */

   if (pvalue->m.metaPresent) {
      stat = XmlEnc_Ns13_Meta (pctxt, &pvalue->meta
         , OSUTF8("meta"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Document_settings                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns13_Document_settings (OSCTXT* pctxt,
   Ns13_Document_settings *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode settings */

   if (pvalue->m.settingsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
         asn1E_Ns13_Settings (pctxt, &pvalue->settings, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode version */

   if (pvalue->m.versionPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->version, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns13_Document_settings (OSCTXT* pctxt, 
   Ns13_Document_settings* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.versionPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:version=\""), 15);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->version, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   /* encode settings */

   if (pvalue->m.settingsPresent) {
      stat = XmlEnc_Ns13_Settings (pctxt, &pvalue->settings
         , OSUTF8("settings"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

int XmlEnc_Ns13_Document_PDU (OSCTXT* pctxt, Ns13_Document* pvalue)
{
   int stat;
   const OSUTF8CHAR* nsPrefix = 0;

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns1"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns2"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:config:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns3"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("xlink"), 
      OSUTF8("http://www.w3.org/1999/xlink"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns4"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:form:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns5"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:chart:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns6"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:script:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns7"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns8"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:style:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns9"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:animation:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns10"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:presentation:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns11"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:smil-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("xforms"), 
      OSUTF8("http://www.w3.org/2002/xforms"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns12"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns13"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:office:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns14"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns15"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:table:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("mathml"), 
      OSUTF8("http://www.w3.org/1998/Math/MathML"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns17"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:text:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns16"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:meta:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("elements"), 
      OSUTF8("http://purl.org/dc/elements/1.1/"), FALSE);

   nsPrefix = rtXmlNSGetPrefix (pctxt, 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   stat = rtXmlEncStartDocument (pctxt);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncStartElement (pctxt, OSUTF8("document"), nsPrefix, FALSE);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncNSAttrs (pctxt);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncXSIAttrs (pctxt, FALSE);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = XmlEnc_Ns13_Document (pctxt, pvalue, 0, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncEndElement (pctxt, OSUTF8("document"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return stat;
}
int XmlEnc_Ns13_Document_content_PDU (OSCTXT* pctxt, Ns13_Document_content* pvalue)
{
   int stat;
   const OSUTF8CHAR* nsPrefix = 0;

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns1"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns2"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:config:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns3"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("xlink"), 
      OSUTF8("http://www.w3.org/1999/xlink"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns4"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:form:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns5"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:chart:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns6"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:script:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns7"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns8"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:style:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns9"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:animation:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns10"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:presentation:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns11"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:smil-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("xforms"), 
      OSUTF8("http://www.w3.org/2002/xforms"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns12"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns13"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:office:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns14"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns15"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:table:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("mathml"), 
      OSUTF8("http://www.w3.org/1998/Math/MathML"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns17"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:text:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns16"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:meta:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("elements"), 
      OSUTF8("http://purl.org/dc/elements/1.1/"), FALSE);

   nsPrefix = rtXmlNSGetPrefix (pctxt, 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   stat = rtXmlEncStartDocument (pctxt);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncStartElement (pctxt, OSUTF8("document-content"), nsPrefix, FALSE);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncNSAttrs (pctxt);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncXSIAttrs (pctxt, FALSE);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = XmlEnc_Ns13_Document_content (pctxt, pvalue, 0, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncEndElement (pctxt, OSUTF8("document-content"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return stat;
}
int XmlEnc_Ns13_Document_styles_PDU (OSCTXT* pctxt, Ns13_Document_styles* pvalue)
{
   int stat;
   const OSUTF8CHAR* nsPrefix = 0;

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns1"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns2"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:config:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns3"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("xlink"), 
      OSUTF8("http://www.w3.org/1999/xlink"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns4"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:form:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns5"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:chart:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns6"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:script:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns7"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns8"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:style:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns9"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:animation:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns10"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:presentation:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns11"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:smil-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("xforms"), 
      OSUTF8("http://www.w3.org/2002/xforms"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns12"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns13"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:office:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns14"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns15"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:table:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("mathml"), 
      OSUTF8("http://www.w3.org/1998/Math/MathML"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns17"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:text:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns16"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:meta:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("elements"), 
      OSUTF8("http://purl.org/dc/elements/1.1/"), FALSE);

   nsPrefix = rtXmlNSGetPrefix (pctxt, 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   stat = rtXmlEncStartDocument (pctxt);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncStartElement (pctxt, OSUTF8("document-styles"), nsPrefix, FALSE);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncNSAttrs (pctxt);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncXSIAttrs (pctxt, FALSE);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = XmlEnc_Ns13_Document_styles (pctxt, pvalue, 0, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncEndElement (pctxt, OSUTF8("document-styles"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return stat;
}
int XmlEnc_Ns13_Document_meta_PDU (OSCTXT* pctxt, Ns13_Document_meta* pvalue)
{
   int stat;
   const OSUTF8CHAR* nsPrefix = 0;

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns1"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns2"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:config:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns3"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("xlink"), 
      OSUTF8("http://www.w3.org/1999/xlink"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns4"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:form:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns5"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:chart:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns6"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:script:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns7"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns8"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:style:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns9"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:animation:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns10"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:presentation:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns11"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:smil-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("xforms"), 
      OSUTF8("http://www.w3.org/2002/xforms"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns12"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns13"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:office:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns14"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns15"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:table:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("mathml"), 
      OSUTF8("http://www.w3.org/1998/Math/MathML"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns17"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:text:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns16"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:meta:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("elements"), 
      OSUTF8("http://purl.org/dc/elements/1.1/"), FALSE);

   nsPrefix = rtXmlNSGetPrefix (pctxt, 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   stat = rtXmlEncStartDocument (pctxt);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncStartElement (pctxt, OSUTF8("document-meta"), nsPrefix, FALSE);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncNSAttrs (pctxt);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncXSIAttrs (pctxt, FALSE);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = XmlEnc_Ns13_Document_meta (pctxt, pvalue, 0, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncEndElement (pctxt, OSUTF8("document-meta"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return stat;
}
int XmlEnc_Ns13_Document_settings_PDU (OSCTXT* pctxt, Ns13_Document_settings* pvalue)
{
   int stat;
   const OSUTF8CHAR* nsPrefix = 0;

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns1"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns2"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:config:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns3"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("xlink"), 
      OSUTF8("http://www.w3.org/1999/xlink"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns4"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:form:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns5"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:chart:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns6"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:script:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns7"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns8"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:style:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns9"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:animation:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns10"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:presentation:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns11"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:smil-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("xforms"), 
      OSUTF8("http://www.w3.org/2002/xforms"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns12"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"), 
      FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns13"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:office:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns14"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns15"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:table:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("mathml"), 
      OSUTF8("http://www.w3.org/1998/Math/MathML"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns17"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:text:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("ns16"), 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:meta:1.0"), FALSE);

   rtXmlNSSetNamespace (pctxt, OSUTF8("elements"), 
      OSUTF8("http://purl.org/dc/elements/1.1/"), FALSE);

   nsPrefix = rtXmlNSGetPrefix (pctxt, 
      OSUTF8("urn:oasis:names:tc:opendocument:xmlns:office:1.0"));

   stat = rtXmlEncStartDocument (pctxt);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncStartElement (pctxt, OSUTF8("document-settings"), nsPrefix, FALSE);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncNSAttrs (pctxt);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncXSIAttrs (pctxt, FALSE);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = XmlEnc_Ns13_Document_settings (pctxt, pvalue, 0, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   stat = rtXmlEncEndElement (pctxt, OSUTF8("document-settings"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return stat;
}
