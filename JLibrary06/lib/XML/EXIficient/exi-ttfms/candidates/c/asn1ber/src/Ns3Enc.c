/**
 * This file was generated by the Objective Systems ASN1C Compiler
 * (http://www.obj-sys.com).  Version: 6.0B, Date: 18-Oct-2006.
 */
#include "Ns3.h"
#include "Odf.h"
#include "Ns13.h"
#include "Ns10.h"
#include "Ns15.h"
#include "Ns12.h"
#include "Ns7.h"
#include "Ns9.h"
#include "MathML.h"
#include "Ns8.h"
#include "rtxsrc/rtxCommon.h"

/**************************************************************/
/*                                                            */
/*  Display_name                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Display_name (OSCTXT* pctxt,
   Ns3_Display_name pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Display_name (OSCTXT* pctxt, Ns3_Display_name value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Caption_point_x                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Caption_point_x (OSCTXT* pctxt,
   Ns3_Caption_point_x pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Caption_point_x (OSCTXT* pctxt, Ns3_Caption_point_x value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Caption_point_y                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Caption_point_y (OSCTXT* pctxt,
   Ns3_Caption_point_y pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Caption_point_y (OSCTXT* pctxt, Ns3_Caption_point_y value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Class_names                                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Class_names (OSCTXT* pctxt,
   Ns3_Class_names *pvalue, ASN1TagType tagging)
{
   OSRTDListNode* pnode;
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   pnode = pvalue->tail;
   while (0 != pnode) {
      ll = xe_utf8str (pctxt, ((const OSUTF8CHAR*)pnode->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;

      pnode = pnode->prev;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Class_names (OSCTXT* pctxt, Ns3_Class_names* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (elemName != 0) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->head;
   while (0 != pnode) {
      stat = rtXmlEncUTF8Str (pctxt, ((const OSUTF8CHAR*)pnode->data)
         , OSUTF8(""), 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      OSRTSAFEPUTCHAR (pctxt, ' ');
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Corner_radius                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Corner_radius (OSCTXT* pctxt,
   Ns3_Corner_radius pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Corner_radius (OSCTXT* pctxt, Ns3_Corner_radius value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Id                                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Id (OSCTXT* pctxt,
   Ns3_Id pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Id (OSCTXT* pctxt, Ns3_Id value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Layer_1                                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Layer_1 (OSCTXT* pctxt,
   Ns3_Layer_1 pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Layer_1 (OSCTXT* pctxt, Ns3_Layer_1 value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Style_name                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Style_name (OSCTXT* pctxt,
   Ns3_Style_name *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_utf8str (pctxt, pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Style_name (OSCTXT* pctxt, Ns3_Style_name* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt_1, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Text_style_name                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Text_style_name (OSCTXT* pctxt,
   Ns3_Text_style_name *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_utf8str (pctxt, pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Text_style_name (OSCTXT* pctxt, Ns3_Text_style_name* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt_1, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Transform                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Transform (OSCTXT* pctxt,
   Ns3_Transform pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Transform (OSCTXT* pctxt, Ns3_Transform value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Z_index                                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Z_index (OSCTXT* pctxt,
   Ns3_Z_index *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_unsigned (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Z_index (OSCTXT* pctxt, Ns3_Z_index value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUInt (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Glue_point_align                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Glue_point_align (OSCTXT* pctxt,
   Ns3_Glue_point_align *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 7)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Glue_point_align (OSCTXT* pctxt, Ns3_Glue_point_align value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Glue_point_align_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Glue_point_x                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Glue_point_x (OSCTXT* pctxt,
   Ns3_Glue_point_x *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_utf8str (pctxt, pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Glue_point_x (OSCTXT* pctxt, Ns3_Glue_point_x* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt_1, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Glue_point_y                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Glue_point_y (OSCTXT* pctxt,
   Ns3_Glue_point_y *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_utf8str (pctxt, pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Glue_point_y (OSCTXT* pctxt, Ns3_Glue_point_y* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt_1, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Glue_point                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Glue_point (OSCTXT* pctxt,
   Ns3_Glue_point *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode y */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
      asn1E_Ns3_Glue_point_y (pctxt, &pvalue->y, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode x */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
      asn1E_Ns3_Glue_point_x (pctxt, &pvalue->x, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode id */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_unsigned (pctxt, &pvalue->id, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode align */

   if(pvalue->align < 0 || pvalue->align > 7)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      asn1E_Ns3_Glue_point_align (pctxt, &pvalue->align, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Glue_point (OSCTXT* pctxt, Ns3_Glue_point* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:align=\""), 12);

   if(pvalue->align < 0 || pvalue->align > 7)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Ns3_Glue_point_align (pctxt, pvalue->align, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   stat = rtXmlEncUIntAttr
      (pctxt, pvalue->id, OSUTF8("ns3:id"), 6);

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

   stat = XmlEnc_Ns3_Glue_point_x (pctxt, &pvalue->x, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

   stat = XmlEnc_Ns3_Glue_point_y (pctxt, &pvalue->y, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Rect_element                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Rect_element (OSCTXT* pctxt,
   Ns3_Rect_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Rect_element (OSCTXT* pctxt, Ns3_Rect_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Rect                                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Rect (OSCTXT* pctxt,
   Ns3_Rect *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Rect_element (pctxt, ((Ns3_Rect_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|23, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode glue_point_list */

   pnode2 = pvalue->glue_point_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|22, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|21,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|20,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|17,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|16,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|15,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|14,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x */

   if (pvalue->m.xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         xe_utf8str (pctxt, pvalue->x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|12,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         asn1E_Ns3_Z_index (pctxt, &pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Ns3_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_style_name */

   if (pvalue->m.text_style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Ns3_Text_style_name (pctxt, &pvalue->text_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns3_Layer_1 (pctxt, pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode corner_radius */

   if (pvalue->m.corner_radiusPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns3_Corner_radius (pctxt, pvalue->corner_radius, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Rect (OSCTXT* pctxt, Ns3_Rect* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.corner_radiusPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:corner-radius=\""), 20);

      stat = XmlEnc_Ns3_Corner_radius (pctxt, pvalue->corner_radius, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-style-name=\""), 22);

      stat = XmlEnc_Ns3_Text_style_name (pctxt, &pvalue->text_style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:transform=\""), 16);

      stat = XmlEnc_Ns3_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode glue_point_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->glue_point_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode->data)
         , OSUTF8("glue-point"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Rect_element (pctxt, ((Ns3_Rect_element*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Line_element                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Line_element (OSCTXT* pctxt,
   Ns3_Line_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Line_element (OSCTXT* pctxt, Ns3_Line_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Line                                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Line (OSCTXT* pctxt,
   Ns3_Line *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Line_element (pctxt, ((Ns3_Line_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|22, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode glue_point_list */

   pnode2 = pvalue->glue_point_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|21, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|20,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|17,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|16,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|15,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|14,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y2 */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
      asn1E_Y2 (pctxt, (Y2)pvalue->y2, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode y1 */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|12,
      asn1E_Y1 (pctxt, (Y1)pvalue->y1, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode x2 */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
      asn1E_X2 (pctxt, (X2)pvalue->x2, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode x1 */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
      asn1E_X1 (pctxt, (X1)pvalue->x1, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Ns3_Z_index (pctxt, &pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         asn1E_Ns3_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_style_name */

   if (pvalue->m.text_style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Ns3_Text_style_name (pctxt, &pvalue->text_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Layer_1 (pctxt, pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Line (OSCTXT* pctxt, Ns3_Line* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-style-name=\""), 22);

      stat = XmlEnc_Ns3_Text_style_name (pctxt, &pvalue->text_style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:transform=\""), 16);

      stat = XmlEnc_Ns3_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x1=\""), 10);

   stat = XmlEnc_X1 (pctxt, pvalue->x1, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x2=\""), 10);

   stat = XmlEnc_X2 (pctxt, pvalue->x2, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y1=\""), 10);

   stat = XmlEnc_Y1 (pctxt, pvalue->y1, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y2=\""), 10);

   stat = XmlEnc_Y2 (pctxt, pvalue->y2, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode glue_point_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->glue_point_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode->data)
         , OSUTF8("glue-point"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Line_element (pctxt, ((Ns3_Line_element*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Polyline_element                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Polyline_element (OSCTXT* pctxt,
   Ns3_Polyline_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Polyline_element (OSCTXT* pctxt, Ns3_Polyline_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Polyline                                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Polyline (OSCTXT* pctxt,
   Ns3_Polyline *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Polyline_element (pctxt, ((Ns3_Polyline_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|24, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode glue_point_list */

   pnode2 = pvalue->glue_point_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|23, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|22,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|21,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|20,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|17,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|16,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|15,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x */

   if (pvalue->m.xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|14,
         xe_utf8str (pctxt, pvalue->x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode viewBox */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
      asn1E_ViewBox (pctxt, (ViewBox*)&pvalue->viewBox, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         asn1E_Ns3_Z_index (pctxt, &pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Ns3_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_style_name */

   if (pvalue->m.text_style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Ns3_Text_style_name (pctxt, &pvalue->text_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode points */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
      xe_utf8str (pctxt, pvalue->points, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Layer_1 (pctxt, pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Polyline (OSCTXT* pctxt, Ns3_Polyline* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:points=\""), 13);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->points, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-style-name=\""), 22);

      stat = XmlEnc_Ns3_Text_style_name (pctxt, &pvalue->text_style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:transform=\""), 16);

      stat = XmlEnc_Ns3_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:viewBox=\""), 15);

   stat = XmlEnc_ViewBox (pctxt, &pvalue->viewBox, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode glue_point_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->glue_point_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode->data)
         , OSUTF8("glue-point"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Polyline_element (pctxt, 
         ((Ns3_Polyline_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Polygon_element                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Polygon_element (OSCTXT* pctxt,
   Ns3_Polygon_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Polygon_element (OSCTXT* pctxt, Ns3_Polygon_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Polygon                                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Polygon (OSCTXT* pctxt,
   Ns3_Polygon *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Polygon_element (pctxt, ((Ns3_Polygon_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|24, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode glue_point_list */

   pnode2 = pvalue->glue_point_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|23, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|22,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|21,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|20,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|17,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|16,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|15,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x */

   if (pvalue->m.xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|14,
         xe_utf8str (pctxt, pvalue->x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode viewBox */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
      asn1E_ViewBox (pctxt, (ViewBox*)&pvalue->viewBox, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         asn1E_Ns3_Z_index (pctxt, &pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Ns3_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_style_name */

   if (pvalue->m.text_style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Ns3_Text_style_name (pctxt, &pvalue->text_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode points */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
      xe_utf8str (pctxt, pvalue->points, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Layer_1 (pctxt, pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Polygon (OSCTXT* pctxt, Ns3_Polygon* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:points=\""), 13);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->points, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-style-name=\""), 22);

      stat = XmlEnc_Ns3_Text_style_name (pctxt, &pvalue->text_style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:transform=\""), 16);

      stat = XmlEnc_Ns3_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:viewBox=\""), 15);

   stat = XmlEnc_ViewBox (pctxt, &pvalue->viewBox, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode glue_point_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->glue_point_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode->data)
         , OSUTF8("glue-point"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Polygon_element (pctxt, 
         ((Ns3_Polygon_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Regular_polygon_concave                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Regular_polygon_concave (OSCTXT* pctxt,
   Ns3_Regular_polygon_concave *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Regular_polygon_concave (OSCTXT* pctxt, 
   Ns3_Regular_polygon_concave value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Regular_polygon_concave_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Regular_polygon_element                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Regular_polygon_element (OSCTXT* pctxt,
   Ns3_Regular_polygon_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Regular_polygon_element (OSCTXT* pctxt, 
   Ns3_Regular_polygon_element* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Regular_polygon                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Regular_polygon (OSCTXT* pctxt,
   Ns3_Regular_polygon *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Regular_polygon_element (pctxt, ((Ns3_Regular_polygon_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|25, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode glue_point_list */

   pnode2 = pvalue->glue_point_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|24, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|23,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|22,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|21,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|20,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|17,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|16,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x */

   if (pvalue->m.xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|15,
         xe_utf8str (pctxt, pvalue->x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|14,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
         asn1E_Ns3_Z_index (pctxt, &pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         asn1E_Ns3_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_style_name */

   if (pvalue->m.text_style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Ns3_Text_style_name (pctxt, &pvalue->text_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode sharpness */

   if (pvalue->m.sharpnessPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         xe_utf8str (pctxt, pvalue->sharpness, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns3_Layer_1 (pctxt, pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode corners */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
      xe_unsigned (pctxt, &pvalue->corners, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode concave */

   if(pvalue->concave < 0 || pvalue->concave > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      asn1E_Ns3_Regular_polygon_concave (pctxt, &pvalue->concave, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Regular_polygon (OSCTXT* pctxt, Ns3_Regular_polygon* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:concave=\""), 14);

   if(pvalue->concave < 0 || pvalue->concave > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Ns3_Regular_polygon_concave (pctxt, pvalue->concave, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   stat = rtXmlEncUIntAttr
      (pctxt, pvalue->corners, OSUTF8("ns3:corners"), 11);

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.sharpnessPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:sharpness=\""), 16);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->sharpness, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-style-name=\""), 22);

      stat = XmlEnc_Ns3_Text_style_name (pctxt, &pvalue->text_style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:transform=\""), 16);

      stat = XmlEnc_Ns3_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode glue_point_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->glue_point_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode->data)
         , OSUTF8("glue-point"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Regular_polygon_element (pctxt, 
         ((Ns3_Regular_polygon_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Path_element                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Path_element (OSCTXT* pctxt,
   Ns3_Path_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Path_element (OSCTXT* pctxt, Ns3_Path_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Path                                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Path (OSCTXT* pctxt,
   Ns3_Path *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Path_element (pctxt, ((Ns3_Path_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|24, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode glue_point_list */

   pnode2 = pvalue->glue_point_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|23, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|22,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|21,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|20,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|17,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|16,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|15,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x */

   if (pvalue->m.xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|14,
         xe_utf8str (pctxt, pvalue->x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode viewBox */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
      asn1E_ViewBox (pctxt, (ViewBox*)&pvalue->viewBox, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode d */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
      asn1E_D (pctxt, (D)pvalue->d, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Ns3_Z_index (pctxt, &pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         asn1E_Ns3_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_style_name */

   if (pvalue->m.text_style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Ns3_Text_style_name (pctxt, &pvalue->text_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Layer_1 (pctxt, pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Path (OSCTXT* pctxt, Ns3_Path* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-style-name=\""), 22);

      stat = XmlEnc_Ns3_Text_style_name (pctxt, &pvalue->text_style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:transform=\""), 16);

      stat = XmlEnc_Ns3_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:d=\""), 9);

   stat = XmlEnc_D (pctxt, pvalue->d, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:viewBox=\""), 15);

   stat = XmlEnc_ViewBox (pctxt, &pvalue->viewBox, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode glue_point_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->glue_point_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode->data)
         , OSUTF8("glue-point"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Path_element (pctxt, ((Ns3_Path_element*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Circle_kind                                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Circle_kind (OSCTXT* pctxt,
   Ns3_Circle_kind *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 3)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Circle_kind (OSCTXT* pctxt, Ns3_Circle_kind value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Circle_kind_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Circle_element                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Circle_element (OSCTXT* pctxt,
   Ns3_Circle_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Circle_element (OSCTXT* pctxt, Ns3_Circle_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Circle                                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Circle (OSCTXT* pctxt,
   Ns3_Circle *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Circle_element (pctxt, ((Ns3_Circle_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|28, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode glue_point_list */

   pnode2 = pvalue->glue_point_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|27, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|26,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|25,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|24,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|23,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|22,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|21,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|20,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x */

   if (pvalue->m.xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         xe_utf8str (pctxt, pvalue->x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|17,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode r */

   if (pvalue->m.rPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|16,
         asn1E_R (pctxt, (R)pvalue->r, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|15,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode cy */

   if (pvalue->m.cyPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|14,
         asn1E_Cy (pctxt, (Cy)pvalue->cy, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode cx */

   if (pvalue->m.cxPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         asn1E_Cx (pctxt, (Cx)pvalue->cx, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
         asn1E_Ns3_Z_index (pctxt, &pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         asn1E_Ns3_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_style_name */

   if (pvalue->m.text_style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Ns3_Text_style_name (pctxt, &pvalue->text_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode start_angle */

   if (pvalue->m.start_anglePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         xe_real (pctxt, &pvalue->start_angle, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns3_Layer_1 (pctxt, pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode kind */

   if (pvalue->m.kindPresent) {
      if(pvalue->kind < 0 || pvalue->kind > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns3_Circle_kind (pctxt, &pvalue->kind, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_angle */

   if (pvalue->m.end_anglePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_real (pctxt, &pvalue->end_angle, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Circle (OSCTXT* pctxt, Ns3_Circle* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_anglePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:end-angle=\""), 16);

      stat = rtXmlEncDouble (pctxt, pvalue->end_angle, 0, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.kindPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:kind=\""), 11);

      if(pvalue->kind < 0 || pvalue->kind > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Circle_kind (pctxt, pvalue->kind, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.start_anglePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:start-angle=\""), 18);

      stat = rtXmlEncDouble (pctxt, pvalue->start_angle, 0, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-style-name=\""), 22);

      stat = XmlEnc_Ns3_Text_style_name (pctxt, &pvalue->text_style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:transform=\""), 16);

      stat = XmlEnc_Ns3_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.cxPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:cx=\""), 10);

      stat = XmlEnc_Cx (pctxt, pvalue->cx, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.cyPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:cy=\""), 10);

      stat = XmlEnc_Cy (pctxt, pvalue->cy, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.rPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:r=\""), 9);

      stat = XmlEnc_R (pctxt, pvalue->r, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode glue_point_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->glue_point_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode->data)
         , OSUTF8("glue-point"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Circle_element (pctxt, 
         ((Ns3_Circle_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Ellipse_kind                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Ellipse_kind (OSCTXT* pctxt,
   Ns3_Ellipse_kind *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 3)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Ellipse_kind (OSCTXT* pctxt, Ns3_Ellipse_kind value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Ellipse_kind_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Ellipse_element                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Ellipse_element (OSCTXT* pctxt,
   Ns3_Ellipse_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Ellipse_element (OSCTXT* pctxt, Ns3_Ellipse_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Ellipse                                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Ellipse (OSCTXT* pctxt,
   Ns3_Ellipse *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Ellipse_element (pctxt, ((Ns3_Ellipse_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|29, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode glue_point_list */

   pnode2 = pvalue->glue_point_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|28, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|27,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|26,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|25,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|24,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|23,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|22,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|21,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|20,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x */

   if (pvalue->m.xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         xe_utf8str (pctxt, pvalue->x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode ry */

   if (pvalue->m.ryPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|17,
         asn1E_Ry (pctxt, (Ry)pvalue->ry, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode rx */

   if (pvalue->m.rxPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|16,
         asn1E_Rx (pctxt, (Rx)pvalue->rx, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|15,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode cy */

   if (pvalue->m.cyPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|14,
         asn1E_Cy (pctxt, (Cy)pvalue->cy, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode cx */

   if (pvalue->m.cxPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         asn1E_Cx (pctxt, (Cx)pvalue->cx, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
         asn1E_Ns3_Z_index (pctxt, &pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         asn1E_Ns3_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_style_name */

   if (pvalue->m.text_style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Ns3_Text_style_name (pctxt, &pvalue->text_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode start_angle */

   if (pvalue->m.start_anglePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         xe_real (pctxt, &pvalue->start_angle, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns3_Layer_1 (pctxt, pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode kind */

   if (pvalue->m.kindPresent) {
      if(pvalue->kind < 0 || pvalue->kind > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns3_Ellipse_kind (pctxt, &pvalue->kind, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_angle */

   if (pvalue->m.end_anglePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_real (pctxt, &pvalue->end_angle, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Ellipse (OSCTXT* pctxt, Ns3_Ellipse* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_anglePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:end-angle=\""), 16);

      stat = rtXmlEncDouble (pctxt, pvalue->end_angle, 0, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.kindPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:kind=\""), 11);

      if(pvalue->kind < 0 || pvalue->kind > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Ellipse_kind (pctxt, pvalue->kind, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.start_anglePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:start-angle=\""), 18);

      stat = rtXmlEncDouble (pctxt, pvalue->start_angle, 0, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-style-name=\""), 22);

      stat = XmlEnc_Ns3_Text_style_name (pctxt, &pvalue->text_style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:transform=\""), 16);

      stat = XmlEnc_Ns3_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.cxPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:cx=\""), 10);

      stat = XmlEnc_Cx (pctxt, pvalue->cx, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.cyPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:cy=\""), 10);

      stat = XmlEnc_Cy (pctxt, pvalue->cy, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.rxPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:rx=\""), 10);

      stat = XmlEnc_Rx (pctxt, pvalue->rx, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.ryPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:ry=\""), 10);

      stat = XmlEnc_Ry (pctxt, pvalue->ry, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode glue_point_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->glue_point_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode->data)
         , OSUTF8("glue-point"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Ellipse_element (pctxt, 
         ((Ns3_Ellipse_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Page_thumbnail                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Page_thumbnail (OSCTXT* pctxt,
   Ns3_Page_thumbnail *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|22,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|21,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|20,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|17,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|16,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x */

   if (pvalue->m.xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|15,
         xe_utf8str (pctxt, pvalue->x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|14,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode user_transformed */

   if (pvalue->m.user_transformedPresent) {
      if(pvalue->user_transformed < 0 || pvalue->user_transformed > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|12,
         asn1E_Ns10_User_transformed (pctxt, (Ns10_User_transformed*)&pvalue->user_transformed, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode placeholder */

   if (pvalue->m.placeholderPresent) {
      if(pvalue->placeholder < 0 || pvalue->placeholder > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
         asn1E_Ns10_Placeholder_1 (pctxt, (Ns10_Placeholder_1*)&pvalue->placeholder, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_ */

   if (pvalue->m.class_Present) {
      if(pvalue->class_ < 0 || pvalue->class_ > 15)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         asn1E_Ns10_Class (pctxt, (Ns10_Class*)&pvalue->class_, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Ns3_Z_index (pctxt, &pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         asn1E_Ns3_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode page_number */

   if (pvalue->m.page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_unsigned (pctxt, &pvalue->page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Layer_1 (pctxt, pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Page_thumbnail (OSCTXT* pctxt, Ns3_Page_thumbnail* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.page_numberPresent) {
      stat = rtXmlEncUIntAttr
         (pctxt, pvalue->page_number, OSUTF8("ns3:page-number"), 15);
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:transform=\""), 16);

      stat = XmlEnc_Ns3_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class=\""), 13);

      if(pvalue->class_ < 0 || pvalue->class_ > 15)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns10_Class (pctxt, pvalue->class_, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.placeholderPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:placeholder=\""), 19);

      if(pvalue->placeholder < 0 || pvalue->placeholder > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns10_Placeholder_1 (pctxt, pvalue->placeholder, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.user_transformedPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:user-transformed=\""), 24);

      if(pvalue->user_transformed < 0 || pvalue->user_transformed > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns10_User_transformed (pctxt, pvalue->user_transformed
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Measure_element                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Measure_element (OSCTXT* pctxt,
   Ns3_Measure_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Measure_element (OSCTXT* pctxt, Ns3_Measure_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Measure                                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Measure (OSCTXT* pctxt,
   Ns3_Measure *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Measure_element (pctxt, ((Ns3_Measure_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|22, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode glue_point_list */

   pnode2 = pvalue->glue_point_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|21, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|20,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|17,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|16,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|15,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|14,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y2 */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
      asn1E_Y2 (pctxt, (Y2)pvalue->y2, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode y1 */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|12,
      asn1E_Y1 (pctxt, (Y1)pvalue->y1, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode x2 */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
      asn1E_X2 (pctxt, (X2)pvalue->x2, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode x1 */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
      asn1E_X1 (pctxt, (X1)pvalue->x1, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Ns3_Z_index (pctxt, &pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         asn1E_Ns3_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_style_name */

   if (pvalue->m.text_style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Ns3_Text_style_name (pctxt, &pvalue->text_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Layer_1 (pctxt, pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Measure (OSCTXT* pctxt, Ns3_Measure* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-style-name=\""), 22);

      stat = XmlEnc_Ns3_Text_style_name (pctxt, &pvalue->text_style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:transform=\""), 16);

      stat = XmlEnc_Ns3_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x1=\""), 10);

   stat = XmlEnc_X1 (pctxt, pvalue->x1, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x2=\""), 10);

   stat = XmlEnc_X2 (pctxt, pvalue->x2, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y1=\""), 10);

   stat = XmlEnc_Y1 (pctxt, pvalue->y1, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y2=\""), 10);

   stat = XmlEnc_Y2 (pctxt, pvalue->y2, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode glue_point_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->glue_point_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode->data)
         , OSUTF8("glue-point"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Measure_element (pctxt, 
         ((Ns3_Measure_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Caption_element                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Caption_element (OSCTXT* pctxt,
   Ns3_Caption_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Caption_element (OSCTXT* pctxt, Ns3_Caption_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Caption                                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Caption (OSCTXT* pctxt,
   Ns3_Caption *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Caption_element (pctxt, ((Ns3_Caption_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|25, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode glue_point_list */

   pnode2 = pvalue->glue_point_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|24, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|23,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|22,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|21,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|20,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|17,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|16,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x */

   if (pvalue->m.xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|15,
         xe_utf8str (pctxt, pvalue->x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|14,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
         asn1E_Ns3_Z_index (pctxt, &pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         asn1E_Ns3_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_style_name */

   if (pvalue->m.text_style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Ns3_Text_style_name (pctxt, &pvalue->text_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns3_Layer_1 (pctxt, pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode corner_radius */

   if (pvalue->m.corner_radiusPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns3_Corner_radius (pctxt, pvalue->corner_radius, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode caption_point_y */

   if (pvalue->m.caption_point_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns3_Caption_point_y (pctxt, pvalue->caption_point_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode caption_point_x */

   if (pvalue->m.caption_point_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns3_Caption_point_x (pctxt, pvalue->caption_point_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Caption (OSCTXT* pctxt, Ns3_Caption* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.caption_point_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:caption-point-x=\""), 22);

      stat = XmlEnc_Ns3_Caption_point_x (pctxt, pvalue->caption_point_x
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.caption_point_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:caption-point-y=\""), 22);

      stat = XmlEnc_Ns3_Caption_point_y (pctxt, pvalue->caption_point_y
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.corner_radiusPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:corner-radius=\""), 20);

      stat = XmlEnc_Ns3_Corner_radius (pctxt, pvalue->corner_radius, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-style-name=\""), 22);

      stat = XmlEnc_Ns3_Text_style_name (pctxt, &pvalue->text_style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:transform=\""), 16);

      stat = XmlEnc_Ns3_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode glue_point_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->glue_point_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode->data)
         , OSUTF8("glue-point"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Caption_element (pctxt, 
         ((Ns3_Caption_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Connector_line_skew_element                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Connector_line_skew_element (OSCTXT* pctxt,
   Ns3_Connector_line_skew_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_utf8str (pctxt, pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
            xe_utf8str (pctxt, pvalue->u.alt_2, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Connector_line_skew_element (OSCTXT* pctxt, 
   Ns3_Connector_line_skew_element* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt_1, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode alt_2 */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt_2, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Connector_type                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Connector_type (OSCTXT* pctxt,
   Ns3_Connector_type *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 3)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Connector_type (OSCTXT* pctxt, Ns3_Connector_type value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Connector_type_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Connector_element                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Connector_element (OSCTXT* pctxt,
   Ns3_Connector_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Connector_element (OSCTXT* pctxt, 
   Ns3_Connector_element* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Connector                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Connector (OSCTXT* pctxt,
   Ns3_Connector *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Connector_element (pctxt, ((Ns3_Connector_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|28, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode glue_point_list */

   pnode2 = pvalue->glue_point_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|27, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|26,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|25,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|24,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|23,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|22,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|21,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|20,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y2 */

   if (pvalue->m.y2Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         asn1E_Y2 (pctxt, (Y2)pvalue->y2, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y1 */

   if (pvalue->m.y1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         asn1E_Y1 (pctxt, (Y1)pvalue->y1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x2 */

   if (pvalue->m.x2Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|17,
         asn1E_X2 (pctxt, (X2)pvalue->x2, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x1 */

   if (pvalue->m.x1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|16,
         asn1E_X1 (pctxt, (X1)pvalue->x1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|15,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|14,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         asn1E_Ns3_Z_index (pctxt, &pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode type */

   if (pvalue->m.typePresent) {
      if(pvalue->type < 0 || pvalue->type > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|12,
         asn1E_Ns3_Connector_type (pctxt, &pvalue->type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
         asn1E_Ns3_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_style_name */

   if (pvalue->m.text_style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Ns3_Text_style_name (pctxt, &pvalue->text_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode start_shape */

   if (pvalue->m.start_shapePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         xe_utf8str (pctxt, pvalue->start_shape, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode start_glue_point */

   if (pvalue->m.start_glue_pointPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         xe_unsigned (pctxt, &pvalue->start_glue_point, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode line_skew */

   if (pvalue->m.line_skewPresent) {
      pnode2 = pvalue->line_skew.tail;
      while (0 != pnode2) {
         ll = asn1E_Ns3_Connector_line_skew_element (pctxt, ((Ns3_Connector_line_skew_element*)pnode2->data), ASN1EXPL);
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll2 += ll;

         pnode2 = pnode2->prev;
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5, ll2);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      else { ll1 += ll; ll2 = 0; }
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns3_Layer_1 (pctxt, pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_shape */

   if (pvalue->m.end_shapePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_utf8str (pctxt, pvalue->end_shape, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_glue_point */

   if (pvalue->m.end_glue_pointPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_unsigned (pctxt, &pvalue->end_glue_point, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Connector (OSCTXT* pctxt, Ns3_Connector* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_glue_pointPresent) {
      stat = rtXmlEncUIntAttr
         (pctxt, pvalue->end_glue_point, OSUTF8("ns3:end-glue-point"), 18);
   }

   if (pvalue->m.end_shapePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:end-shape=\""), 16);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->end_shape, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.line_skewPresent) {
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.start_glue_pointPresent) {
      stat = rtXmlEncUIntAttr
         (pctxt, pvalue->start_glue_point
            , OSUTF8("ns3:start-glue-point"), 20);
   }

   if (pvalue->m.start_shapePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:start-shape=\""), 18);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->start_shape, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-style-name=\""), 22);

      stat = XmlEnc_Ns3_Text_style_name (pctxt, &pvalue->text_style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:transform=\""), 16);

      stat = XmlEnc_Ns3_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:type=\""), 11);

      if(pvalue->type < 0 || pvalue->type > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Connector_type (pctxt, pvalue->type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.x1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x1=\""), 10);

      stat = XmlEnc_X1 (pctxt, pvalue->x1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.x2Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x2=\""), 10);

      stat = XmlEnc_X2 (pctxt, pvalue->x2, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.y1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y1=\""), 10);

      stat = XmlEnc_Y1 (pctxt, pvalue->y1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.y2Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y2=\""), 10);

      stat = XmlEnc_Y2 (pctxt, pvalue->y2, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode glue_point_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->glue_point_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode->data)
         , OSUTF8("glue-point"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Connector_element (pctxt, 
         ((Ns3_Connector_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Control                                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Control (OSCTXT* pctxt,
   Ns3_Control *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode glue_point_list */

   pnode2 = pvalue->glue_point_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|21, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|20,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|17,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|16,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|15,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|14,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x */

   if (pvalue->m.xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         xe_utf8str (pctxt, pvalue->x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|12,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         asn1E_Ns3_Z_index (pctxt, &pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Ns3_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_style_name */

   if (pvalue->m.text_style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Ns3_Text_style_name (pctxt, &pvalue->text_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns3_Layer_1 (pctxt, pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode control */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_utf8str (pctxt, pvalue->control, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Control (OSCTXT* pctxt, Ns3_Control* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:control=\""), 14);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->control, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-style-name=\""), 22);

      stat = XmlEnc_Ns3_Text_style_name (pctxt, &pvalue->text_style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:transform=\""), 16);

      stat = XmlEnc_Ns3_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode glue_point_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->glue_point_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode->data)
         , OSUTF8("glue-point"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Custom_shape_element                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Custom_shape_element (OSCTXT* pctxt,
   Ns3_Custom_shape_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Custom_shape_element (OSCTXT* pctxt, 
   Ns3_Custom_shape_element* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_concentric_gradient_fill_allowed        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_concentric_gradient_fill_allowed (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_concentric_gradient_fill_allowed *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_concentric_gradient_fill_allowed 
   (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_concentric_gradient_fill_allowed value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_concentric_gradient_fill_allowed_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_extrusion                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_extrusion (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_extrusion *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_extrusion (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_extrusion value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_extrusion_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_extrusion_allowed                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_extrusion_allowed (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_extrusion_allowed *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_extrusion_allowed (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_extrusion_allowed value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_extrusion_allowed_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_extrusion_color                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_extrusion_color (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_extrusion_color *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_extrusion_color (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_extrusion_color value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_extrusion_color_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_extrusion_depth_element                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_extrusion_depth_element (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_extrusion_depth_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_real (pctxt, &pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_utf8str (pctxt, pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_extrusion_depth_element (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_extrusion_depth_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncDouble (pctxt, pvalue->u.alt, 0, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt_1, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_extrusion_first_light_harsh             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_extrusion_first_light_harsh (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_extrusion_first_light_harsh *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_extrusion_first_light_harsh (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_extrusion_first_light_harsh value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_extrusion_first_light_harsh_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_extrusion_light_face                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_extrusion_light_face (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_extrusion_light_face *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_extrusion_light_face (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_extrusion_light_face value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_extrusion_light_face_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_extrusion_metal                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_extrusion_metal (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_extrusion_metal *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_extrusion_metal (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_extrusion_metal value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_extrusion_metal_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_extrusion_origin_element                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_extrusion_origin_element (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_extrusion_origin_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_real (pctxt, &pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_extrusion_origin_element (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_extrusion_origin_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncDouble (pctxt, pvalue->u.alt, 0, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_extrusion_rotation_angle_element        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_extrusion_rotation_angle_element (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_extrusion_rotation_angle_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_real (pctxt, &pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_extrusion_rotation_angle_element 
   (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_extrusion_rotation_angle_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncDouble (pctxt, pvalue->u.alt, 0, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_extrusion_second_light_harsh            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_extrusion_second_light_harsh (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_extrusion_second_light_harsh *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_extrusion_second_light_harsh (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_extrusion_second_light_harsh value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_extrusion_second_light_harsh_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_extrusion_skew_element                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_extrusion_skew_element (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_extrusion_skew_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_real (pctxt, &pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_extrusion_skew_element (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_extrusion_skew_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncDouble (pctxt, pvalue->u.alt, 0, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_glue_point_type                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_glue_point_type (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_glue_point_type *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_glue_point_type (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_glue_point_type value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_glue_point_type_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_mirror_horizontal                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_mirror_horizontal (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_mirror_horizontal *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_mirror_horizontal (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_mirror_horizontal value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_mirror_horizontal_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_mirror_vertical                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_mirror_vertical (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_mirror_vertical *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_mirror_vertical (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_mirror_vertical value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_mirror_vertical_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_text_path                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_text_path (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_text_path *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_text_path (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_text_path value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_text_path_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_text_path_allowed                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_text_path_allowed (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_text_path_allowed *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_text_path_allowed (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_text_path_allowed value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_text_path_allowed_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_text_path_mode                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_text_path_mode (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_text_path_mode *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_text_path_mode (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_text_path_mode value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_text_path_mode_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_text_path_same_letter_heights           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_text_path_same_letter_heights (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_text_path_same_letter_heights *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_text_path_same_letter_heights (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_text_path_same_letter_heights value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_text_path_same_letter_heights_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_text_path_scale                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_text_path_scale (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_text_path_scale *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_text_path_scale (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_text_path_scale value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_text_path_scale_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_type_alt_1                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_type_alt_1 (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_type_alt_1 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_type_alt_1 (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_type_alt_1 value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Enhanced_geometry_type_alt_1_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry_type                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry_type (OSCTXT* pctxt,
   Ns3_Enhanced_geometry_type *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            asn1E_Ns3_Enhanced_geometry_type_alt_1 (pctxt, &pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry_type (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry_type* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         if(pvalue->u.alt_1 < 0 || pvalue->u.alt_1 > 0)
            return LOG_RTERR (pctxt, RTERR_INVENUM);

         stat = XmlEnc_Ns3_Enhanced_geometry_type_alt_1 (pctxt, pvalue->u.alt_1
            , 0, nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Equation                                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Equation (OSCTXT* pctxt,
   Ns3_Equation *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode formula */

   if (pvalue->m.formulaPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->formula, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Equation (OSCTXT* pctxt, Ns3_Equation* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.formulaPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:formula=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->formula, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Handle_handle_mirror_horizontal                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Handle_handle_mirror_horizontal (OSCTXT* pctxt,
   Ns3_Handle_handle_mirror_horizontal *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Handle_handle_mirror_horizontal (OSCTXT* pctxt, 
   Ns3_Handle_handle_mirror_horizontal value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Handle_handle_mirror_horizontal_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Handle_handle_mirror_vertical                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Handle_handle_mirror_vertical (OSCTXT* pctxt,
   Ns3_Handle_handle_mirror_vertical *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Handle_handle_mirror_vertical (OSCTXT* pctxt, 
   Ns3_Handle_handle_mirror_vertical value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Handle_handle_mirror_vertical_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Handle_handle_switched                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Handle_handle_switched (OSCTXT* pctxt,
   Ns3_Handle_handle_switched *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Handle_handle_switched (OSCTXT* pctxt, 
   Ns3_Handle_handle_switched value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Handle_handle_switched_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Handle                                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Handle (OSCTXT* pctxt,
   Ns3_Handle *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode handle_switched */

   if (pvalue->m.handle_switchedPresent) {
      if(pvalue->handle_switched < 0 || pvalue->handle_switched > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
         asn1E_Ns3_Handle_handle_switched (pctxt, &pvalue->handle_switched, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode handle_range_y_minimum */

   if (pvalue->m.handle_range_y_minimumPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         xe_utf8str (pctxt, pvalue->handle_range_y_minimum, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode handle_range_y_maximum */

   if (pvalue->m.handle_range_y_maximumPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         xe_utf8str (pctxt, pvalue->handle_range_y_maximum, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode handle_range_x_minimum */

   if (pvalue->m.handle_range_x_minimumPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         xe_utf8str (pctxt, pvalue->handle_range_x_minimum, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode handle_range_x_maximum */

   if (pvalue->m.handle_range_x_maximumPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         xe_utf8str (pctxt, pvalue->handle_range_x_maximum, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode handle_radius_range_minimum */

   if (pvalue->m.handle_radius_range_minimumPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         xe_utf8str (pctxt, pvalue->handle_radius_range_minimum, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode handle_radius_range_maximum */

   if (pvalue->m.handle_radius_range_maximumPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->handle_radius_range_maximum, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode handle_position */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
      xe_utf8str (pctxt, pvalue->handle_position, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode handle_polar */

   if (pvalue->m.handle_polarPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_utf8str (pctxt, pvalue->handle_polar, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode handle_mirror_vertical */

   if (pvalue->m.handle_mirror_verticalPresent) {
      if(pvalue->handle_mirror_vertical < 0 || pvalue->handle_mirror_vertical > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns3_Handle_handle_mirror_vertical (pctxt, &pvalue->handle_mirror_vertical, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode handle_mirror_horizontal */

   if (pvalue->m.handle_mirror_horizontalPresent) {
      if(pvalue->handle_mirror_horizontal < 0 || pvalue->handle_mirror_horizontal > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns3_Handle_handle_mirror_horizontal (pctxt, &pvalue->handle_mirror_horizontal, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Handle (OSCTXT* pctxt, Ns3_Handle* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.handle_mirror_horizontalPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:handle-mirror-horizontal=\""), 31);

      if(pvalue->handle_mirror_horizontal < 0 || pvalue->
         handle_mirror_horizontal > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Handle_handle_mirror_horizontal (pctxt, pvalue->
         handle_mirror_horizontal, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.handle_mirror_verticalPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:handle-mirror-vertical=\""), 29);

      if(pvalue->handle_mirror_vertical < 0 || pvalue->handle_mirror_vertical
          > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Handle_handle_mirror_vertical (pctxt, pvalue->
         handle_mirror_vertical, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.handle_polarPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:handle-polar=\""), 19);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->handle_polar, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:handle-position=\""), 22);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->handle_position, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.handle_radius_range_maximumPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:handle-radius-range-maximum=\""), 34);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->handle_radius_range_maximum
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.handle_radius_range_minimumPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:handle-radius-range-minimum=\""), 34);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->handle_radius_range_minimum
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.handle_range_x_maximumPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:handle-range-x-maximum=\""), 29);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->handle_range_x_maximum, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.handle_range_x_minimumPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:handle-range-x-minimum=\""), 29);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->handle_range_x_minimum, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.handle_range_y_maximumPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:handle-range-y-maximum=\""), 29);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->handle_range_y_maximum, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.handle_range_y_minimumPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:handle-range-y-minimum=\""), 29);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->handle_range_y_minimum, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.handle_switchedPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:handle-switched=\""), 22);

      if(pvalue->handle_switched < 0 || pvalue->handle_switched > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Handle_handle_switched (pctxt, pvalue->handle_switched
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Enhanced_geometry                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Enhanced_geometry (OSCTXT* pctxt,
   Ns3_Enhanced_geometry *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode handle_list */

   pnode2 = pvalue->handle_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Handle (pctxt, ((Ns3_Handle*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|44, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode equation_list */

   pnode2 = pvalue->equation_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Equation (pctxt, ((Ns3_Equation*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|43, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode viewBox */

   if (pvalue->m.viewBoxPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|42,
         asn1E_ViewBox (pctxt, (ViewBox*)&pvalue->viewBox, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode type */

   if (pvalue->m.typePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|41,
         asn1E_Ns3_Enhanced_geometry_type (pctxt, &pvalue->type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_rotate_angle */

   if (pvalue->m.text_rotate_anglePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|40,
         xe_real (pctxt, &pvalue->text_rotate_angle, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_path_scale */

   if (pvalue->m.text_path_scalePresent) {
      if(pvalue->text_path_scale < 0 || pvalue->text_path_scale > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|39,
         asn1E_Ns3_Enhanced_geometry_text_path_scale (pctxt, &pvalue->text_path_scale, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_path_same_letter_heights */

   if (pvalue->m.text_path_same_letter_heightsPresent) {
      if(pvalue->text_path_same_letter_heights < 0 || pvalue->text_path_same_letter_heights > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|38,
         asn1E_Ns3_Enhanced_geometry_text_path_same_letter_heights (pctxt, &pvalue->text_path_same_letter_heights, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_path_mode */

   if (pvalue->m.text_path_modePresent) {
      if(pvalue->text_path_mode < 0 || pvalue->text_path_mode > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|37,
         asn1E_Ns3_Enhanced_geometry_text_path_mode (pctxt, &pvalue->text_path_mode, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_path_allowed */

   if (pvalue->m.text_path_allowedPresent) {
      if(pvalue->text_path_allowed < 0 || pvalue->text_path_allowed > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|36,
         asn1E_Ns3_Enhanced_geometry_text_path_allowed (pctxt, &pvalue->text_path_allowed, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_path */

   if (pvalue->m.text_pathPresent) {
      if(pvalue->text_path < 0 || pvalue->text_path > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|35,
         asn1E_Ns3_Enhanced_geometry_text_path (pctxt, &pvalue->text_path, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_areas */

   if (pvalue->m.text_areasPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|34,
         xe_utf8str (pctxt, pvalue->text_areas, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode path_stretchpoint_y */

   if (pvalue->m.path_stretchpoint_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|33,
         xe_real (pctxt, &pvalue->path_stretchpoint_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode path_stretchpoint_x */

   if (pvalue->m.path_stretchpoint_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|32,
         xe_real (pctxt, &pvalue->path_stretchpoint_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode modifiers */

   if (pvalue->m.modifiersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|31,
         xe_utf8str (pctxt, pvalue->modifiers, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode mirror_vertical */

   if (pvalue->m.mirror_verticalPresent) {
      if(pvalue->mirror_vertical < 0 || pvalue->mirror_vertical > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|30,
         asn1E_Ns3_Enhanced_geometry_mirror_vertical (pctxt, &pvalue->mirror_vertical, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode mirror_horizontal */

   if (pvalue->m.mirror_horizontalPresent) {
      if(pvalue->mirror_horizontal < 0 || pvalue->mirror_horizontal > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|29,
         asn1E_Ns3_Enhanced_geometry_mirror_horizontal (pctxt, &pvalue->mirror_horizontal, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode glue_points */

   if (pvalue->m.glue_pointsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|28,
         xe_utf8str (pctxt, pvalue->glue_points, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode glue_point_type */

   if (pvalue->m.glue_point_typePresent) {
      if(pvalue->glue_point_type < 0 || pvalue->glue_point_type > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|27,
         asn1E_Ns3_Enhanced_geometry_glue_point_type (pctxt, &pvalue->glue_point_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode glue_point_leaving_directions */

   if (pvalue->m.glue_point_leaving_directionsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|26,
         xe_utf8str (pctxt, pvalue->glue_point_leaving_directions, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_viewpoint */

   if (pvalue->m.extrusion_viewpointPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|25,
         xe_utf8str (pctxt, pvalue->extrusion_viewpoint, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_specularity */

   if (pvalue->m.extrusion_specularityPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|24,
         xe_utf8str (pctxt, pvalue->extrusion_specularity, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_skew */

   if (pvalue->m.extrusion_skewPresent) {
      pnode2 = pvalue->extrusion_skew.tail;
      while (0 != pnode2) {
         ll = asn1E_Ns3_Enhanced_geometry_extrusion_skew_element (pctxt, ((Ns3_Enhanced_geometry_extrusion_skew_element*)pnode2->data), ASN1EXPL);
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll2 += ll;

         pnode2 = pnode2->prev;
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|23, ll2);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      else { ll1 += ll; ll2 = 0; }
   }
   /* encode extrusion_shininess */

   if (pvalue->m.extrusion_shininessPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|22,
         xe_utf8str (pctxt, pvalue->extrusion_shininess, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_second_light_level */

   if (pvalue->m.extrusion_second_light_levelPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|21,
         xe_utf8str (pctxt, pvalue->extrusion_second_light_level, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_second_light_harsh */

   if (pvalue->m.extrusion_second_light_harshPresent) {
      if(pvalue->extrusion_second_light_harsh < 0 || pvalue->extrusion_second_light_harsh > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|20,
         asn1E_Ns3_Enhanced_geometry_extrusion_second_light_harsh (pctxt, &pvalue->extrusion_second_light_harsh, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_second_light_direction */

   if (pvalue->m.extrusion_second_light_directionPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         xe_utf8str (pctxt, pvalue->extrusion_second_light_direction, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_rotation_center */

   if (pvalue->m.extrusion_rotation_centerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         xe_utf8str (pctxt, pvalue->extrusion_rotation_center, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_rotation_angle */

   if (pvalue->m.extrusion_rotation_anglePresent) {
      pnode2 = pvalue->extrusion_rotation_angle.tail;
      while (0 != pnode2) {
         ll = asn1E_Ns3_Enhanced_geometry_extrusion_rotation_angle_element (pctxt, ((Ns3_Enhanced_geometry_extrusion_rotation_angle_element*)pnode2->data), ASN1EXPL);
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll2 += ll;

         pnode2 = pnode2->prev;
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|17, ll2);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      else { ll1 += ll; ll2 = 0; }
   }
   /* encode extrusion_origin */

   if (pvalue->m.extrusion_originPresent) {
      pnode2 = pvalue->extrusion_origin.tail;
      while (0 != pnode2) {
         ll = asn1E_Ns3_Enhanced_geometry_extrusion_origin_element (pctxt, ((Ns3_Enhanced_geometry_extrusion_origin_element*)pnode2->data), ASN1EXPL);
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll2 += ll;

         pnode2 = pnode2->prev;
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|16, ll2);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      else { ll1 += ll; ll2 = 0; }
   }
   /* encode extrusion_number_of_line_segments */

   if (pvalue->m.extrusion_number_of_line_segmentsPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|15,
         xe_integer (pctxt, &pvalue->extrusion_number_of_line_segments, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_metal */

   if (pvalue->m.extrusion_metalPresent) {
      if(pvalue->extrusion_metal < 0 || pvalue->extrusion_metal > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|14,
         asn1E_Ns3_Enhanced_geometry_extrusion_metal (pctxt, &pvalue->extrusion_metal, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_light_face */

   if (pvalue->m.extrusion_light_facePresent) {
      if(pvalue->extrusion_light_face < 0 || pvalue->extrusion_light_face > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         asn1E_Ns3_Enhanced_geometry_extrusion_light_face (pctxt, &pvalue->extrusion_light_face, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_first_light_level */

   if (pvalue->m.extrusion_first_light_levelPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|12,
         xe_utf8str (pctxt, pvalue->extrusion_first_light_level, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_first_light_harsh */

   if (pvalue->m.extrusion_first_light_harshPresent) {
      if(pvalue->extrusion_first_light_harsh < 0 || pvalue->extrusion_first_light_harsh > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
         asn1E_Ns3_Enhanced_geometry_extrusion_first_light_harsh (pctxt, &pvalue->extrusion_first_light_harsh, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_first_light_direction */

   if (pvalue->m.extrusion_first_light_directionPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
         xe_utf8str (pctxt, pvalue->extrusion_first_light_direction, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_diffusion */

   if (pvalue->m.extrusion_diffusionPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         xe_utf8str (pctxt, pvalue->extrusion_diffusion, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_depth */

   if (pvalue->m.extrusion_depthPresent) {
      pnode2 = pvalue->extrusion_depth.tail;
      while (0 != pnode2) {
         ll = asn1E_Ns3_Enhanced_geometry_extrusion_depth_element (pctxt, ((Ns3_Enhanced_geometry_extrusion_depth_element*)pnode2->data), ASN1EXPL);
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll2 += ll;

         pnode2 = pnode2->prev;
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8, ll2);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      else { ll1 += ll; ll2 = 0; }
   }
   /* encode extrusion_color */

   if (pvalue->m.extrusion_colorPresent) {
      if(pvalue->extrusion_color < 0 || pvalue->extrusion_color > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Ns3_Enhanced_geometry_extrusion_color (pctxt, &pvalue->extrusion_color, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_brightness */

   if (pvalue->m.extrusion_brightnessPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         xe_utf8str (pctxt, pvalue->extrusion_brightness, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion_allowed */

   if (pvalue->m.extrusion_allowedPresent) {
      if(pvalue->extrusion_allowed < 0 || pvalue->extrusion_allowed > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns3_Enhanced_geometry_extrusion_allowed (pctxt, &pvalue->extrusion_allowed, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode extrusion */

   if (pvalue->m.extrusionPresent) {
      if(pvalue->extrusion < 0 || pvalue->extrusion > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns3_Enhanced_geometry_extrusion (pctxt, &pvalue->extrusion, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode enhanced_path */

   if (pvalue->m.enhanced_pathPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_utf8str (pctxt, pvalue->enhanced_path, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode concentric_gradient_fill_allowed */

   if (pvalue->m.concentric_gradient_fill_allowedPresent) {
      if(pvalue->concentric_gradient_fill_allowed < 0 || pvalue->concentric_gradient_fill_allowed > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Enhanced_geometry_concentric_gradient_fill_allowed (pctxt, &pvalue->concentric_gradient_fill_allowed, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode shade_mode */

   if (pvalue->m.shade_modePresent) {
      if(pvalue->shade_mode < 0 || pvalue->shade_mode > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns7_Shade_mode (pctxt, (Ns7_Shade_mode*)&pvalue->shade_mode, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode projection */

   if (pvalue->m.projectionPresent) {
      if(pvalue->projection < 0 || pvalue->projection > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns7_Projection (pctxt, (Ns7_Projection*)&pvalue->projection, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Enhanced_geometry (OSCTXT* pctxt, 
   Ns3_Enhanced_geometry* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.projectionPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:projection=\""), 17);

      if(pvalue->projection < 0 || pvalue->projection > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns7_Projection (pctxt, pvalue->projection, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.shade_modePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns7:shade-mode=\""), 17);

      if(pvalue->shade_mode < 0 || pvalue->shade_mode > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns7_Shade_mode (pctxt, pvalue->shade_mode, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.concentric_gradient_fill_allowedPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:concentric-gradient-fill-allowed=\""), 39);

      if(pvalue->concentric_gradient_fill_allowed < 0 || pvalue->
         concentric_gradient_fill_allowed > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Enhanced_geometry_concentric_gradient_fill_allowed (pctxt
         , pvalue->concentric_gradient_fill_allowed, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.enhanced_pathPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:enhanced-path=\""), 20);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->enhanced_path, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.extrusionPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion=\""), 16);

      if(pvalue->extrusion < 0 || pvalue->extrusion > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Enhanced_geometry_extrusion (pctxt, pvalue->extrusion
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.extrusion_allowedPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion-allowed=\""), 24);

      if(pvalue->extrusion_allowed < 0 || pvalue->extrusion_allowed > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Enhanced_geometry_extrusion_allowed (pctxt, pvalue->
         extrusion_allowed, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.extrusion_brightnessPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion-brightness=\""), 27);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->extrusion_brightness, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.extrusion_colorPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion-color=\""), 22);

      if(pvalue->extrusion_color < 0 || pvalue->extrusion_color > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Enhanced_geometry_extrusion_color (pctxt, pvalue->
         extrusion_color, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.extrusion_depthPresent) {
   }

   if (pvalue->m.extrusion_diffusionPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion-diffusion=\""), 26);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->extrusion_diffusion, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.extrusion_first_light_directionPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion-first-light-direction=\""), 38);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->extrusion_first_light_direction
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.extrusion_first_light_harshPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion-first-light-harsh=\""), 34);

      if(pvalue->extrusion_first_light_harsh < 0 || pvalue->
         extrusion_first_light_harsh > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Enhanced_geometry_extrusion_first_light_harsh (pctxt, 
         pvalue->extrusion_first_light_harsh, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.extrusion_first_light_levelPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion-first-light-level=\""), 34);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->extrusion_first_light_level
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.extrusion_light_facePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion-light-face=\""), 27);

      if(pvalue->extrusion_light_face < 0 || pvalue->extrusion_light_face > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Enhanced_geometry_extrusion_light_face (pctxt, pvalue->
         extrusion_light_face, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.extrusion_metalPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion-metal=\""), 22);

      if(pvalue->extrusion_metal < 0 || pvalue->extrusion_metal > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Enhanced_geometry_extrusion_metal (pctxt, pvalue->
         extrusion_metal, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.extrusion_number_of_line_segmentsPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->extrusion_number_of_line_segments
            , OSUTF8("ns3:extrusion-number-of-line-segments"), 37);
   }

   if (pvalue->m.extrusion_originPresent) {
   }

   if (pvalue->m.extrusion_rotation_anglePresent) {
   }

   if (pvalue->m.extrusion_rotation_centerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion-rotation-center=\""), 32);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->extrusion_rotation_center, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.extrusion_second_light_directionPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion-second-light-direction=\""), 39);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->extrusion_second_light_direction
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.extrusion_second_light_harshPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion-second-light-harsh=\""), 35);

      if(pvalue->extrusion_second_light_harsh < 0 || pvalue->
         extrusion_second_light_harsh > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Enhanced_geometry_extrusion_second_light_harsh (pctxt, 
         pvalue->extrusion_second_light_harsh, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.extrusion_second_light_levelPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion-second-light-level=\""), 35);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->extrusion_second_light_level
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.extrusion_shininessPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion-shininess=\""), 26);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->extrusion_shininess, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.extrusion_skewPresent) {
   }

   if (pvalue->m.extrusion_specularityPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion-specularity=\""), 28);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->extrusion_specularity, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.extrusion_viewpointPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:extrusion-viewpoint=\""), 26);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->extrusion_viewpoint, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.glue_point_leaving_directionsPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:glue-point-leaving-directions=\""), 36);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->glue_point_leaving_directions
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.glue_point_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:glue-point-type=\""), 22);

      if(pvalue->glue_point_type < 0 || pvalue->glue_point_type > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Enhanced_geometry_glue_point_type (pctxt, pvalue->
         glue_point_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.glue_pointsPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:glue-points=\""), 18);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->glue_points, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.mirror_horizontalPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:mirror-horizontal=\""), 24);

      if(pvalue->mirror_horizontal < 0 || pvalue->mirror_horizontal > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Enhanced_geometry_mirror_horizontal (pctxt, pvalue->
         mirror_horizontal, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.mirror_verticalPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:mirror-vertical=\""), 22);

      if(pvalue->mirror_vertical < 0 || pvalue->mirror_vertical > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Enhanced_geometry_mirror_vertical (pctxt, pvalue->
         mirror_vertical, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.modifiersPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:modifiers=\""), 16);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->modifiers, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.path_stretchpoint_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:path-stretchpoint-x=\""), 26);

      stat = rtXmlEncDouble (pctxt, pvalue->path_stretchpoint_x, 0, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.path_stretchpoint_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:path-stretchpoint-y=\""), 26);

      stat = rtXmlEncDouble (pctxt, pvalue->path_stretchpoint_y, 0, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.text_areasPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-areas=\""), 17);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->text_areas, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.text_pathPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-path=\""), 16);

      if(pvalue->text_path < 0 || pvalue->text_path > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Enhanced_geometry_text_path (pctxt, pvalue->text_path
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_path_allowedPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-path-allowed=\""), 24);

      if(pvalue->text_path_allowed < 0 || pvalue->text_path_allowed > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Enhanced_geometry_text_path_allowed (pctxt, pvalue->
         text_path_allowed, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_path_modePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-path-mode=\""), 21);

      if(pvalue->text_path_mode < 0 || pvalue->text_path_mode > 2)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Enhanced_geometry_text_path_mode (pctxt, pvalue->
         text_path_mode, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_path_same_letter_heightsPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-path-same-letter-heights=\""), 36);

      if(pvalue->text_path_same_letter_heights < 0 || pvalue->
         text_path_same_letter_heights > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Enhanced_geometry_text_path_same_letter_heights (pctxt
         , pvalue->text_path_same_letter_heights, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_path_scalePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-path-scale=\""), 22);

      if(pvalue->text_path_scale < 0 || pvalue->text_path_scale > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Enhanced_geometry_text_path_scale (pctxt, pvalue->
         text_path_scale, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_rotate_anglePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-rotate-angle=\""), 24);

      stat = rtXmlEncDouble (pctxt, pvalue->text_rotate_angle, 0, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:type=\""), 11);

      stat = XmlEnc_Ns3_Enhanced_geometry_type (pctxt, &pvalue->type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.viewBoxPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:viewBox=\""), 15);

      stat = XmlEnc_ViewBox (pctxt, &pvalue->viewBox, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode equation_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->equation_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Equation (pctxt, ((Ns3_Equation*)pnode->data)
         , OSUTF8("equation"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode handle_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->handle_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Handle (pctxt, ((Ns3_Handle*)pnode->data)
         , OSUTF8("handle"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Custom_shape                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Custom_shape (OSCTXT* pctxt,
   Ns3_Custom_shape *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode enhanced_geometry */

   if (pvalue->m.enhanced_geometryPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|25,
         asn1E_Ns3_Enhanced_geometry (pctxt, &pvalue->enhanced_geometry, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Custom_shape_element (pctxt, ((Ns3_Custom_shape_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|24, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode glue_point_list */

   pnode2 = pvalue->glue_point_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|23, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|22,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|21,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|20,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|17,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|16,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|15,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x */

   if (pvalue->m.xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|14,
         xe_utf8str (pctxt, pvalue->x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|12,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         asn1E_Ns3_Z_index (pctxt, &pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         asn1E_Ns3_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_style_name */

   if (pvalue->m.text_style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
         asn1E_Ns3_Text_style_name (pctxt, &pvalue->text_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns3_Layer_1 (pctxt, pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode engine */

   if (pvalue->m.enginePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_utf8str (pctxt, pvalue->engine, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode data */

   if (pvalue->m.dataPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->data, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Custom_shape (OSCTXT* pctxt, Ns3_Custom_shape* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.dataPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:data=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->data, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.enginePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:engine=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->engine, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-style-name=\""), 22);

      stat = XmlEnc_Ns3_Text_style_name (pctxt, &pvalue->text_style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:transform=\""), 16);

      stat = XmlEnc_Ns3_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode glue_point_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->glue_point_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode->data)
         , OSUTF8("glue-point"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Custom_shape_element (pctxt, 
         ((Ns3_Custom_shape_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode enhanced_geometry */

   if (pvalue->m.enhanced_geometryPresent) {
      stat = XmlEnc_Ns3_Enhanced_geometry (pctxt, &pvalue->enhanced_geometry
         , OSUTF8("enhanced-geometry"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  A_actuate                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_A_actuate (OSCTXT* pctxt,
   Ns3_A_actuate *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_A_actuate (OSCTXT* pctxt, Ns3_A_actuate value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_A_actuate_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  A_show                                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_A_show (OSCTXT* pctxt,
   Ns3_A_show *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_A_show (OSCTXT* pctxt, Ns3_A_show value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_A_show_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  A                                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_A (OSCTXT* pctxt,
   Ns3_A *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode frame */

   if (pvalue->frame == NULL) {
      rtxErrAddStrParm (pctxt, "pvalue->frame");
      return LOG_RTERR (pctxt, RTERR_NULLPTR);
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
      asn1E_Ns3_Frame (pctxt, (Ns3_Frame*)pvalue->frame, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode target_frame_name */

   if (pvalue->m.target_frame_namePresent) {
      if (pvalue->target_frame_name == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->target_frame_name");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Ns13_Target_frame_name (pctxt, (Ns13_Target_frame_name*)pvalue->target_frame_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode server_map */

   if (pvalue->m.server_mapPresent) {
      if(pvalue->server_map < 0 || pvalue->server_map > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns13_Server_map (pctxt, (Ns13_Server_map*)&pvalue->server_map, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns13_Name (pctxt, (Ns13_Name)pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode type */

   if (pvalue->m.typePresent) {
      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Xlink_Type (pctxt, &pvalue->type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode show */

   if (pvalue->m.showPresent) {
      if(pvalue->show < 0 || pvalue->show > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_A_show (pctxt, &pvalue->show, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode href */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      asn1E_Xlink_Href (pctxt, pvalue->href, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode actuate */

   if (pvalue->m.actuatePresent) {
      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns3_A_actuate (pctxt, &pvalue->actuate, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_A (OSCTXT* pctxt, Ns3_A* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.actuatePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:actuate=\""), 16);

      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_A_actuate (pctxt, pvalue->actuate, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:href=\""), 13);

   stat = XmlEnc_Xlink_Href (pctxt, pvalue->href, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.showPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:show=\""), 13);

      if(pvalue->show < 0 || pvalue->show > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_A_show (pctxt, pvalue->show, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:type=\""), 13);

      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Xlink_Type (pctxt, pvalue->type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:name=\""), 12);

      stat = XmlEnc_Ns13_Name (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.server_mapPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:server-map=\""), 18);

      if(pvalue->server_map < 0 || pvalue->server_map > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns13_Server_map (pctxt, pvalue->server_map, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.target_frame_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:target-frame-name=\""), 25);

      stat = XmlEnc_Ns13_Target_frame_name (pctxt, pvalue->target_frame_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode frame */

   stat = XmlEnc_Ns3_Frame (pctxt, pvalue->frame, OSUTF8("frame"), nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Text_box_element                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Text_box_element (OSCTXT* pctxt,
   Ns3_Text_box_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_H (pctxt, (Odf_H*)pvalue->u.h, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Odf_Numbered_paragraph (pctxt, (Odf_Numbered_paragraph*)pvalue->u.numbered_paragraph, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
            asn1E_Table (pctxt, (Table*)pvalue->u.table, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 6:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
            asn1E_Ns3_A (pctxt, pvalue->u.a, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 7:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
            asn1E_Odf_Section (pctxt, (Odf_Section*)pvalue->u.section, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 8:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
            asn1E_Odf_Table_of_content (pctxt, (Odf_Table_of_content*)pvalue->u.table_of_content, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 9:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
            asn1E_Odf_Illustration_index (pctxt, (Odf_Illustration_index*)pvalue->u.illustration_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 10:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
            asn1E_Odf_Table_index (pctxt, (Odf_Table_index*)pvalue->u.table_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 11:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
            asn1E_Odf_Object_index (pctxt, (Odf_Object_index*)pvalue->u.object_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 12:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
            asn1E_Odf_User_index (pctxt, (Odf_User_index*)pvalue->u.user_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 13:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
            asn1E_Odf_Alphabetical_index (pctxt, (Odf_Alphabetical_index*)pvalue->u.alphabetical_index, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 14:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
            asn1E_Odf_Bibliography (pctxt, (Odf_Bibliography*)pvalue->u.bibliography, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 15:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|14,
            asn1E_Ns3_Rect (pctxt, pvalue->u.rect, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 16:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|15,
            asn1E_Ns3_Line (pctxt, pvalue->u.line, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 17:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|16,
            asn1E_Ns3_Polyline (pctxt, pvalue->u.polyline, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 18:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|17,
            asn1E_Ns3_Polygon (pctxt, pvalue->u.polygon, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 19:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|18,
            asn1E_Ns3_Regular_polygon (pctxt, pvalue->u.regular_polygon, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 20:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|19,
            asn1E_Ns3_Path (pctxt, pvalue->u.path, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 21:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|20,
            asn1E_Ns3_Circle (pctxt, pvalue->u.circle, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 22:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|21,
            asn1E_Ns3_Ellipse (pctxt, pvalue->u.ellipse, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 23:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|22,
            asn1E_Ns3_G (pctxt, (Ns3_G*)pvalue->u.g, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 24:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|23,
            asn1E_Ns3_Page_thumbnail (pctxt, pvalue->u.page_thumbnail, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 25:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|24,
            asn1E_Ns3_Frame (pctxt, (Ns3_Frame*)pvalue->u.frame, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 26:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|25,
            asn1E_Ns3_Measure (pctxt, pvalue->u.measure, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 27:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|26,
            asn1E_Ns3_Caption (pctxt, pvalue->u.caption, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 28:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|27,
            asn1E_Ns3_Connector (pctxt, pvalue->u.connector, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 29:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|28,
            asn1E_Ns3_Control (pctxt, pvalue->u.control, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 30:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|29,
            asn1E_Ns7_Scene (pctxt, (Ns7_Scene*)pvalue->u.scene, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 31:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|30,
            asn1E_Ns3_Custom_shape (pctxt, pvalue->u.custom_shape, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 32:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|31,
            asn1E_Odf_Change (pctxt, (Odf_Change*)pvalue->u.change, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 33:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|32,
            asn1E_Odf_Change_start (pctxt, (Odf_Change_start*)pvalue->u.change_start, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 34:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|33,
            asn1E_Odf_Change_end (pctxt, (Odf_Change_end*)pvalue->u.change_end, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Text_box_element (OSCTXT* pctxt, Ns3_Text_box_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode h */

         stat = XmlEnc_Odf_H (pctxt, pvalue->u.h, OSUTF8("h"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode numbered_paragraph */

         stat = XmlEnc_Odf_Numbered_paragraph (pctxt, pvalue->
            u.numbered_paragraph, OSUTF8("numbered-paragraph"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode table */

         stat = XmlEnc_Table (pctxt, pvalue->u.table
            , OSUTF8("table"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 6:
         /* encode a */

         stat = XmlEnc_Ns3_A (pctxt, pvalue->u.a, OSUTF8("a"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 7:
         /* encode section */

         stat = XmlEnc_Odf_Section (pctxt, pvalue->u.section
            , OSUTF8("section"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 8:
         /* encode table_of_content */

         stat = XmlEnc_Odf_Table_of_content (pctxt, pvalue->u.table_of_content
            , OSUTF8("table-of-content"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 9:
         /* encode illustration_index */

         stat = XmlEnc_Odf_Illustration_index (pctxt, pvalue->
            u.illustration_index, OSUTF8("illustration-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 10:
         /* encode table_index */

         stat = XmlEnc_Odf_Table_index (pctxt, pvalue->u.table_index
            , OSUTF8("table-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 11:
         /* encode object_index */

         stat = XmlEnc_Odf_Object_index (pctxt, pvalue->u.object_index
            , OSUTF8("object-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 12:
         /* encode user_index */

         stat = XmlEnc_Odf_User_index (pctxt, pvalue->u.user_index
            , OSUTF8("user-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 13:
         /* encode alphabetical_index */

         stat = XmlEnc_Odf_Alphabetical_index (pctxt, pvalue->
            u.alphabetical_index, OSUTF8("alphabetical-index"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 14:
         /* encode bibliography */

         stat = XmlEnc_Odf_Bibliography (pctxt, pvalue->u.bibliography
            , OSUTF8("bibliography"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 15:
         /* encode rect */

         stat = XmlEnc_Ns3_Rect (pctxt, pvalue->u.rect
            , OSUTF8("rect"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 16:
         /* encode line */

         stat = XmlEnc_Ns3_Line (pctxt, pvalue->u.line
            , OSUTF8("line"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 17:
         /* encode polyline */

         stat = XmlEnc_Ns3_Polyline (pctxt, pvalue->u.polyline
            , OSUTF8("polyline"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 18:
         /* encode polygon */

         stat = XmlEnc_Ns3_Polygon (pctxt, pvalue->u.polygon
            , OSUTF8("polygon"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 19:
         /* encode regular_polygon */

         stat = XmlEnc_Ns3_Regular_polygon (pctxt, pvalue->u.regular_polygon
            , OSUTF8("regular-polygon"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 20:
         /* encode path */

         stat = XmlEnc_Ns3_Path (pctxt, pvalue->u.path
            , OSUTF8("path"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 21:
         /* encode circle */

         stat = XmlEnc_Ns3_Circle (pctxt, pvalue->u.circle
            , OSUTF8("circle"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 22:
         /* encode ellipse */

         stat = XmlEnc_Ns3_Ellipse (pctxt, pvalue->u.ellipse
            , OSUTF8("ellipse"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 23:
         /* encode g */

         stat = XmlEnc_Ns3_G (pctxt, pvalue->u.g, OSUTF8("g"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 24:
         /* encode page_thumbnail */

         stat = XmlEnc_Ns3_Page_thumbnail (pctxt, pvalue->u.page_thumbnail
            , OSUTF8("page-thumbnail"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 25:
         /* encode frame */

         stat = XmlEnc_Ns3_Frame (pctxt, pvalue->u.frame
            , OSUTF8("frame"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 26:
         /* encode measure */

         stat = XmlEnc_Ns3_Measure (pctxt, pvalue->u.measure
            , OSUTF8("measure"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 27:
         /* encode caption */

         stat = XmlEnc_Ns3_Caption (pctxt, pvalue->u.caption
            , OSUTF8("caption"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 28:
         /* encode connector */

         stat = XmlEnc_Ns3_Connector (pctxt, pvalue->u.connector
            , OSUTF8("connector"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 29:
         /* encode control */

         stat = XmlEnc_Ns3_Control (pctxt, pvalue->u.control
            , OSUTF8("control"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 30:
         /* encode scene */

         stat = XmlEnc_Ns7_Scene (pctxt, pvalue->u.scene
            , OSUTF8("scene"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 31:
         /* encode custom_shape */

         stat = XmlEnc_Ns3_Custom_shape (pctxt, pvalue->u.custom_shape
            , OSUTF8("custom-shape"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 32:
         /* encode change */

         stat = XmlEnc_Odf_Change (pctxt, pvalue->u.change
            , OSUTF8("change"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 33:
         /* encode change_start */

         stat = XmlEnc_Odf_Change_start (pctxt, pvalue->u.change_start
            , OSUTF8("change-start"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 34:
         /* encode change_end */

         stat = XmlEnc_Odf_Change_end (pctxt, pvalue->u.change_end
            , OSUTF8("change-end"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Text_box                                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Text_box (OSCTXT* pctxt,
   Ns3_Text_box *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Text_box_element (pctxt, ((Ns3_Text_box_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode min_width */

   if (pvalue->m.min_widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Ns1_Min_width (pctxt, &pvalue->min_width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode min_height */

   if (pvalue->m.min_heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
         asn1E_Ns1_Min_height (pctxt, &pvalue->min_height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode max_width */

   if (pvalue->m.max_widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
         asn1E_Ns1_Max_width (pctxt, &pvalue->max_width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode max_height */

   if (pvalue->m.max_heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
         asn1E_Ns1_Max_height (pctxt, &pvalue->max_height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode corner_radius */

   if (pvalue->m.corner_radiusPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns3_Corner_radius (pctxt, pvalue->corner_radius, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode chain_next_name */

   if (pvalue->m.chain_next_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->chain_next_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Text_box (OSCTXT* pctxt, Ns3_Text_box* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.chain_next_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:chain-next-name=\""), 22);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->chain_next_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.corner_radiusPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:corner-radius=\""), 20);

      stat = XmlEnc_Ns3_Corner_radius (pctxt, pvalue->corner_radius, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.max_heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns1:max-height=\""), 17);

      stat = XmlEnc_Ns1_Max_height (pctxt, &pvalue->max_height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.max_widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns1:max-width=\""), 16);

      stat = XmlEnc_Ns1_Max_width (pctxt, &pvalue->max_width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.min_heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns1:min-height=\""), 17);

      stat = XmlEnc_Ns1_Min_height (pctxt, &pvalue->min_height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.min_widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns1:min-width=\""), 16);

      stat = XmlEnc_Ns1_Min_width (pctxt, &pvalue->min_width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Text_box_element (pctxt, 
         ((Ns3_Text_box_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Image_actuate                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Image_actuate (OSCTXT* pctxt,
   Ns3_Image_actuate *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Image_actuate (OSCTXT* pctxt, Ns3_Image_actuate value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Image_actuate_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Image_show                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Image_show (OSCTXT* pctxt,
   Ns3_Image_show *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Image_show (OSCTXT* pctxt, Ns3_Image_show value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Image_show_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Image_element                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Image_element (OSCTXT* pctxt,
   Ns3_Image_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Odf_P (pctxt, (Odf_P*)pvalue->u.p, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Odf_List (pctxt, (Odf_List*)pvalue->u.list, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Image_element (OSCTXT* pctxt, Ns3_Image_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode p */

         stat = XmlEnc_Odf_P (pctxt, pvalue->u.p, OSUTF8("p"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode list */

         stat = XmlEnc_Odf_List (pctxt, pvalue->u.list
            , OSUTF8("list"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Image                                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Image (OSCTXT* pctxt,
   Ns3_Image *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Image_element (pctxt, ((Ns3_Image_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode binary_data */

   if (pvalue->m.binary_dataPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns13_Binary_data (pctxt, (Ns13_Binary_data*)&pvalue->binary_data, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode filter_name */

   if (pvalue->m.filter_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->filter_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode type */

   if (pvalue->m.typePresent) {
      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Xlink_Type (pctxt, &pvalue->type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode show */

   if (pvalue->m.showPresent) {
      if(pvalue->show < 0 || pvalue->show > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Image_show (pctxt, &pvalue->show, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode href */

   if (pvalue->m.hrefPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Xlink_Href (pctxt, pvalue->href, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode actuate */

   if (pvalue->m.actuatePresent) {
      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns3_Image_actuate (pctxt, &pvalue->actuate, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Image (OSCTXT* pctxt, Ns3_Image* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.actuatePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:actuate=\""), 16);

      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Image_actuate (pctxt, pvalue->actuate, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.hrefPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:href=\""), 13);

      stat = XmlEnc_Xlink_Href (pctxt, pvalue->href, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.showPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:show=\""), 13);

      if(pvalue->show < 0 || pvalue->show > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Image_show (pctxt, pvalue->show, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:type=\""), 13);

      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Xlink_Type (pctxt, pvalue->type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.filter_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:filter-name=\""), 18);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->filter_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode binary_data */

   if (pvalue->m.binary_dataPresent) {
      stat = XmlEnc_Ns13_Binary_data (pctxt, &pvalue->binary_data
         , OSUTF8("binary-data"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Image_element (pctxt, ((Ns3_Image_element*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Object_actuate                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Object_actuate (OSCTXT* pctxt,
   Ns3_Object_actuate *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Object_actuate (OSCTXT* pctxt, Ns3_Object_actuate value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Object_actuate_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Object_show                                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Object_show (OSCTXT* pctxt,
   Ns3_Object_show *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Object_show (OSCTXT* pctxt, Ns3_Object_show value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Object_show_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Gradient_style                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Gradient_style (OSCTXT* pctxt,
   Ns3_Gradient_style *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 5)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Gradient_style (OSCTXT* pctxt, Ns3_Gradient_style value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Gradient_style_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Gradient                                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Gradient (OSCTXT* pctxt,
   Ns3_Gradient *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode style */

   if(pvalue->style < 0 || pvalue->style > 5)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
      asn1E_Ns3_Gradient_style (pctxt, &pvalue->style, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode start_intensity */

   if (pvalue->m.start_intensityPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         xe_utf8str (pctxt, pvalue->start_intensity, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode start_color */

   if (pvalue->m.start_colorPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         xe_utf8str (pctxt, pvalue->start_color, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_intensity */

   if (pvalue->m.end_intensityPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         xe_utf8str (pctxt, pvalue->end_intensity, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_color */

   if (pvalue->m.end_colorPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         xe_utf8str (pctxt, pvalue->end_color, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode display_name */

   if (pvalue->m.display_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns3_Display_name (pctxt, pvalue->display_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode cy */

   if (pvalue->m.cyPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_utf8str (pctxt, pvalue->cy, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode cx */

   if (pvalue->m.cxPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_utf8str (pctxt, pvalue->cx, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode border */

   if (pvalue->m.borderPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->border, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode angle */

   if (pvalue->m.anglePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_integer (pctxt, &pvalue->angle, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Gradient (OSCTXT* pctxt, Ns3_Gradient* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.anglePresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->angle, OSUTF8("ns3:angle"), 9);
   }

   if (pvalue->m.borderPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:border=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->border, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.cxPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:cx=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->cx, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.cyPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:cy=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->cy, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.display_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:display-name=\""), 19);

      stat = XmlEnc_Ns3_Display_name (pctxt, pvalue->display_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_colorPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:end-color=\""), 16);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->end_color, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.end_intensityPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:end-intensity=\""), 20);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->end_intensity, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.start_colorPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:start-color=\""), 18);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->start_color, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.start_intensityPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:start-intensity=\""), 22);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->start_intensity, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style=\""), 12);

   if(pvalue->style < 0 || pvalue->style > 5)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Ns3_Gradient_style (pctxt, pvalue->style, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Color                                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Color (OSCTXT* pctxt,
   Ns3_Color pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Color (OSCTXT* pctxt, Ns3_Color value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Hatch_style                                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Hatch_style (OSCTXT* pctxt,
   Ns3_Hatch_style *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Hatch_style (OSCTXT* pctxt, Ns3_Hatch_style value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Hatch_style_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Hatch                                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Hatch (OSCTXT* pctxt,
   Ns3_Hatch *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode style */

   if(pvalue->style < 0 || pvalue->style > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
      asn1E_Ns3_Hatch_style (pctxt, &pvalue->style, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode rotation */

   if (pvalue->m.rotationPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_integer (pctxt, &pvalue->rotation, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
      xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode distance */

   if (pvalue->m.distancePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_utf8str (pctxt, pvalue->distance, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode display_name */

   if (pvalue->m.display_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns3_Display_name (pctxt, pvalue->display_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode color */

   if (pvalue->m.colorPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns3_Color (pctxt, pvalue->color, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Hatch (OSCTXT* pctxt, Ns3_Hatch* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.colorPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:color=\""), 12);

      stat = XmlEnc_Ns3_Color (pctxt, pvalue->color, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.display_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:display-name=\""), 19);

      stat = XmlEnc_Ns3_Display_name (pctxt, pvalue->display_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.distancePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:distance=\""), 15);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->distance, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.rotationPresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->rotation, OSUTF8("ns3:rotation"), 12);
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style=\""), 12);

   if(pvalue->style < 0 || pvalue->style > 2)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Ns3_Hatch_style (pctxt, pvalue->style, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Fill_image_actuate                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Fill_image_actuate (OSCTXT* pctxt,
   Ns3_Fill_image_actuate *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Fill_image_actuate (OSCTXT* pctxt, 
   Ns3_Fill_image_actuate value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Fill_image_actuate_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Fill_image_show                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Fill_image_show (OSCTXT* pctxt,
   Ns3_Fill_image_show *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Fill_image_show (OSCTXT* pctxt, Ns3_Fill_image_show value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Fill_image_show_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Fill_image                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Fill_image (OSCTXT* pctxt,
   Ns3_Fill_image *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
      xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode display_name */

   if (pvalue->m.display_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns3_Display_name (pctxt, pvalue->display_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode type */

   if (pvalue->m.typePresent) {
      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Xlink_Type (pctxt, &pvalue->type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode show */

   if (pvalue->m.showPresent) {
      if(pvalue->show < 0 || pvalue->show > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Fill_image_show (pctxt, &pvalue->show, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode href */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      asn1E_Xlink_Href (pctxt, pvalue->href, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode actuate */

   if (pvalue->m.actuatePresent) {
      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns3_Fill_image_actuate (pctxt, &pvalue->actuate, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Fill_image (OSCTXT* pctxt, Ns3_Fill_image* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.actuatePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:actuate=\""), 16);

      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Fill_image_actuate (pctxt, pvalue->actuate, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:href=\""), 13);

   stat = XmlEnc_Xlink_Href (pctxt, pvalue->href, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.showPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:show=\""), 13);

      if(pvalue->show < 0 || pvalue->show > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Fill_image_show (pctxt, pvalue->show, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:type=\""), 13);

      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Xlink_Type (pctxt, pvalue->type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.display_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:display-name=\""), 19);

      stat = XmlEnc_Ns3_Display_name (pctxt, pvalue->display_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Marker                                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Marker (OSCTXT* pctxt,
   Ns3_Marker *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode viewBox */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
      asn1E_ViewBox (pctxt, (ViewBox*)&pvalue->viewBox, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode d */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
      asn1E_D (pctxt, (D)pvalue->d, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode display_name */

   if (pvalue->m.display_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns3_Display_name (pctxt, pvalue->display_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Marker (OSCTXT* pctxt, Ns3_Marker* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.display_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:display-name=\""), 19);

      stat = XmlEnc_Ns3_Display_name (pctxt, pvalue->display_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:d=\""), 9);

   stat = XmlEnc_D (pctxt, pvalue->d, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:viewBox=\""), 15);

   stat = XmlEnc_ViewBox (pctxt, &pvalue->viewBox, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Stroke_dash_style                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Stroke_dash_style (OSCTXT* pctxt,
   Ns3_Stroke_dash_style *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Stroke_dash_style (OSCTXT* pctxt, Ns3_Stroke_dash_style value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Stroke_dash_style_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Stroke_dash                                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Stroke_dash (OSCTXT* pctxt,
   Ns3_Stroke_dash *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode style */

   if (pvalue->m.stylePresent) {
      if(pvalue->style < 0 || pvalue->style > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Ns3_Stroke_dash_style (pctxt, &pvalue->style, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
      xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode dots2_length */

   if (pvalue->m.dots2_lengthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         xe_utf8str (pctxt, pvalue->dots2_length, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode dots2 */

   if (pvalue->m.dots2Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_integer (pctxt, &pvalue->dots2, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode dots1_length */

   if (pvalue->m.dots1_lengthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_utf8str (pctxt, pvalue->dots1_length, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode dots1 */

   if (pvalue->m.dots1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_integer (pctxt, &pvalue->dots1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode distance */

   if (pvalue->m.distancePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->distance, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode display_name */

   if (pvalue->m.display_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns3_Display_name (pctxt, pvalue->display_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Stroke_dash (OSCTXT* pctxt, Ns3_Stroke_dash* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.display_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:display-name=\""), 19);

      stat = XmlEnc_Ns3_Display_name (pctxt, pvalue->display_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.distancePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:distance=\""), 15);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->distance, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.dots1Present) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->dots1, OSUTF8("ns3:dots1"), 9);
   }

   if (pvalue->m.dots1_lengthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:dots1-length=\""), 19);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->dots1_length, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.dots2Present) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->dots2, OSUTF8("ns3:dots2"), 9);
   }

   if (pvalue->m.dots2_lengthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:dots2-length=\""), 19);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->dots2_length, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.stylePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style=\""), 12);

      if(pvalue->style < 0 || pvalue->style > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Stroke_dash_style (pctxt, pvalue->style, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Opacity_style                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Opacity_style (OSCTXT* pctxt,
   Ns3_Opacity_style *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 5)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Opacity_style (OSCTXT* pctxt, Ns3_Opacity_style value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Opacity_style_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Opacity                                                   */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Opacity (OSCTXT* pctxt,
   Ns3_Opacity *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode style */

   if(pvalue->style < 0 || pvalue->style > 5)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
      asn1E_Ns3_Opacity_style (pctxt, &pvalue->style, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode start */

   if (pvalue->m.startPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         xe_utf8str (pctxt, pvalue->start, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end */

   if (pvalue->m.endPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         xe_utf8str (pctxt, pvalue->end, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode display_name */

   if (pvalue->m.display_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns3_Display_name (pctxt, pvalue->display_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode cy */

   if (pvalue->m.cyPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         xe_utf8str (pctxt, pvalue->cy, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode cx */

   if (pvalue->m.cxPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_utf8str (pctxt, pvalue->cx, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode border */

   if (pvalue->m.borderPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->border, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode angle */

   if (pvalue->m.anglePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_integer (pctxt, &pvalue->angle, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Opacity (OSCTXT* pctxt, Ns3_Opacity* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.anglePresent) {
      stat = rtXmlEncIntAttr
         (pctxt, pvalue->angle, OSUTF8("ns3:angle"), 9);
   }

   if (pvalue->m.borderPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:border=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->border, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.cxPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:cx=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->cx, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.cyPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:cy=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->cy, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.display_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:display-name=\""), 19);

      stat = XmlEnc_Ns3_Display_name (pctxt, pvalue->display_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.endPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:end=\""), 10);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->end, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.startPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:start=\""), 12);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->start, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style=\""), 12);

   if(pvalue->style < 0 || pvalue->style > 5)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Ns3_Opacity_style (pctxt, pvalue->style, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  G                                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_G (OSCTXT* pctxt,
   Ns3_G *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_G_element (pctxt, ((Ns3_G_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|16, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode glue_point_list */

   pnode2 = pvalue->glue_point_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|15, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|14,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|12,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns3_Z_index (pctxt, &pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_G (OSCTXT* pctxt, Ns3_G* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode glue_point_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->glue_point_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode->data)
         , OSUTF8("glue-point"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_G_element (pctxt, ((Ns3_G_element*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Area_rectangle_show                                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Area_rectangle_show (OSCTXT* pctxt,
   Ns3_Area_rectangle_show *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Area_rectangle_show (OSCTXT* pctxt, 
   Ns3_Area_rectangle_show value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Area_rectangle_show_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Area_rectangle_nohref                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Area_rectangle_nohref (OSCTXT* pctxt,
   Ns3_Area_rectangle_nohref *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Area_rectangle_nohref (OSCTXT* pctxt, 
   Ns3_Area_rectangle_nohref value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Area_rectangle_nohref_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Area_rectangle                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Area_rectangle (OSCTXT* pctxt,
   Ns3_Area_rectangle *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode desc */

   if (pvalue->m.descPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
         asn1E_Desc (pctxt, (Desc)pvalue->desc, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x */

   if (pvalue->m.xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         xe_utf8str (pctxt, pvalue->x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode target_frame_name */

   if (pvalue->m.target_frame_namePresent) {
      if (pvalue->target_frame_name == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->target_frame_name");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Ns13_Target_frame_name (pctxt, (Ns13_Target_frame_name*)pvalue->target_frame_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns13_Name (pctxt, (Ns13_Name)pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode nohref */

   if (pvalue->m.nohrefPresent) {
      if(pvalue->nohref < 0 || pvalue->nohref > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns3_Area_rectangle_nohref (pctxt, &pvalue->nohref, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode type */

   if (pvalue->m.typePresent) {
      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Xlink_Type (pctxt, &pvalue->type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode show */

   if (pvalue->m.showPresent) {
      if(pvalue->show < 0 || pvalue->show > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns3_Area_rectangle_show (pctxt, &pvalue->show, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode href */

   if (pvalue->m.hrefPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Xlink_Href (pctxt, pvalue->href, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Area_rectangle (OSCTXT* pctxt, Ns3_Area_rectangle* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.hrefPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:href=\""), 13);

      stat = XmlEnc_Xlink_Href (pctxt, pvalue->href, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.showPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:show=\""), 13);

      if(pvalue->show < 0 || pvalue->show > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Area_rectangle_show (pctxt, pvalue->show, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:type=\""), 13);

      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Xlink_Type (pctxt, pvalue->type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.nohrefPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:nohref=\""), 13);

      if(pvalue->nohref < 0 || pvalue->nohref > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Area_rectangle_nohref (pctxt, pvalue->nohref, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:name=\""), 12);

      stat = XmlEnc_Ns13_Name (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.target_frame_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:target-frame-name=\""), 25);

      stat = XmlEnc_Ns13_Target_frame_name (pctxt, pvalue->target_frame_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode desc */

   if (pvalue->m.descPresent) {
      stat = XmlEnc_Desc (pctxt, pvalue->desc, OSUTF8("desc"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Area_circle_show                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Area_circle_show (OSCTXT* pctxt,
   Ns3_Area_circle_show *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Area_circle_show (OSCTXT* pctxt, Ns3_Area_circle_show value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Area_circle_show_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Area_circle_nohref                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Area_circle_nohref (OSCTXT* pctxt,
   Ns3_Area_circle_nohref *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Area_circle_nohref (OSCTXT* pctxt, 
   Ns3_Area_circle_nohref value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Area_circle_nohref_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Area_circle                                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Area_circle (OSCTXT* pctxt,
   Ns3_Area_circle *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode desc */

   if (pvalue->m.descPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         asn1E_Desc (pctxt, (Desc)pvalue->desc, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode r */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
      asn1E_R (pctxt, (R)pvalue->r, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode cy */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
      asn1E_Cy (pctxt, (Cy)pvalue->cy, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode cx */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
      asn1E_Cx (pctxt, (Cx)pvalue->cx, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode target_frame_name */

   if (pvalue->m.target_frame_namePresent) {
      if (pvalue->target_frame_name == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->target_frame_name");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Ns13_Target_frame_name (pctxt, (Ns13_Target_frame_name*)pvalue->target_frame_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         asn1E_Ns13_Name (pctxt, (Ns13_Name)pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode nohref */

   if (pvalue->m.nohrefPresent) {
      if(pvalue->nohref < 0 || pvalue->nohref > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns3_Area_circle_nohref (pctxt, &pvalue->nohref, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode type */

   if (pvalue->m.typePresent) {
      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Xlink_Type (pctxt, &pvalue->type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode show */

   if (pvalue->m.showPresent) {
      if(pvalue->show < 0 || pvalue->show > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns3_Area_circle_show (pctxt, &pvalue->show, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode href */

   if (pvalue->m.hrefPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Xlink_Href (pctxt, pvalue->href, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Area_circle (OSCTXT* pctxt, Ns3_Area_circle* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.hrefPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:href=\""), 13);

      stat = XmlEnc_Xlink_Href (pctxt, pvalue->href, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.showPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:show=\""), 13);

      if(pvalue->show < 0 || pvalue->show > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Area_circle_show (pctxt, pvalue->show, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:type=\""), 13);

      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Xlink_Type (pctxt, pvalue->type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.nohrefPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:nohref=\""), 13);

      if(pvalue->nohref < 0 || pvalue->nohref > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Area_circle_nohref (pctxt, pvalue->nohref, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:name=\""), 12);

      stat = XmlEnc_Ns13_Name (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.target_frame_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:target-frame-name=\""), 25);

      stat = XmlEnc_Ns13_Target_frame_name (pctxt, pvalue->target_frame_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:cx=\""), 10);

   stat = XmlEnc_Cx (pctxt, pvalue->cx, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:cy=\""), 10);

   stat = XmlEnc_Cy (pctxt, pvalue->cy, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:r=\""), 9);

   stat = XmlEnc_R (pctxt, pvalue->r, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode desc */

   if (pvalue->m.descPresent) {
      stat = XmlEnc_Desc (pctxt, pvalue->desc, OSUTF8("desc"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Area_polygon_show                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Area_polygon_show (OSCTXT* pctxt,
   Ns3_Area_polygon_show *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Area_polygon_show (OSCTXT* pctxt, Ns3_Area_polygon_show value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Area_polygon_show_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Area_polygon_nohref                                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Area_polygon_nohref (OSCTXT* pctxt,
   Ns3_Area_polygon_nohref *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Area_polygon_nohref (OSCTXT* pctxt, 
   Ns3_Area_polygon_nohref value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Area_polygon_nohref_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Area_polygon                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Area_polygon (OSCTXT* pctxt,
   Ns3_Area_polygon *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode desc */

   if (pvalue->m.descPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|12,
         asn1E_Desc (pctxt, (Desc)pvalue->desc, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x */

   if (pvalue->m.xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|10,
         xe_utf8str (pctxt, pvalue->x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode viewBox */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
      asn1E_ViewBox (pctxt, (ViewBox*)&pvalue->viewBox, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode target_frame_name */

   if (pvalue->m.target_frame_namePresent) {
      if (pvalue->target_frame_name == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->target_frame_name");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Ns13_Target_frame_name (pctxt, (Ns13_Target_frame_name*)pvalue->target_frame_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns13_Name (pctxt, (Ns13_Name)pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode points */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
      xe_utf8str (pctxt, pvalue->points, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode nohref */

   if (pvalue->m.nohrefPresent) {
      if(pvalue->nohref < 0 || pvalue->nohref > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns3_Area_polygon_nohref (pctxt, &pvalue->nohref, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode type */

   if (pvalue->m.typePresent) {
      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Xlink_Type (pctxt, &pvalue->type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode show */

   if (pvalue->m.showPresent) {
      if(pvalue->show < 0 || pvalue->show > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Ns3_Area_polygon_show (pctxt, &pvalue->show, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode href */

   if (pvalue->m.hrefPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Xlink_Href (pctxt, pvalue->href, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Area_polygon (OSCTXT* pctxt, Ns3_Area_polygon* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.hrefPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:href=\""), 13);

      stat = XmlEnc_Xlink_Href (pctxt, pvalue->href, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.showPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:show=\""), 13);

      if(pvalue->show < 0 || pvalue->show > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Area_polygon_show (pctxt, pvalue->show, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:type=\""), 13);

      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Xlink_Type (pctxt, pvalue->type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.nohrefPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:nohref=\""), 13);

      if(pvalue->nohref < 0 || pvalue->nohref > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Area_polygon_nohref (pctxt, pvalue->nohref, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:points=\""), 13);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->points, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:name=\""), 12);

      stat = XmlEnc_Ns13_Name (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.target_frame_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns13:target-frame-name=\""), 25);

      stat = XmlEnc_Ns13_Target_frame_name (pctxt, pvalue->target_frame_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:viewBox=\""), 15);

   stat = XmlEnc_ViewBox (pctxt, &pvalue->viewBox, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode desc */

   if (pvalue->m.descPresent) {
      stat = XmlEnc_Desc (pctxt, pvalue->desc, OSUTF8("desc"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Image_map_element                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Image_map_element (OSCTXT* pctxt,
   Ns3_Image_map_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Ns3_Area_rectangle (pctxt, pvalue->u.area_rectangle, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Ns3_Area_circle (pctxt, pvalue->u.area_circle, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Ns3_Area_polygon (pctxt, pvalue->u.area_polygon, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Image_map_element (OSCTXT* pctxt, 
   Ns3_Image_map_element* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode area_rectangle */

         stat = XmlEnc_Ns3_Area_rectangle (pctxt, pvalue->u.area_rectangle
            , OSUTF8("area-rectangle"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode area_circle */

         stat = XmlEnc_Ns3_Area_circle (pctxt, pvalue->u.area_circle
            , OSUTF8("area-circle"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode area_polygon */

         stat = XmlEnc_Ns3_Area_polygon (pctxt, pvalue->u.area_polygon
            , OSUTF8("area-polygon"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Image_map                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Image_map (OSCTXT* pctxt,
   Ns3_Image_map *pvalue, ASN1TagType tagging)
{
   OSRTDListNode* pnode1;
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   pnode1 = pvalue->tail;
   while (0 != pnode1) {
      ll = asn1E_Ns3_Image_map_element (pctxt, ((Ns3_Image_map_element*)pnode1->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;

      pnode1 = pnode1->prev;
   }
   ll1 = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll1);
   if (ll1 < 0) return LOG_RTERR (pctxt, ll1);

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Image_map (OSCTXT* pctxt, Ns3_Image_map* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (elemName != 0) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Image_map_element (pctxt, 
         ((Ns3_Image_map_element*)pnode->data), 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Contour_polygon_recreate_on_edit                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Contour_polygon_recreate_on_edit (OSCTXT* pctxt,
   Ns3_Contour_polygon_recreate_on_edit *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Contour_polygon_recreate_on_edit (OSCTXT* pctxt, 
   Ns3_Contour_polygon_recreate_on_edit value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Contour_polygon_recreate_on_edit_ToString (value)
         , elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Contour_polygon                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Contour_polygon (OSCTXT* pctxt,
   Ns3_Contour_polygon *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode viewBox */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
      asn1E_ViewBox (pctxt, (ViewBox*)&pvalue->viewBox, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode recreate_on_edit */

   if(pvalue->recreate_on_edit < 0 || pvalue->recreate_on_edit > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      asn1E_Ns3_Contour_polygon_recreate_on_edit (pctxt, &pvalue->recreate_on_edit, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode points */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      xe_utf8str (pctxt, pvalue->points, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Contour_polygon (OSCTXT* pctxt, Ns3_Contour_polygon* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:points=\""), 13);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->points, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:recreate-on-edit=\""), 23);

   if(pvalue->recreate_on_edit < 0 || pvalue->recreate_on_edit > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Ns3_Contour_polygon_recreate_on_edit (pctxt, pvalue->
      recreate_on_edit, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:viewBox=\""), 15);

   stat = XmlEnc_ViewBox (pctxt, &pvalue->viewBox, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Contour_path_recreate_on_edit                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Contour_path_recreate_on_edit (OSCTXT* pctxt,
   Ns3_Contour_path_recreate_on_edit *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Contour_path_recreate_on_edit (OSCTXT* pctxt, 
   Ns3_Contour_path_recreate_on_edit value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Contour_path_recreate_on_edit_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Contour_path                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Contour_path (OSCTXT* pctxt,
   Ns3_Contour_path *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode viewBox */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
      asn1E_ViewBox (pctxt, (ViewBox*)&pvalue->viewBox, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode d */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      asn1E_D (pctxt, (D)pvalue->d, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode recreate_on_edit */

   if(pvalue->recreate_on_edit < 0 || pvalue->recreate_on_edit > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
      asn1E_Ns3_Contour_path_recreate_on_edit (pctxt, &pvalue->recreate_on_edit, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Contour_path (OSCTXT* pctxt, Ns3_Contour_path* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:recreate-on-edit=\""), 23);

   if(pvalue->recreate_on_edit < 0 || pvalue->recreate_on_edit > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   stat = XmlEnc_Ns3_Contour_path_recreate_on_edit (pctxt, pvalue->
      recreate_on_edit, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:d=\""), 9);

   stat = XmlEnc_D (pctxt, pvalue->d, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:viewBox=\""), 15);

   stat = XmlEnc_ViewBox (pctxt, &pvalue->viewBox, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Frame_choice_1                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Frame_choice_1 (OSCTXT* pctxt,
   Ns3_Frame_choice_1 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Ns3_Contour_polygon (pctxt, pvalue->u.contour_polygon, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Ns3_Contour_path (pctxt, pvalue->u.contour_path, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Frame_choice_1 (OSCTXT* pctxt, Ns3_Frame_choice_1* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode contour_polygon */

         stat = XmlEnc_Ns3_Contour_polygon (pctxt, pvalue->u.contour_polygon
            , OSUTF8("contour-polygon"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode contour_path */

         stat = XmlEnc_Ns3_Contour_path (pctxt, pvalue->u.contour_path
            , OSUTF8("contour-path"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Frame                                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Frame (OSCTXT* pctxt,
   Ns3_Frame *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode choice_1 */

   if (pvalue->m.choice_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|31,
         asn1E_Ns3_Frame_choice_1 (pctxt, &pvalue->choice_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode desc */

   if (pvalue->m.descPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|30,
         asn1E_Desc (pctxt, (Desc)pvalue->desc, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode image_map */

   if (pvalue->m.image_mapPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|29,
         asn1E_Ns3_Image_map (pctxt, &pvalue->image_map, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode glue_point_list */

   pnode2 = pvalue->glue_point_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|28, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|27,
         asn1E_Ns13_Event_listeners (pctxt, (Ns13_Event_listeners*)&pvalue->event_listeners, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Frame_element (pctxt, ((Ns3_Frame_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|26, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode anchor_type */

   if (pvalue->m.anchor_typePresent) {
      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|25,
         asn1E_Odf_Anchor_type (pctxt, (Odf_Anchor_type*)&pvalue->anchor_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode anchor_page_number */

   if (pvalue->m.anchor_page_numberPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|24,
         asn1E_Odf_Anchor_page_number (pctxt, (Odf_Anchor_page_number*)&pvalue->anchor_page_number, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode table_background */

   if (pvalue->m.table_backgroundPresent) {
      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|23,
         asn1E_Table_background (pctxt, (Table_background*)&pvalue->table_background, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_y */

   if (pvalue->m.end_yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|22,
         asn1E_End_y (pctxt, (End_y)pvalue->end_y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_x */

   if (pvalue->m.end_xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|21,
         asn1E_End_x (pctxt, (End_x)pvalue->end_x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode end_cell_address */

   if (pvalue->m.end_cell_addressPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|20,
         asn1E_End_cell_address (pctxt, (End_cell_address)pvalue->end_cell_address, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode y */

   if (pvalue->m.yPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|19,
         xe_utf8str (pctxt, pvalue->y, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode x */

   if (pvalue->m.xPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|18,
         xe_utf8str (pctxt, pvalue->x, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode width */

   if (pvalue->m.widthPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|17,
         xe_utf8str (pctxt, pvalue->width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode height */

   if (pvalue->m.heightPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|16,
         xe_utf8str (pctxt, pvalue->height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode rel_width */

   if (pvalue->m.rel_widthPresent) {
      if (pvalue->rel_width == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->rel_width");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|15,
         asn1E_Ns8_Rel_width (pctxt, (Ns8_Rel_width*)pvalue->rel_width, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode rel_height */

   if (pvalue->m.rel_heightPresent) {
      if (pvalue->rel_height == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->rel_height");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|14,
         asn1E_Ns8_Rel_height (pctxt, (Ns8_Rel_height*)pvalue->rel_height, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode user_transformed */

   if (pvalue->m.user_transformedPresent) {
      if(pvalue->user_transformed < 0 || pvalue->user_transformed > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|13,
         asn1E_Ns10_User_transformed (pctxt, (Ns10_User_transformed*)&pvalue->user_transformed, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name_1 */

   if (pvalue->m.style_name_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode placeholder */

   if (pvalue->m.placeholderPresent) {
      if(pvalue->placeholder < 0 || pvalue->placeholder > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|11,
         asn1E_Ns10_Placeholder_1 (pctxt, (Ns10_Placeholder_1*)&pvalue->placeholder, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names_1 */

   if (pvalue->m.class_names_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_ */

   if (pvalue->m.class_Present) {
      if(pvalue->class_ < 0 || pvalue->class_ > 15)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|9,
         asn1E_Ns10_Class (pctxt, (Ns10_Class*)&pvalue->class_, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode z_index */

   if (pvalue->m.z_indexPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|8,
         asn1E_Ns3_Z_index (pctxt, &pvalue->z_index, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode transform */

   if (pvalue->m.transformPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Ns3_Transform (pctxt, pvalue->transform, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode text_style_name */

   if (pvalue->m.text_style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
         asn1E_Ns3_Text_style_name (pctxt, &pvalue->text_style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode layer */

   if (pvalue->m.layerPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Ns3_Layer_1 (pctxt, pvalue->layer, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode copy_of */

   if (pvalue->m.copy_ofPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->copy_of, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_names */

   if (pvalue->m.class_namesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
         asn1E_Ns3_Class_names (pctxt, &pvalue->class_names, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Frame (OSCTXT* pctxt, Ns3_Frame* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.class_namesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-names=\""), 18);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.copy_ofPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:copy-of=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->copy_of, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.layerPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:layer=\""), 12);

      stat = XmlEnc_Ns3_Layer_1 (pctxt, pvalue->layer, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.text_style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:text-style-name=\""), 22);

      stat = XmlEnc_Ns3_Text_style_name (pctxt, &pvalue->text_style_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.transformPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:transform=\""), 16);

      stat = XmlEnc_Ns3_Transform (pctxt, pvalue->transform, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.z_indexPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:z-index=\""), 14);

      stat = XmlEnc_Ns3_Z_index (pctxt, pvalue->z_index, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class=\""), 13);

      if(pvalue->class_ < 0 || pvalue->class_ > 15)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns10_Class (pctxt, pvalue->class_, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_names_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:class-names=\""), 19);

      stat = XmlEnc_Ns3_Class_names (pctxt, &pvalue->class_names_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.placeholderPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:placeholder=\""), 19);

      if(pvalue->placeholder < 0 || pvalue->placeholder > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns10_Placeholder_1 (pctxt, pvalue->placeholder, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.style_name_1Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:style-name=\""), 18);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name_1, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.user_transformedPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:user-transformed=\""), 24);

      if(pvalue->user_transformed < 0 || pvalue->user_transformed > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns10_User_transformed (pctxt, pvalue->user_transformed
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.rel_heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns8:rel-height=\""), 17);

      stat = XmlEnc_Ns8_Rel_height (pctxt, pvalue->rel_height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.rel_widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns8:rel-width=\""), 16);

      stat = XmlEnc_Ns8_Rel_width (pctxt, pvalue->rel_width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.heightPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:height=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->height, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.widthPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:width=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->width, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:x=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns12:y=\""), 9);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.end_cell_addressPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-cell-address=\""), 24);

      stat = XmlEnc_End_cell_address (pctxt, pvalue->end_cell_address, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_xPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-x=\""), 13);

      stat = XmlEnc_End_x (pctxt, pvalue->end_x, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.end_yPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:end-y=\""), 13);

      stat = XmlEnc_End_y (pctxt, pvalue->end_y, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.table_backgroundPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns15:table-background=\""), 24);

      if(pvalue->table_background < 0 || pvalue->table_background > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Table_background (pctxt, pvalue->table_background, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_page_numberPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-page-number=\""), 26);

      stat = XmlEnc_Odf_Anchor_page_number (pctxt, pvalue->anchor_page_number
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.anchor_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns17:anchor-type=\""), 19);

      if(pvalue->anchor_type < 0 || pvalue->anchor_type > 4)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Odf_Anchor_type (pctxt, pvalue->anchor_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Frame_element (pctxt, ((Ns3_Frame_element*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode event_listeners */

   if (pvalue->m.event_listenersPresent) {
      stat = XmlEnc_Ns13_Event_listeners (pctxt, &pvalue->event_listeners
         , OSUTF8("event-listeners"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode glue_point_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->glue_point_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Glue_point (pctxt, ((Ns3_Glue_point*)pnode->data)
         , OSUTF8("glue-point"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode image_map */

   if (pvalue->m.image_mapPresent) {
      stat = XmlEnc_Ns3_Image_map (pctxt, &pvalue->image_map
         , OSUTF8("image-map"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode desc */

   if (pvalue->m.descPresent) {
      stat = XmlEnc_Desc (pctxt, pvalue->desc, OSUTF8("desc"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode choice_1 */

   if (pvalue->m.choice_1Present) {
      stat = XmlEnc_Ns3_Frame_choice_1 (pctxt, &pvalue->choice_1
         , OSUTF8(""), 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Layer_display                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Layer_display (OSCTXT* pctxt,
   Ns3_Layer_display *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 3)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Layer_display (OSCTXT* pctxt, Ns3_Layer_display value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Layer_display_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Layer_protected_                                          */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Layer_protected_ (OSCTXT* pctxt,
   Ns3_Layer_protected_ *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Layer_protected_ (OSCTXT* pctxt, Ns3_Layer_protected_ value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Layer_protected__ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Layer                                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Layer (OSCTXT* pctxt,
   Ns3_Layer *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode protected_ */

   if (pvalue->m.protected_Present) {
      if(pvalue->protected_ < 0 || pvalue->protected_ > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Layer_protected_ (pctxt, &pvalue->protected_, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode display */

   if (pvalue->m.displayPresent) {
      if(pvalue->display < 0 || pvalue->display > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns3_Layer_display (pctxt, &pvalue->display, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Layer (OSCTXT* pctxt, Ns3_Layer* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.displayPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:display=\""), 14);

      if(pvalue->display < 0 || pvalue->display > 3)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Layer_display (pctxt, pvalue->display, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

   stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '\"');

   if (pvalue->m.protected_Present) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:protected=\""), 16);

      if(pvalue->protected_ < 0 || pvalue->protected_ > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Layer_protected_ (pctxt, pvalue->protected_, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Layer_set                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Layer_set (OSCTXT* pctxt,
   Ns3_Layer_set *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode layer_list */

   pnode2 = pvalue->layer_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Layer (pctxt, ((Ns3_Layer*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Layer_set (OSCTXT* pctxt, Ns3_Layer_set* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode layer_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->layer_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Layer (pctxt, ((Ns3_Layer*)pnode->data)
         , OSUTF8("layer"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Page_master_page_name                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Page_master_page_name (OSCTXT* pctxt,
   Ns3_Page_master_page_name *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
            xe_utf8str (pctxt, pvalue->u.alt, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
            xe_utf8str (pctxt, pvalue->u.alt_1, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Page_master_page_name (OSCTXT* pctxt, 
   Ns3_Page_master_page_name* pvalue, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode alt */

         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode alt_1 */

         { int nchars = rtxUTF8Len (pvalue->u.alt_1);
         }
         stat = rtXmlEncUTF8Str (pctxt, pvalue->u.alt_1, 0, 0);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Page_element                                              */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Page_element (OSCTXT* pctxt,
   Ns3_Page_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Ns3_Rect (pctxt, pvalue->u.rect, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Ns3_Line (pctxt, pvalue->u.line, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Ns3_Polyline (pctxt, pvalue->u.polyline, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Ns3_Polygon (pctxt, pvalue->u.polygon, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
            asn1E_Ns3_Regular_polygon (pctxt, pvalue->u.regular_polygon, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 6:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
            asn1E_Ns3_Path (pctxt, pvalue->u.path, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 7:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
            asn1E_Ns3_Circle (pctxt, pvalue->u.circle, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 8:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
            asn1E_Ns3_Ellipse (pctxt, pvalue->u.ellipse, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 9:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
            asn1E_Ns3_G (pctxt, pvalue->u.g, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 10:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
            asn1E_Ns3_Page_thumbnail (pctxt, pvalue->u.page_thumbnail, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 11:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
            asn1E_Ns3_Frame (pctxt, pvalue->u.frame, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 12:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
            asn1E_Ns3_Measure (pctxt, pvalue->u.measure, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 13:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
            asn1E_Ns3_Caption (pctxt, pvalue->u.caption, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 14:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
            asn1E_Ns3_Connector (pctxt, pvalue->u.connector, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 15:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|14,
            asn1E_Ns3_Control (pctxt, pvalue->u.control, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 16:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|15,
            asn1E_Ns7_Scene (pctxt, (Ns7_Scene*)pvalue->u.scene, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 17:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|16,
            asn1E_Ns3_Custom_shape (pctxt, pvalue->u.custom_shape, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Page_element (OSCTXT* pctxt, Ns3_Page_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode rect */

         stat = XmlEnc_Ns3_Rect (pctxt, pvalue->u.rect
            , OSUTF8("rect"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode line */

         stat = XmlEnc_Ns3_Line (pctxt, pvalue->u.line
            , OSUTF8("line"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode polyline */

         stat = XmlEnc_Ns3_Polyline (pctxt, pvalue->u.polyline
            , OSUTF8("polyline"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode polygon */

         stat = XmlEnc_Ns3_Polygon (pctxt, pvalue->u.polygon
            , OSUTF8("polygon"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode regular_polygon */

         stat = XmlEnc_Ns3_Regular_polygon (pctxt, pvalue->u.regular_polygon
            , OSUTF8("regular-polygon"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 6:
         /* encode path */

         stat = XmlEnc_Ns3_Path (pctxt, pvalue->u.path
            , OSUTF8("path"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 7:
         /* encode circle */

         stat = XmlEnc_Ns3_Circle (pctxt, pvalue->u.circle
            , OSUTF8("circle"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 8:
         /* encode ellipse */

         stat = XmlEnc_Ns3_Ellipse (pctxt, pvalue->u.ellipse
            , OSUTF8("ellipse"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 9:
         /* encode g */

         stat = XmlEnc_Ns3_G (pctxt, pvalue->u.g, OSUTF8("g"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 10:
         /* encode page_thumbnail */

         stat = XmlEnc_Ns3_Page_thumbnail (pctxt, pvalue->u.page_thumbnail
            , OSUTF8("page-thumbnail"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 11:
         /* encode frame */

         stat = XmlEnc_Ns3_Frame (pctxt, pvalue->u.frame
            , OSUTF8("frame"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 12:
         /* encode measure */

         stat = XmlEnc_Ns3_Measure (pctxt, pvalue->u.measure
            , OSUTF8("measure"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 13:
         /* encode caption */

         stat = XmlEnc_Ns3_Caption (pctxt, pvalue->u.caption
            , OSUTF8("caption"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 14:
         /* encode connector */

         stat = XmlEnc_Ns3_Connector (pctxt, pvalue->u.connector
            , OSUTF8("connector"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 15:
         /* encode control */

         stat = XmlEnc_Ns3_Control (pctxt, pvalue->u.control
            , OSUTF8("control"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 16:
         /* encode scene */

         stat = XmlEnc_Ns7_Scene (pctxt, pvalue->u.scene
            , OSUTF8("scene"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 17:
         /* encode custom_shape */

         stat = XmlEnc_Ns3_Custom_shape (pctxt, pvalue->u.custom_shape
            , OSUTF8("custom-shape"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Shape_id                                                  */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Shape_id (OSCTXT* pctxt,
   Ns3_Shape_id pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   ll = xe_utf8str (pctxt, pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Shape_id (OSCTXT* pctxt, Ns3_Shape_id value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt, value, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Page_choice_1                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Page_choice_1 (OSCTXT* pctxt,
   Ns3_Page_choice_1 *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Ns10_Animations (pctxt, (Ns10_Animations*)pvalue->u.animations, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Animate (pctxt, (Animate*)pvalue->u.animate, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Set (pctxt, (Set*)pvalue->u.set, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_AnimateMotion (pctxt, (AnimateMotion*)pvalue->u.animateMotion, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
            asn1E_AnimateColor (pctxt, (AnimateColor*)pvalue->u.animateColor, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 6:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
            asn1E_AnimateTransform (pctxt, (AnimateTransform*)pvalue->u.animateTransform, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 7:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
            asn1E_TransitionFilter (pctxt, (TransitionFilter*)pvalue->u.transitionFilter, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 8:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
            asn1E_Par (pctxt, (Par*)pvalue->u.par, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 9:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
            asn1E_Seq (pctxt, (Seq*)pvalue->u.seq, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 10:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
            asn1E_Iterate (pctxt, (Iterate*)pvalue->u.iterate, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 11:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
            asn1E_Audio (pctxt, (Audio*)pvalue->u.audio, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 12:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
            asn1E_Command (pctxt, (Command*)pvalue->u.command, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Page_choice_1 (OSCTXT* pctxt, Ns3_Page_choice_1* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode animations */

         stat = XmlEnc_Ns10_Animations (pctxt, pvalue->u.animations
            , OSUTF8("animations"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode animate */

         stat = XmlEnc_Animate (pctxt, pvalue->u.animate
            , OSUTF8("animate"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode set */

         stat = XmlEnc_Set (pctxt, pvalue->u.set, OSUTF8("set"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode animateMotion */

         stat = XmlEnc_AnimateMotion (pctxt, pvalue->u.animateMotion
            , OSUTF8("animateMotion"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode animateColor */

         stat = XmlEnc_AnimateColor (pctxt, pvalue->u.animateColor
            , OSUTF8("animateColor"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 6:
         /* encode animateTransform */

         stat = XmlEnc_AnimateTransform (pctxt, pvalue->u.animateTransform
            , OSUTF8("animateTransform"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 7:
         /* encode transitionFilter */

         stat = XmlEnc_TransitionFilter (pctxt, pvalue->u.transitionFilter
            , OSUTF8("transitionFilter"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 8:
         /* encode par */

         stat = XmlEnc_Par (pctxt, pvalue->u.par, OSUTF8("par"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 9:
         /* encode seq */

         stat = XmlEnc_Seq (pctxt, pvalue->u.seq, OSUTF8("seq"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 10:
         /* encode iterate */

         stat = XmlEnc_Iterate (pctxt, pvalue->u.iterate
            , OSUTF8("iterate"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 11:
         /* encode audio */

         stat = XmlEnc_Audio (pctxt, pvalue->u.audio
            , OSUTF8("audio"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 12:
         /* encode command */

         stat = XmlEnc_Command (pctxt, pvalue->u.command
            , OSUTF8("command"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Page                                                      */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Page (OSCTXT* pctxt,
   Ns3_Page *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode notes */

   if (pvalue->m.notesPresent) {
      if (pvalue->notes == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->notes");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
         asn1E_Ns10_Notes (pctxt, (Ns10_Notes*)pvalue->notes, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode choice_1 */

   if (pvalue->m.choice_1Present) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
         asn1E_Ns3_Page_choice_1 (pctxt, &pvalue->choice_1, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode choice_list */

   pnode2 = pvalue->choice_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Page_element (pctxt, ((Ns3_Page_element*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode forms */

   if (pvalue->m.formsPresent) {
      if (pvalue->forms == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->forms");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
         asn1E_Ns13_Forms (pctxt, (Ns13_Forms*)pvalue->forms, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode use_header_name */

   if (pvalue->m.use_header_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         asn1E_Ns10_Use_header_name (pctxt, (Ns10_Use_header_name)pvalue->use_header_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode use_footer_name */

   if (pvalue->m.use_footer_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         asn1E_Ns10_Use_footer_name (pctxt, (Ns10_Use_footer_name)pvalue->use_footer_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode use_date_time_name */

   if (pvalue->m.use_date_time_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns10_Use_date_time_name (pctxt, (Ns10_Use_date_time_name)pvalue->use_date_time_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode presentation_page_layout_name */

   if (pvalue->m.presentation_page_layout_namePresent) {
      if (pvalue->presentation_page_layout_name == NULL) {
         rtxErrAddStrParm (pctxt, "pvalue->presentation_page_layout_name");
         return LOG_RTERR (pctxt, RTERR_NULLPTR);
      }
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
         asn1E_Ns10_Presentation_page_layout_name (pctxt, (Ns10_Presentation_page_layout_name*)pvalue->presentation_page_layout_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode style_name */

   if (pvalue->m.style_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
         asn1E_Ns3_Style_name (pctxt, &pvalue->style_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode master_page_name */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
      asn1E_Ns3_Page_master_page_name (pctxt, &pvalue->master_page_name, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode id */

   if (pvalue->m.idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns3_Id (pctxt, pvalue->id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Page (OSCTXT* pctxt, Ns3_Page* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:id=\""), 9);

      stat = XmlEnc_Ns3_Id (pctxt, pvalue->id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:master-page-name=\""), 23);

   stat = XmlEnc_Ns3_Page_master_page_name (pctxt, &pvalue->master_page_name
      , 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.style_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:style-name=\""), 17);

      stat = XmlEnc_Ns3_Style_name (pctxt, &pvalue->style_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.presentation_page_layout_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:presentation-page-layout-name=\""), 37);

      stat = XmlEnc_Ns10_Presentation_page_layout_name (pctxt, pvalue->
         presentation_page_layout_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.use_date_time_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:use-date-time-name=\""), 26);

      stat = XmlEnc_Ns10_Use_date_time_name (pctxt, pvalue->use_date_time_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.use_footer_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:use-footer-name=\""), 23);

      stat = XmlEnc_Ns10_Use_footer_name (pctxt, pvalue->use_footer_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.use_header_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns10:use-header-name=\""), 23);

      stat = XmlEnc_Ns10_Use_header_name (pctxt, pvalue->use_header_name
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode forms */

   if (pvalue->m.formsPresent) {
      stat = XmlEnc_Ns13_Forms (pctxt, pvalue->forms
         , OSUTF8("forms"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode choice_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->choice_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Page_element (pctxt, ((Ns3_Page_element*)pnode->data)
         , 0, nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   /* encode choice_1 */

   if (pvalue->m.choice_1Present) {
      stat = XmlEnc_Ns3_Page_choice_1 (pctxt, &pvalue->choice_1
         , OSUTF8(""), 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   /* encode notes */

   if (pvalue->m.notesPresent) {
      stat = XmlEnc_Ns10_Notes (pctxt, pvalue->notes
         , OSUTF8("notes"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Object_choice                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Object_choice (OSCTXT* pctxt,
   Ns3_Object_choice *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Ns13_Document (pctxt, (Ns13_Document*)pvalue->u.document, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Math (pctxt, (Math*)pvalue->u.math, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Object_choice (OSCTXT* pctxt, Ns3_Object_choice* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode document */

         stat = XmlEnc_Ns13_Document (pctxt, pvalue->u.document
            , OSUTF8("document"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode math */

         stat = XmlEnc_Math (pctxt, pvalue->u.math, OSUTF8("math"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Object                                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Object (OSCTXT* pctxt,
   Ns3_Object *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode choice */

   if (pvalue->m.choicePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
         asn1E_Ns3_Object_choice (pctxt, &pvalue->choice, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode notify_on_update_of_ranges */

   if (pvalue->m.notify_on_update_of_rangesPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->notify_on_update_of_ranges, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode type */

   if (pvalue->m.typePresent) {
      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Xlink_Type (pctxt, &pvalue->type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode show */

   if (pvalue->m.showPresent) {
      if(pvalue->show < 0 || pvalue->show > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Object_show (pctxt, &pvalue->show, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode href */

   if (pvalue->m.hrefPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Xlink_Href (pctxt, pvalue->href, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode actuate */

   if (pvalue->m.actuatePresent) {
      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns3_Object_actuate (pctxt, &pvalue->actuate, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Object (OSCTXT* pctxt, Ns3_Object* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.actuatePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:actuate=\""), 16);

      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Object_actuate (pctxt, pvalue->actuate, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.hrefPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:href=\""), 13);

      stat = XmlEnc_Xlink_Href (pctxt, pvalue->href, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.showPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:show=\""), 13);

      if(pvalue->show < 0 || pvalue->show > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Object_show (pctxt, pvalue->show, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:type=\""), 13);

      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Xlink_Type (pctxt, pvalue->type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.notify_on_update_of_rangesPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:notify-on-update-of-ranges=\""), 33);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->notify_on_update_of_ranges
         , 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode choice */

   if (pvalue->m.choicePresent) {
      stat = XmlEnc_Ns3_Object_choice (pctxt, &pvalue->choice, OSUTF8(""), 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Object_ole_actuate                                        */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Object_ole_actuate (OSCTXT* pctxt,
   Ns3_Object_ole_actuate *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Object_ole_actuate (OSCTXT* pctxt, 
   Ns3_Object_ole_actuate value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Object_ole_actuate_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Object_ole_show                                           */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Object_ole_show (OSCTXT* pctxt,
   Ns3_Object_ole_show *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Object_ole_show (OSCTXT* pctxt, Ns3_Object_ole_show value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Object_ole_show_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Object_ole                                                */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Object_ole (OSCTXT* pctxt,
   Ns3_Object_ole *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode binary_data */

   if (pvalue->m.binary_dataPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         asn1E_Ns13_Binary_data (pctxt, (Ns13_Binary_data*)&pvalue->binary_data, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode class_id */

   if (pvalue->m.class_idPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->class_id, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode type */

   if (pvalue->m.typePresent) {
      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Xlink_Type (pctxt, &pvalue->type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode show */

   if (pvalue->m.showPresent) {
      if(pvalue->show < 0 || pvalue->show > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Object_ole_show (pctxt, &pvalue->show, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode href */

   if (pvalue->m.hrefPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Xlink_Href (pctxt, pvalue->href, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode actuate */

   if (pvalue->m.actuatePresent) {
      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns3_Object_ole_actuate (pctxt, &pvalue->actuate, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Object_ole (OSCTXT* pctxt, Ns3_Object_ole* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.actuatePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:actuate=\""), 16);

      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Object_ole_actuate (pctxt, pvalue->actuate, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.hrefPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:href=\""), 13);

      stat = XmlEnc_Xlink_Href (pctxt, pvalue->href, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.showPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:show=\""), 13);

      if(pvalue->show < 0 || pvalue->show > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Object_ole_show (pctxt, pvalue->show, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:type=\""), 13);

      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Xlink_Type (pctxt, pvalue->type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.class_idPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:class-id=\""), 15);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->class_id, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode binary_data */

   if (pvalue->m.binary_dataPresent) {
      stat = XmlEnc_Ns13_Binary_data (pctxt, &pvalue->binary_data
         , OSUTF8("binary-data"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Applet_actuate                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Applet_actuate (OSCTXT* pctxt,
   Ns3_Applet_actuate *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Applet_actuate (OSCTXT* pctxt, Ns3_Applet_actuate value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Applet_actuate_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Applet_show                                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Applet_show (OSCTXT* pctxt,
   Ns3_Applet_show *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Applet_show (OSCTXT* pctxt, Ns3_Applet_show value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Applet_show_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Applet_may_script                                         */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Applet_may_script (OSCTXT* pctxt,
   Ns3_Applet_may_script *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 1)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Applet_may_script (OSCTXT* pctxt, Ns3_Applet_may_script value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Applet_may_script_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Param                                                     */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Param (OSCTXT* pctxt,
   Ns3_Param *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode value */

   if (pvalue->m.valuePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         xe_utf8str (pctxt, pvalue->value, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode name */

   if (pvalue->m.namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         xe_utf8str (pctxt, pvalue->name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Param (OSCTXT* pctxt, Ns3_Param* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:name=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.valuePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:value=\""), 12);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->value, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Applet                                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Applet (OSCTXT* pctxt,
   Ns3_Applet *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode param_list */

   pnode2 = pvalue->param_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Param (pctxt, ((Ns3_Param*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode object */

   if (pvalue->m.objectPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|7,
         xe_utf8str (pctxt, pvalue->object, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode may_script */

   if (pvalue->m.may_scriptPresent) {
      if(pvalue->may_script < 0 || pvalue->may_script > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|6,
         asn1E_Ns3_Applet_may_script (pctxt, &pvalue->may_script, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode code */

   if (pvalue->m.codePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|5,
         xe_utf8str (pctxt, pvalue->code, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode archive */

   if (pvalue->m.archivePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->archive, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode type */

   if (pvalue->m.typePresent) {
      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Xlink_Type (pctxt, &pvalue->type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode show */

   if (pvalue->m.showPresent) {
      if(pvalue->show < 0 || pvalue->show > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Applet_show (pctxt, &pvalue->show, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode href */

   if (pvalue->m.hrefPresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
         asn1E_Xlink_Href (pctxt, pvalue->href, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode actuate */

   if (pvalue->m.actuatePresent) {
      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns3_Applet_actuate (pctxt, &pvalue->actuate, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Applet (OSCTXT* pctxt, Ns3_Applet* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.actuatePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:actuate=\""), 16);

      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Applet_actuate (pctxt, pvalue->actuate, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.hrefPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:href=\""), 13);

      stat = XmlEnc_Xlink_Href (pctxt, pvalue->href, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.showPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:show=\""), 13);

      if(pvalue->show < 0 || pvalue->show > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Applet_show (pctxt, pvalue->show, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:type=\""), 13);

      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Xlink_Type (pctxt, pvalue->type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.archivePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:archive=\""), 14);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->archive, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.codePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:code=\""), 11);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->code, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   if (pvalue->m.may_scriptPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:may-script=\""), 17);

      if(pvalue->may_script < 0 || pvalue->may_script > 1)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Applet_may_script (pctxt, pvalue->may_script, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.objectPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:object=\""), 13);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->object, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode param_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->param_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Param (pctxt, ((Ns3_Param*)pnode->data)
         , OSUTF8("param"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Floating_frame_actuate                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Floating_frame_actuate (OSCTXT* pctxt,
   Ns3_Floating_frame_actuate *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Floating_frame_actuate (OSCTXT* pctxt, 
   Ns3_Floating_frame_actuate value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Floating_frame_actuate_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Floating_frame_show                                       */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Floating_frame_show (OSCTXT* pctxt,
   Ns3_Floating_frame_show *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Floating_frame_show (OSCTXT* pctxt, 
   Ns3_Floating_frame_show value, const OSUTF8CHAR* elemName, 
   const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Floating_frame_show_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Floating_frame                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Floating_frame (OSCTXT* pctxt,
   Ns3_Floating_frame *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   /* encode frame_name */

   if (pvalue->m.frame_namePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->frame_name, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode type */

   if (pvalue->m.typePresent) {
      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Xlink_Type (pctxt, &pvalue->type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode show */

   if (pvalue->m.showPresent) {
      if(pvalue->show < 0 || pvalue->show > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Floating_frame_show (pctxt, &pvalue->show, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode href */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      asn1E_Xlink_Href (pctxt, pvalue->href, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode actuate */

   if (pvalue->m.actuatePresent) {
      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns3_Floating_frame_actuate (pctxt, &pvalue->actuate, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Floating_frame (OSCTXT* pctxt, Ns3_Floating_frame* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.actuatePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:actuate=\""), 16);

      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Floating_frame_actuate (pctxt, pvalue->actuate, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:href=\""), 13);

   stat = XmlEnc_Xlink_Href (pctxt, pvalue->href, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.showPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:show=\""), 13);

      if(pvalue->show < 0 || pvalue->show > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Floating_frame_show (pctxt, pvalue->show, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:type=\""), 13);

      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Xlink_Type (pctxt, pvalue->type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.frame_namePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:frame-name=\""), 17);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->frame_name, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Plugin_actuate                                            */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Plugin_actuate (OSCTXT* pctxt,
   Ns3_Plugin_actuate *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Plugin_actuate (OSCTXT* pctxt, Ns3_Plugin_actuate value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Plugin_actuate_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Plugin_show                                               */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Plugin_show (OSCTXT* pctxt,
   Ns3_Plugin_show *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;

   if(*pvalue < 0 || *pvalue > 0)
      return LOG_RTERR (pctxt, RTERR_INVENUM);

   ll = xe_enum (pctxt, (OSINT32*)pvalue, tagging);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll0 += ll;

   return (ll0);
}

int XmlEnc_Ns3_Plugin_show (OSCTXT* pctxt, Ns3_Plugin_show value, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   stat = rtXmlEncUTF8Str (pctxt,
      Ns3_Plugin_show_ToString (value), elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Plugin                                                    */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Plugin (OSCTXT* pctxt,
   Ns3_Plugin *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;
   OSRTDListNode* pnode2;
   int ll2 = 0;

   /* encode param_list */

   pnode2 = pvalue->param_list.tail;
   while (0 != pnode2) {
      ll = asn1E_Ns3_Param (pctxt, ((Ns3_Param*)pnode2->data), ASN1EXPL);
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll2 += ll;

      pnode2 = pnode2->prev;
   }
   ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5, ll2);
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   else { ll1 += ll; ll2 = 0; }

   /* encode mime_type */

   if (pvalue->m.mime_typePresent) {
      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|4,
         xe_utf8str (pctxt, pvalue->mime_type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode type */

   if (pvalue->m.typePresent) {
      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|3,
         asn1E_Xlink_Type (pctxt, &pvalue->type, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode show */

   if (pvalue->m.showPresent) {
      if(pvalue->show < 0 || pvalue->show > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|2,
         asn1E_Ns3_Plugin_show (pctxt, &pvalue->show, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   /* encode href */

   ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|1,
      asn1E_Xlink_Href (pctxt, pvalue->href, ASN1IMPL));
   if (ll < 0) return LOG_RTERR (pctxt, ll);
   ll1 += ll;

   /* encode actuate */

   if (pvalue->m.actuatePresent) {
      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      ll = xe_tag_len (pctxt, TM_CTXT|TM_PRIM|0,
         asn1E_Ns3_Plugin_actuate (pctxt, &pvalue->actuate, ASN1IMPL));
      if (ll < 0) return LOG_RTERR (pctxt, ll);
      ll1 += ll;
   }
   ll0 += ll1;

   if (tagging == ASN1EXPL)
      ll0 = xe_tag_len (pctxt, TM_UNIV|TM_CONS|16, ll0);

   return (ll0);
}

int XmlEnc_Ns3_Plugin (OSCTXT* pctxt, Ns3_Plugin* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, FALSE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   /* add attributes */

   if (pvalue->m.actuatePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:actuate=\""), 16);

      if(pvalue->actuate < 0 || pvalue->actuate > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Plugin_actuate (pctxt, pvalue->actuate, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:href=\""), 13);

   stat = XmlEnc_Xlink_Href (pctxt, pvalue->href, 0, 0);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   OSRTSAFEPUTCHAR (pctxt, '"');

   if (pvalue->m.showPresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:show=\""), 13);

      if(pvalue->show < 0 || pvalue->show > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Ns3_Plugin_show (pctxt, pvalue->show, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" xlink:type=\""), 13);

      if(pvalue->type < 0 || pvalue->type > 0)
         return LOG_RTERR (pctxt, RTERR_INVENUM);

      stat = XmlEnc_Xlink_Type (pctxt, pvalue->type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '"');
   }

   if (pvalue->m.mime_typePresent) {
      OSRTSAFEMEMCPY (pctxt, OSUTF8(" ns3:mime-type=\""), 16);

      stat = rtXmlEncUTF8Str (pctxt, pvalue->mime_type, 0, 0);
      if (stat != 0) return LOG_RTERR (pctxt, stat);

      OSRTSAFEPUTCHAR (pctxt, '\"');
   }

   OSRTSAFEPUTCHAR (pctxt, '>');
   pctxt->flags &= ~OSTERMSTART;
   pctxt->state = OSXMLSTART;

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   /* encode param_list */

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   { OSRTDListNode* pnode = pvalue->param_list.head;
   while (0 != pnode) {
      stat = XmlEnc_Ns3_Param (pctxt, ((Ns3_Param*)pnode->data)
         , OSUTF8("param"), nsPrefix);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
      pnode = pnode->next;
   }}
   nsPrefix = savedPrefix;
   }

   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  Frame_element                                             */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_Frame_element (OSCTXT* pctxt,
   Ns3_Frame_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Ns3_Text_box (pctxt, pvalue->u.text_box, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Ns3_Image (pctxt, pvalue->u.image, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Ns3_Object (pctxt, pvalue->u.object, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Ns3_Object_ole (pctxt, pvalue->u.object_ole, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
            asn1E_Ns3_Applet (pctxt, pvalue->u.applet, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 6:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
            asn1E_Ns3_Floating_frame (pctxt, pvalue->u.floating_frame, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 7:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
            asn1E_Ns3_Plugin (pctxt, pvalue->u.plugin, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_Frame_element (OSCTXT* pctxt, Ns3_Frame_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode text_box */

         stat = XmlEnc_Ns3_Text_box (pctxt, pvalue->u.text_box
            , OSUTF8("text-box"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode image */

         stat = XmlEnc_Ns3_Image (pctxt, pvalue->u.image
            , OSUTF8("image"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode object */

         stat = XmlEnc_Ns3_Object (pctxt, pvalue->u.object
            , OSUTF8("object"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode object_ole */

         stat = XmlEnc_Ns3_Object_ole (pctxt, pvalue->u.object_ole
            , OSUTF8("object-ole"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode applet */

         stat = XmlEnc_Ns3_Applet (pctxt, pvalue->u.applet
            , OSUTF8("applet"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 6:
         /* encode floating_frame */

         stat = XmlEnc_Ns3_Floating_frame (pctxt, pvalue->u.floating_frame
            , OSUTF8("floating-frame"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 7:
         /* encode plugin */

         stat = XmlEnc_Ns3_Plugin (pctxt, pvalue->u.plugin
            , OSUTF8("plugin"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

/**************************************************************/
/*                                                            */
/*  G_element                                                 */
/*                                                            */
/**************************************************************/

EXTERN int asn1E_Ns3_G_element (OSCTXT* pctxt,
   Ns3_G_element *pvalue, ASN1TagType tagging)
{
   int ll;
   int ll0 = 0;
   int ll1 = 0;

   ll0 = 0;
   switch (pvalue->t)
   {
      case 1:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|0,
            asn1E_Ns3_Rect (pctxt, pvalue->u.rect, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 2:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|1,
            asn1E_Ns3_Line (pctxt, pvalue->u.line, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 3:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|2,
            asn1E_Ns3_Polyline (pctxt, pvalue->u.polyline, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 4:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|3,
            asn1E_Ns3_Polygon (pctxt, pvalue->u.polygon, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 5:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|4,
            asn1E_Ns3_Regular_polygon (pctxt, pvalue->u.regular_polygon, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 6:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|5,
            asn1E_Ns3_Path (pctxt, pvalue->u.path, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 7:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|6,
            asn1E_Ns3_Circle (pctxt, pvalue->u.circle, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 8:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|7,
            asn1E_Ns3_Ellipse (pctxt, pvalue->u.ellipse, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 9:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|8,
            asn1E_Ns3_G (pctxt, (Ns3_G*)pvalue->u.g, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 10:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|9,
            asn1E_Ns3_Page_thumbnail (pctxt, pvalue->u.page_thumbnail, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 11:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|10,
            asn1E_Ns3_Frame (pctxt, pvalue->u.frame, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 12:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|11,
            asn1E_Ns3_Measure (pctxt, pvalue->u.measure, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 13:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|12,
            asn1E_Ns3_Caption (pctxt, pvalue->u.caption, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 14:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|13,
            asn1E_Ns3_Connector (pctxt, pvalue->u.connector, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 15:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|14,
            asn1E_Ns3_Control (pctxt, pvalue->u.control, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 16:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|15,
            asn1E_Ns7_Scene (pctxt, (Ns7_Scene*)pvalue->u.scene, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      case 17:
         ll = xe_tag_len (pctxt, TM_CTXT|TM_CONS|16,
            asn1E_Ns3_Custom_shape (pctxt, pvalue->u.custom_shape, ASN1IMPL));
         if (ll < 0) return LOG_RTERR (pctxt, ll);
         ll1 += ll;
         break;

      default:
         return LOG_RTERR (pctxt, RTERR_INVOPT);
   }
   ll0 += ll1;

   return (ll0);
}

int XmlEnc_Ns3_G_element (OSCTXT* pctxt, Ns3_G_element* pvalue, 
   const OSUTF8CHAR* elemName, const OSUTF8CHAR* nsPrefix)
{
   int stat = 0;

   if (0 != elemName) {
      stat = rtXmlEncStartElement (pctxt, elemName, nsPrefix, TRUE);
      if (stat != 0) return LOG_RTERR (pctxt, stat);
   }

   { const OSUTF8CHAR* savedPrefix = nsPrefix;
   nsPrefix = rtXmlNSGetPrefix (pctxt, OSUTF8(
      "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"));

   switch (pvalue->t)
   {
      case 1:
         /* encode rect */

         stat = XmlEnc_Ns3_Rect (pctxt, pvalue->u.rect
            , OSUTF8("rect"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 2:
         /* encode line */

         stat = XmlEnc_Ns3_Line (pctxt, pvalue->u.line
            , OSUTF8("line"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 3:
         /* encode polyline */

         stat = XmlEnc_Ns3_Polyline (pctxt, pvalue->u.polyline
            , OSUTF8("polyline"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 4:
         /* encode polygon */

         stat = XmlEnc_Ns3_Polygon (pctxt, pvalue->u.polygon
            , OSUTF8("polygon"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 5:
         /* encode regular_polygon */

         stat = XmlEnc_Ns3_Regular_polygon (pctxt, pvalue->u.regular_polygon
            , OSUTF8("regular-polygon"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 6:
         /* encode path */

         stat = XmlEnc_Ns3_Path (pctxt, pvalue->u.path
            , OSUTF8("path"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 7:
         /* encode circle */

         stat = XmlEnc_Ns3_Circle (pctxt, pvalue->u.circle
            , OSUTF8("circle"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 8:
         /* encode ellipse */

         stat = XmlEnc_Ns3_Ellipse (pctxt, pvalue->u.ellipse
            , OSUTF8("ellipse"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 9:
         /* encode g */

         stat = XmlEnc_Ns3_G (pctxt, pvalue->u.g, OSUTF8("g"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 10:
         /* encode page_thumbnail */

         stat = XmlEnc_Ns3_Page_thumbnail (pctxt, pvalue->u.page_thumbnail
            , OSUTF8("page-thumbnail"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 11:
         /* encode frame */

         stat = XmlEnc_Ns3_Frame (pctxt, pvalue->u.frame
            , OSUTF8("frame"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 12:
         /* encode measure */

         stat = XmlEnc_Ns3_Measure (pctxt, pvalue->u.measure
            , OSUTF8("measure"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 13:
         /* encode caption */

         stat = XmlEnc_Ns3_Caption (pctxt, pvalue->u.caption
            , OSUTF8("caption"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 14:
         /* encode connector */

         stat = XmlEnc_Ns3_Connector (pctxt, pvalue->u.connector
            , OSUTF8("connector"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 15:
         /* encode control */

         stat = XmlEnc_Ns3_Control (pctxt, pvalue->u.control
            , OSUTF8("control"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 16:
         /* encode scene */

         stat = XmlEnc_Ns7_Scene (pctxt, pvalue->u.scene
            , OSUTF8("scene"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      case 17:
         /* encode custom_shape */

         stat = XmlEnc_Ns3_Custom_shape (pctxt, pvalue->u.custom_shape
            , OSUTF8("custom-shape"), nsPrefix);
         if (stat != 0) return LOG_RTERR (pctxt, stat);

         break;

      default: {
         char buf[40];
         os_snprintf (buf, 40, "%d", pvalue->t);
         return LOG_RTERRNEW1 (pctxt, RTERR_INVOPT, 
            rtxErrAddStrParm (pctxt, buf));
      }
   }
   nsPrefix = savedPrefix;
   }

   stat = rtXmlEncEndElement (pctxt, elemName, nsPrefix);
   if (stat != 0) return LOG_RTERR (pctxt, stat);

   return (stat);
}

